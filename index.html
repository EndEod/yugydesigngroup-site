<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ëŒ€ìˆ˜ì„  í—ˆê°€/ì‹ ê³  íŒì •ê¸° (MVP) | ê±´ì¶•ì‚¬ ëš±ëšœë£¨</title>
  <meta name="description" content="ëŒ€ìˆ˜ì„ (í—ˆê°€/ì‹ ê³ ) ìë™ íŒì • MVP. ì‚¬ìš©ìëŠ” ê³µì‚¬ ì‚¬ì‹¤ë§Œ ì²´í¬í•˜ë©´ ë©ë‹ˆë‹¤." />
  <style>
    :root{
      --bg:#0b0f19;
      --panel:#111827;
      --card:#0f172a;
      --line:rgba(255,255,255,.08);
      --ink:#e5e7eb;
      --muted:#9ca3af;
      --accent:#22c55e;
      --warn:#f59e0b;
      --danger:#ef4444;
      --btn:#1f2937;
      --shadow: 0 16px 40px rgba(0,0,0,.35);
      --radius: 18px;
      --radius2: 14px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo", "Malgun Gothic", "Noto Sans KR", Arial, sans-serif;
      background: radial-gradient(1200px 800px at 20% 10%, rgba(34,197,94,.10), transparent 60%),
                  radial-gradient(900px 700px at 85% 30%, rgba(245,158,11,.08), transparent 60%),
                  var(--bg);
      color:var(--ink);
    }
    a{color:#93c5fd; text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:1200px; margin:0 auto; padding:22px 16px 64px}
    .top{
      display:flex; gap:14px; align-items:flex-start; justify-content:space-between;
      padding:18px 18px; border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(17,24,39,.95), rgba(15,23,42,.65));
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    .brand h1{
      margin:0; font-size:20px; letter-spacing:-.2px; line-height:1.25;
    }
    .brand p{margin:6px 0 0; color:var(--muted); font-size:13px; line-height:1.55}
    .pillrow{display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end}
    .pill{
      padding:8px 10px; border:1px solid var(--line); border-radius:999px;
      font-size:12px; color:var(--muted); background: rgba(0,0,0,.15);
      display:flex; gap:8px; align-items:center;
    }
    .dot{width:8px; height:8px; border-radius:999px; background: var(--muted)}
    .dot.ok{background: var(--accent)}
    .dot.warn{background: var(--warn)}
    .dot.bad{background: var(--danger)}
    .grid{
      display:grid; grid-template-columns: 1.25fr .75fr; gap:14px; margin-top:14px;
    }
    @media (max-width: 980px){
      .grid{grid-template-columns: 1fr}
      .pillrow{justify-content:flex-start}
    }
    .panel{
      border:1px solid var(--line);
      background: rgba(17,24,39,.6);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .panelHead{
      padding:14px 16px;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      border-bottom:1px solid var(--line);
      background: rgba(0,0,0,.12);
    }
    .panelHead h2{margin:0; font-size:14px}
    .panelHead .small{color:var(--muted); font-size:12px}
    .panelBody{padding:14px 16px}
    .stepper{
      display:flex; gap:8px; align-items:center; flex-wrap:wrap;
    }
    .step{
      display:flex; gap:10px; align-items:center;
      padding:8px 10px; border:1px solid var(--line); border-radius:999px;
      background: rgba(15,23,42,.55);
      color:var(--muted);
      font-size:12px;
    }
    .step b{
      width:20px; height:20px; border-radius:999px; display:inline-flex;
      align-items:center; justify-content:center;
      background: rgba(255,255,255,.06);
      color:var(--ink);
      font-size:12px;
    }
    .step.active{border-color: rgba(34,197,94,.45); color:var(--ink)}
    .step.active b{background: rgba(34,197,94,.18)}
    .step.done{border-color: rgba(34,197,94,.35); color: rgba(229,231,235,.85)}
    .step.done b{background: rgba(34,197,94,.14); color: rgba(229,231,235,.95)}
    .actions{display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end}
    button{
      border:1px solid var(--line);
      background: rgba(31,41,55,.75);
      color:var(--ink);
      padding:10px 12px;
      border-radius: 12px;
      cursor:pointer;
      font-size:13px;
    }
    button:hover{filter:brightness(1.07)}
    button.primary{
      background: linear-gradient(180deg, rgba(34,197,94,.95), rgba(22,163,74,.85));
      border-color: rgba(34,197,94,.55);
      color: #06230f;
      font-weight:700;
    }
    button.ghost{
      background: transparent;
    }
    button.danger{
      background: rgba(239,68,68,.14);
      border-color: rgba(239,68,68,.35);
      color: rgba(255,255,255,.95);
    }
    .note{
      margin:10px 0 0;
      font-size:12px; color:var(--muted); line-height:1.6;
    }
    .kpi{
      display:grid; grid-template-columns: 1fr 1fr; gap:10px;
    }
    .kpi .box{
      border:1px solid var(--line); border-radius: var(--radius2);
      padding:10px 12px; background: rgba(15,23,42,.55);
    }
    .kpi .box .t{font-size:12px; color:var(--muted)}
    .kpi .box .v{font-size:14px; margin-top:6px; font-weight:700}
    .fieldRow{display:grid; grid-template-columns: 1fr 1fr; gap:10px}
    @media (max-width: 720px){ .fieldRow{grid-template-columns: 1fr} }
    label{display:block; font-size:12px; color:var(--muted); margin:10px 0 6px}
    input, select, textarea{
      width:100%;
      padding:10px 10px;
      border-radius: 12px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.22);
      color: var(--ink);
      outline:none;
    }
    textarea{min-height:92px; resize:vertical}
    input::placeholder, textarea::placeholder{color: rgba(156,163,175,.7)}
    .cards{display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:10px}
    @media (max-width: 980px){ .cards{grid-template-columns: 1fr} }
    .card{
      border:1px solid var(--line);
      border-radius: var(--radius2);
      background: rgba(15,23,42,.55);
      padding:12px 12px;
    }
    .card h3{margin:0; font-size:13px}
    .card .sub{margin:6px 0 0; font-size:12px; color:var(--muted); line-height:1.55}
    .miniRow{display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:10px}
    @media (max-width: 520px){ .miniRow{grid-template-columns: 1fr} }
    .badge{
      display:inline-flex; gap:6px; align-items:center;
      border:1px solid var(--line);
      border-radius:999px;
      padding:6px 8px;
      font-size:11px;
      color: rgba(229,231,235,.92);
      background: rgba(0,0,0,.18);
      margin-top:8px;
    }
    .badge .s{color:var(--muted)}
    .hr{height:1px; background: var(--line); margin:12px 0}
    .result{
      border:1px solid var(--line);
      border-radius: var(--radius2);
      padding:12px 12px;
      background: rgba(0,0,0,.18);
    }
    .result .headline{font-size:16px; font-weight:900; margin:0}
    .result .tagline{margin:8px 0 0; color:var(--muted); font-size:12px; line-height:1.6}
    .result.good{border-color: rgba(34,197,94,.35)}
    .result.warn{border-color: rgba(245,158,11,.35)}
    .result.bad{border-color: rgba(239,68,68,.35)}
    ul{margin:10px 0 0; padding-left:18px; color: rgba(229,231,235,.92)}
    li{margin:6px 0; color: rgba(229,231,235,.92)}
    .codebox{
      font-family: var(--mono);
      font-size: 12px;
      white-space: pre-wrap;
      background: rgba(0,0,0,.25);
      border:1px solid var(--line);
      border-radius: 12px;
      padding:10px 10px;
      margin-top:10px;
    }
    .hint{
      font-size:12px; color:var(--muted); line-height:1.6;
      border:1px dashed rgba(255,255,255,.18);
      border-radius: 14px;
      padding:10px 10px;
      background: rgba(0,0,0,.14);
    }
    .rightSticky{
      position: sticky;
      top: 14px;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <h1>ëŒ€ìˆ˜ì„  í—ˆê°€/ì‹ ê³  íŒì •ê¸° (MVP)</h1>
        <p>
          ì‚¬ìš©ìëŠ” <b>ê³µì‚¬ ì‚¬ì‹¤</b>ë§Œ ì²´í¬í•©ë‹ˆë‹¤. ë„êµ¬ê°€ <b>ë²•ë ¹ ë¡œì§</b>ìœ¼ë¡œ
          â€œëŒ€ìˆ˜ì„  í•´ë‹¹ ì—¬ë¶€â€ì™€ â€œí—ˆê°€ vs ì‹ ê³ â€ë¥¼ ìë™ íŒì •í•©ë‹ˆë‹¤. ğŸ§­
        </p>
      </div>
      <div class="pillrow" aria-label="ìƒíƒœ ë°°ì§€">
        <div class="pill"><span class="dot ok"></span>ëŒ€ìˆ˜ì„  ë²”ìœ„: ì‹œí–‰ë ¹ ê¸°ì¤€</div>
        <div class="pill"><span class="dot warn"></span>ì‹ ê³  ê°€ëŠ¥ ë²”ìœ„: ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡</div>
        <div class="pill"><span class="dot"></span>MVP: ëŒ€ìˆ˜ì„ ë§Œ ìš°ì„  êµ¬í˜„</div>
      </div>
    </div>

    <div class="grid">
      <!-- LEFT -->
      <div class="panel">
        <div class="panelHead">
          <div>
            <h2>ì˜ì‚¬ê²°ì • ì§„í–‰ìƒí™©</h2>
            <div class="small">ë‹¤ìŒ ë²„íŠ¼ë§Œ ëˆŒëŸ¬ë„ íë¦„ì´ ì´ì–´ì§‘ë‹ˆë‹¤.</div>
          </div>
          <div class="actions">
            <button class="ghost" id="btnBack">ì´ì „</button>
            <button class="primary" id="btnNext">ë‹¤ìŒ</button>
          </div>
        </div>

        <div class="panelBody">
          <div class="stepper" id="stepper" aria-label="ë‹¨ê³„ í‘œì‹œ"></div>

          <div class="hr"></div>

          <!-- STEP 1 -->
          <section id="step1" class="stepView" aria-label="ê¸°ë³¸ ì •ë³´">
            <div class="hint">
              âœ… ì—¬ê¸°ì„œëŠ” â€œìš©ë„/ê·œëª¨â€ë¥¼ ì €ì¥í•´ ë‘¡ë‹ˆë‹¤. (ë‹¤ìŒ ë²„ì „ì— ì‹ ì¶•Â·ì¦ì¶•Â·ìš©ë„ë³€ê²½ ë¡œì§ í™•ì¥í•  ë•Œ ë°”ë¡œ ì”ë‹ˆë‹¤) <br/>
              âœ… ì´ë²ˆ MVPì˜ íŒì •ì€ <b>ëŒ€ìˆ˜ì„ (í—ˆê°€/ì‹ ê³ )</b>ì— ì§‘ì¤‘í•©ë‹ˆë‹¤.
            </div>

            <div class="fieldRow">
              <div>
                <label for="useMain">ê±´ì¶•ë¬¼ ìš©ë„ (ë³„í‘œ 1 ë¶„ë¥˜, ê²€ìƒ‰ìš©)</label>
                <input id="useMain" list="useList" placeholder="ì˜ˆ: 2. ê³µë™ì£¼íƒ / 3. ì œ1ì¢… ê·¼ë¦°ìƒí™œì‹œì„¤" />
                <datalist id="useList"></datalist>
                <div class="note">Tip: ì •í™•í•œ ì„¸ë¶€ìš©ë„ê¹Œì§€ëŠ” ì•„ë˜ â€œì„¸ë¶€ ë©”ëª¨â€ì— ì ì–´ë„ ë©ë‹ˆë‹¤.</div>
              </div>
              <div>
                <label for="addr">ì†Œì¬ì§€(ì‹œÂ·êµ°Â·êµ¬ ì •ë„)</label>
                <input id="addr" placeholder="ì˜ˆ: ì„œìš¸ ì„œëŒ€ë¬¸êµ¬" />
                <div class="note">ì¡°ë¡€, ì§€êµ¬ë‹¨ìœ„ ë“±ì€ ë‹¤ìŒ ë²„ì „ì—ì„œ í™•ì¥í•˜ê¸° ì¢‹ì•„ìš”.</div>
              </div>
            </div>

            <label for="memo">ì„¸ë¶€ ë©”ëª¨(ì„ íƒ)</label>
            <textarea id="memo" placeholder="ì˜ˆ: ë‹¤ê°€êµ¬(19ì„¸ëŒ€ ì´í•˜), 3ì¸µ, 1ì¸µ í•„ë¡œí‹° ì£¼ì°¨, ë‚´ë ¥ë²½ ì¼ë¶€ ë³´ê°• ì˜ˆì •"></textarea>
          </section>

          <!-- STEP 2 -->
          <section id="step2" class="stepView" aria-label="ê³µì‚¬ ì‚¬ì‹¤ ì²´í¬" style="display:none">
            <div class="hint">
              ì•„ë˜ëŠ” â€œëŒ€ìˆ˜ì„  ë²”ìœ„(ì‹œí–‰ë ¹)â€ í•­ëª©ë“¤ì…ë‹ˆë‹¤. <br/>
              â— ì—¬ê¸°ì„œëŠ” <b>í—ˆê°€/ì‹ ê³ ë¥¼ ë¬»ì§€ ì•ŠìŠµë‹ˆë‹¤.</b> â€œë¬´ì—‡ì„ ì–¼ë§ˆë‚˜ í•˜ëŠ”ì§€â€ ì‚¬ì‹¤ë§Œ ì²´í¬í•´ ì£¼ì„¸ìš”.
            </div>

            <label for="hasDismantle">ê³µì‚¬ ê³¼ì •ì—ì„œ â€œì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´(ì² ê±°)â€ê°€ ìˆë‚˜ìš”?</label>
            <select id="hasDismantle">
              <option value="no" selected>ì•„ë‹ˆì˜¤ (í•´ì²´ ì—†ìŒ)</option>
              <option value="yes">ì˜ˆ (í•´ì²´ ìˆìŒ)</option>
              <option value="unsure">ëª¨ë¦„ (ë¶ˆí™•ì‹¤)</option>
            </select>
            <div class="note">
              â€» â€œì‹ ê³ ë¡œ ê°€ëŠ¥í•œ ëŒ€ìˆ˜ì„ â€ì€ ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡ì— ë”°ë¼ â€œì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ê°€ ì—†ëŠ” ë“±â€ ìš”ê±´ì´ ë¶™ìŠµë‹ˆë‹¤.
            </div>

            <div class="cards" id="worksCards"></div>

            <div class="note">
              ìˆ«ì ê¸°ì¤€ ìš”ì•½: ë‚´ë ¥ë²½ 30ã¡ ì´ìƒ, ê¸°ë‘¥Â·ë³´Â·ì§€ë¶•í‹€ 3ê°œ ì´ìƒ. (ë‚˜ë¨¸ì§€ëŠ” í•­ëª© í•´ë‹¹ ì‹œ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°)
            </div>
          </section>

          <!-- STEP 3 -->
          <section id="step3" class="stepView" aria-label="íŒì • ê²°ê³¼" style="display:none">
            <div id="resultBox" class="result">
              <p class="headline" id="resultTitle">ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
              <p class="tagline" id="resultSub">ì™¼ìª½ ë‹¨ê³„ì—ì„œ ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ ê°±ì‹ ë©ë‹ˆë‹¤.</p>
              <div class="hr"></div>
              <div id="resultDetail"></div>
            </div>

            <div class="hr"></div>

            <div>
              <h3 style="margin:0;font-size:13px">ğŸ“Œ ë³µì‚¬ ê°€ëŠ¥í•œ ìš”ì•½</h3>
              <div class="codebox" id="copyText">ì•„ì§ ì…ë ¥ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.</div>
              <div class="actions" style="margin-top:10px; justify-content:flex-start">
                <button id="btnCopy">ìš”ì•½ ë³µì‚¬</button>
                <button class="danger" id="btnReset">ì „ì²´ ì´ˆê¸°í™”</button>
              </div>
              <p class="note">
                ì´ ìš”ì•½ì„ ê·¸ëŒ€ë¡œ ë¯¼ì› ë¬¸ì˜, ì„¤ê³„ì ì²´í¬ë¦¬ìŠ¤íŠ¸, í˜„ì¥ ê¸°ë¡ì— ë¶™ì—¬ ë„£ì„ ìˆ˜ ìˆê²Œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.
              </p>
            </div>

            <div class="hr"></div>

            <div class="hint">
              ğŸ” ì°¸ê³  ë§í¬(ë²•ë ¹ ì›ë¬¸ í™•ì¸ìš©) <br/>
              - ê±´ì¶•ë²• ì‹œí–‰ë ¹ ì œ11ì¡°(ê±´ì¶•ì‹ ê³ ) <br/>
              - ê±´ì¶•ë²• ì‹œí–‰ë ¹ ì œ3ì¡°ì˜2(ëŒ€ìˆ˜ì„ ì˜ ë²”ìœ„)
            </div>
          </section>
        </div>
      </div>

      <!-- RIGHT -->
      <div class="panel rightSticky">
        <div class="panelHead">
          <div>
            <h2>í˜„ì¬ ì…ë ¥ ìš”ì•½</h2>
            <div class="small">â€œë‚´ê°€ ë­˜ ì²´í¬í–ˆì§€?â€ ë°”ë¡œ ë³´ì´ê²Œ</div>
          </div>
        </div>
        <div class="panelBody">
          <div class="kpi">
            <div class="box">
              <div class="t">ìš©ë„</div>
              <div class="v" id="kpiUse">ë¯¸ì…ë ¥</div>
            </div>
            <div class="box">
              <div class="t">ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´</div>
              <div class="v" id="kpiDismantle">ë¯¸ì…ë ¥</div>
            </div>
          </div>

          <div class="hr"></div>

          <div>
            <h3 style="margin:0;font-size:13px">ì²´í¬ëœ ê³µì‚¬ í•­ëª©</h3>
            <div class="note">ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°ê°€ ë˜ëŠ” í•­ëª©ë§Œ ìë™ìœ¼ë¡œ ëª¨ì•„ ë³´ì—¬ì¤ë‹ˆë‹¤.</div>
            <ul id="kpiList"></ul>
          </div>

          <div class="hr"></div>

          <div class="hint">
            âš™ï¸ MVP ë¡œë“œë§µ (ë‹¤ìŒ í™•ì¥ ì˜ˆì •) <br/>
            1) ì‹ ì¶•Â·ì¦ì¶•Â·ê°œì¶•Â·ìš©ë„ë³€ê²½ ë¡œì§ <br/>
            2) ë³„í‘œ1 ìš©ë„ ê¸°ë°˜ ì˜ˆì™¸/ì œí•œ ìë™ ì•ˆë‚´ <br/>
            3) ì¡°ë¡€/ì§€êµ¬ë‹¨ìœ„/ë°©í™”ì§€êµ¬ ë“± ìœ„ì¹˜ ì¡°ê±´ ì¶”ê°€
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    /***********************
     * 0) ë³„í‘œ1 ìš©ë„: MVPëŠ” "ê²€ìƒ‰ìš© ëª©ë¡"ë§Œ ë‹´ì•„ë‘¡ë‹ˆë‹¤.
     *    (ì§€ê¸ˆì€ ì €ì¥ë§Œ, ë‹¤ìŒ ë²„ì „ì—ì„œ ë¡œì§ì— ì§ì ‘ ì‚¬ìš©)
     ************************/
    const USE_OPTIONS = [
      "1. ë‹¨ë…ì£¼íƒ (ë‹¨ë…/ë‹¤ì¤‘/ë‹¤ê°€êµ¬/ê³µê´€)",
      "2. ê³µë™ì£¼íƒ (ì•„íŒŒíŠ¸/ì—°ë¦½/ë‹¤ì„¸ëŒ€/ê¸°ìˆ™ì‚¬)",
      "3. ì œ1ì¢… ê·¼ë¦°ìƒí™œì‹œì„¤",
      "4. ì œ2ì¢… ê·¼ë¦°ìƒí™œì‹œì„¤",
      "5. ë¬¸í™” ë° ì§‘íšŒì‹œì„¤",
      "6. ì¢…êµì‹œì„¤",
      "7. íŒë§¤ì‹œì„¤",
      "8. ìš´ìˆ˜ì‹œì„¤",
      "9. ì˜ë£Œì‹œì„¤",
      "10. êµìœ¡ì—°êµ¬ì‹œì„¤",
      "11. ë…¸ìœ ìì‹œì„¤",
      "12. ìˆ˜ë ¨ì‹œì„¤",
      "13. ìš´ë™ì‹œì„¤",
      "14. ì—…ë¬´ì‹œì„¤",
      "15. ìˆ™ë°•ì‹œì„¤",
      "16. ìœ„ë½ì‹œì„¤",
      "17. ê³µì¥",
      "18. ì°½ê³ ì‹œì„¤",
      "19. ìœ„í—˜ë¬¼ ì €ì¥ ë° ì²˜ë¦¬ì‹œì„¤",
      "20. ìë™ì°¨ ê´€ë ¨ ì‹œì„¤",
      "21. ë™ë¬¼ ë° ì‹ë¬¼ ê´€ë ¨ ì‹œì„¤",
      "22. ìì›ìˆœí™˜ ê´€ë ¨ ì‹œì„¤",
      "23. êµì •ì‹œì„¤",
      "23ì˜2. êµ­ë°©Â·êµ°ì‚¬ì‹œì„¤",
      "24. ë°©ì†¡í†µì‹ ì‹œì„¤",
      "25. ë°œì „ì‹œì„¤",
      "26. ë¬˜ì§€ ê´€ë ¨ ì‹œì„¤",
      "27. ê´€ê´‘ íœ´ê²Œì‹œì„¤",
      "28. ì¥ë¡€ì‹œì„¤",
      "29. ì•¼ì˜ì¥ ì‹œì„¤"
    ];

    /***********************
     * 1) ëŒ€ìˆ˜ì„  ë²”ìœ„(ì‹œí–‰ë ¹ ì œ3ì¡°ì˜2) í•­ëª©ë“¤
     *    - â€œëŒ€ìˆ˜ì„  í•´ë‹¹ ì—¬ë¶€â€ íŒë‹¨ìš©
     ************************/
    const MAJOR_REPAIR_ITEMS = [
      {
        id: "bearingWall",
        title: "ë‚´ë ¥ë²½",
        desc: "ë²½ë©´ì  30ã¡ ì´ìƒ ìˆ˜ì„ /ë³€ê²½ì´ë©´ ëŒ€ìˆ˜ì„ . ì¦ì„¤Â·í•´ì²´ë„ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°.",
        metricLabel: "í•´ë‹¹ ë²½ë©´ì  í•©ê³„(ã¡)",
        metricType: "area",
        threshold: 30,
        reportEligible: true  // ì‹ ê³  ê°€ëŠ¥ í›„ë³´(ë‹¨, 'ìˆ˜ì„ ' + í•´ì²´ ì—†ìŒ + ì œ11ì¡°â‘¡ ë²”ìœ„)
      },
      {
        id: "columns",
        title: "ê¸°ë‘¥",
        desc: "3ê°œ ì´ìƒ ìˆ˜ì„ /ë³€ê²½ì´ë©´ ëŒ€ìˆ˜ì„ . ì¦ì„¤Â·í•´ì²´ë„ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°.",
        metricLabel: "í•´ë‹¹ ê°œìˆ˜(ê°œ)",
        metricType: "count",
        threshold: 3,
        reportEligible: true
      },
      {
        id: "beams",
        title: "ë³´",
        desc: "3ê°œ ì´ìƒ ìˆ˜ì„ /ë³€ê²½ì´ë©´ ëŒ€ìˆ˜ì„ . ì¦ì„¤Â·í•´ì²´ë„ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°.",
        metricLabel: "í•´ë‹¹ ê°œìˆ˜(ê°œ)",
        metricType: "count",
        threshold: 3,
        reportEligible: true
      },
      {
        id: "roofFrame",
        title: "ì§€ë¶•í‹€",
        desc: "3ê°œ ì´ìƒ ìˆ˜ì„ /ë³€ê²½ì´ë©´ ëŒ€ìˆ˜ì„ . ì¦ì„¤Â·í•´ì²´ë„ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°. (í•œì˜¥ ì„œê¹Œë˜ ì œì™¸)",
        metricLabel: "í•´ë‹¹ ê°œìˆ˜(ê°œ)",
        metricType: "count",
        threshold: 3,
        reportEligible: true
      },
      {
        id: "fireCompartment",
        title: "ë°©í™”ë²½ ë˜ëŠ” ë°©í™”êµ¬íš(ë°”ë‹¥/ë²½)",
        desc: "ìˆ˜ì„ Â·ë³€ê²½Â·ì¦ì„¤Â·í•´ì²´ ëª¨ë‘ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°.",
        metricLabel: "í•´ë‹¹ ì—¬ë¶€",
        metricType: "none",
        threshold: null,
        reportEligible: true
      },
      {
        id: "stairs",
        title: "ì£¼ê³„ë‹¨Â·í”¼ë‚œê³„ë‹¨Â·íŠ¹ë³„í”¼ë‚œê³„ë‹¨",
        desc: "ìˆ˜ì„ Â·ë³€ê²½Â·ì¦ì„¤Â·í•´ì²´ ëª¨ë‘ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°.",
        metricLabel: "í•´ë‹¹ ì—¬ë¶€",
        metricType: "none",
        threshold: null,
        reportEligible: true
      },
      {
        id: "unitPartyWall",
        title: "ì„¸ëŒ€ ê°„ ê²½ê³„ë²½(ë‹¤ê°€êµ¬/ë‹¤ì„¸ëŒ€ í•´ë‹¹)",
        desc: "ìˆ˜ì„ Â·ë³€ê²½Â·ì¦ì„¤Â·í•´ì²´ ëª¨ë‘ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°.",
        metricLabel: "í•´ë‹¹ ì—¬ë¶€",
        metricType: "none",
        threshold: null,
        reportEligible: false  // ì œ11ì¡°â‘¡ ì‹ ê³  ë²”ìœ„ì—ëŠ” ì—†ìŒ(í˜„ì¬ ê¸°ì¤€)
      },
      {
        id: "exteriorFinish",
        title: "ì™¸ë²½ ë§ˆê°ì¬",
        desc: "ë²½ë©´ì  30ã¡ ì´ìƒ ìˆ˜ì„ /ë³€ê²½ì´ë©´ ëŒ€ìˆ˜ì„ . ì¦ì„¤Â·í•´ì²´ë„ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°.",
        metricLabel: "í•´ë‹¹ ë²½ë©´ì  í•©ê³„(ã¡)",
        metricType: "area",
        threshold: 30,
        reportEligible: false  // ì œ11ì¡°â‘¡ ì‹ ê³  ë²”ìœ„ì—ëŠ” ì—†ìŒ(í˜„ì¬ ê¸°ì¤€)
      }
    ];

    const ACTIONS = [
      { value: "none", label: "í•´ë‹¹ ì—†ìŒ" },
      { value: "repair", label: "ìˆ˜ì„ (ë³´ìˆ˜, êµì²´ ë“±)" },
      { value: "change", label: "ë³€ê²½(ë°°ì¹˜/êµ¬ì¡° ë³€ê²½)" },
      { value: "add", label: "ì¦ì„¤(ì¶”ê°€ ì„¤ì¹˜)" },
      { value: "remove", label: "í•´ì²´(ì² ê±°/ì‚­ì œ)" }
    ];

    /***********************
     * 2) Stepper
     ************************/
    const STEPS = [
      { id: "step1", title: "1) ê¸°ë³¸ ì •ë³´" },
      { id: "step2", title: "2) ê³µì‚¬ ì‚¬ì‹¤ ì²´í¬" },
      { id: "step3", title: "3) ìë™ íŒì • ê²°ê³¼" }
    ];
    let stepIndex = 0;

    const elStepper = document.getElementById("stepper");
    const btnBack = document.getElementById("btnBack");
    const btnNext = document.getElementById("btnNext");

    function renderStepper(){
      elStepper.innerHTML = "";
      STEPS.forEach((s, i) => {
        const div = document.createElement("div");
        div.className = "step" + (i === stepIndex ? " active" : (i < stepIndex ? " done" : ""));
        div.innerHTML = `<b>${i+1}</b><span>${s.title}</span>`;
        elStepper.appendChild(div);
      });
    }
    function showStep(i){
      stepIndex = Math.max(0, Math.min(STEPS.length-1, i));
      document.querySelectorAll(".stepView").forEach(v => v.style.display = "none");
      document.getElementById(STEPS[stepIndex].id).style.display = "";
      btnBack.disabled = stepIndex === 0;
      btnNext.textContent = stepIndex === STEPS.length-1 ? "ì™„ë£Œ" : "ë‹¤ìŒ";
      renderStepper();
      // ê²°ê³¼ëŠ” step3ì—ì„œ í•­ìƒ ìµœì‹ í™”
      if(stepIndex === 2) evaluateAndRender();
    }

    btnBack.addEventListener("click", () => showStep(stepIndex-1));
    btnNext.addEventListener("click", () => showStep(stepIndex+1));

    /***********************
     * 3) UI build: ìš©ë„ datalist + ê³µì‚¬ ì¹´ë“œ
     ************************/
    const useList = document.getElementById("useList");
    USE_OPTIONS.forEach(u => {
      const opt = document.createElement("option");
      opt.value = u;
      useList.appendChild(opt);
    });

    const worksCards = document.getElementById("worksCards");
    const state = {
      useMain: "",
      addr: "",
      memo: "",
      hasDismantle: "no",
      works: {} // id: { action, value }
    };

    function initWorksState(){
      MAJOR_REPAIR_ITEMS.forEach(it => {
        state.works[it.id] = { action: "none", value: "" };
      });
    }
    initWorksState();

    function buildWorkCard(it){
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <h3>${it.title}</h3>
        <div class="sub">${it.desc}</div>
        <div class="badge"><span class="s">ëŒ€ìˆ˜ì„  ê¸°ì¤€</span> ${it.threshold ? `ìˆ˜ì„ /ë³€ê²½ ${it.threshold}${it.metricType==="area"?"ã¡":"ê°œ"} ì´ìƒ` : "í•´ë‹¹ ì‹œ"}</div>
        <div class="miniRow">
          <div>
            <label>ê³µì‚¬ í˜•íƒœ</label>
            <select data-role="action" data-id="${it.id}">
              ${ACTIONS.map(a => `<option value="${a.value}">${a.label}</option>`).join("")}
            </select>
          </div>
          <div>
            <label>${it.metricType === "none" ? "ì¶”ê°€ ì •ë³´(ì„ íƒ)" : it.metricLabel}</label>
            <input data-role="value" data-id="${it.id}" placeholder="${it.metricType === "area" ? "ì˜ˆ: 42" : (it.metricType === "count" ? "ì˜ˆ: 3" : "ì˜ˆ: í•´ë‹¹(ê°„ë‹¨ ë©”ëª¨)")}" ${it.metricType === "none" ? "" : 'inputmode="decimal"'} />
          </div>
        </div>
        <div class="note">
          ì‹ ê³  ê°€ëŠ¥ í›„ë³´: ${it.reportEligible ? "ì˜ˆ(ë‹¨, ìˆ˜ì„  + í•´ì²´ ì—†ìŒ + ì œ11ì¡°â‘¡ ë²”ìœ„)" : "ì•„ë‹˜(í˜„ì¬ ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡ ë²”ìœ„ ë°–)"}
        </div>
      `;
      return card;
    }

    MAJOR_REPAIR_ITEMS.forEach(it => worksCards.appendChild(buildWorkCard(it)));

    // Bind inputs
    const useMainEl = document.getElementById("useMain");
    const addrEl = document.getElementById("addr");
    const memoEl = document.getElementById("memo");
    const dismantleEl = document.getElementById("hasDismantle");

    useMainEl.addEventListener("input", () => { state.useMain = useMainEl.value; renderRight(); });
    addrEl.addEventListener("input", () => { state.addr = addrEl.value; });
    memoEl.addEventListener("input", () => { state.memo = memoEl.value; });
    dismantleEl.addEventListener("change", () => { state.hasDismantle = dismantleEl.value; renderRight(); if(stepIndex===2) evaluateAndRender(); });

    worksCards.addEventListener("change", (e) => {
      const t = e.target;
      if(!t.dataset || !t.dataset.role) return;
      const id = t.dataset.id;
      if(t.dataset.role === "action"){
        state.works[id].action = t.value;
        renderRight();
        if(stepIndex===2) evaluateAndRender();
      }
    });
    worksCards.addEventListener("input", (e) => {
      const t = e.target;
      if(!t.dataset || t.dataset.role !== "value") return;
      const id = t.dataset.id;
      state.works[id].value = t.value;
      renderRight();
      if(stepIndex===2) evaluateAndRender();
    });

    /***********************
     * 4) í•µì‹¬ ë¡œì§
     * - (A) ëŒ€ìˆ˜ì„  í•´ë‹¹ ì—¬ë¶€: ì‹œí–‰ë ¹ ì œ3ì¡°ì˜2 ê¸°ì¤€
     * - (B) ì‹ ê³  ê°€ëŠ¥ ëŒ€ìˆ˜ì„  ì—¬ë¶€: ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡ ê¸°ì¤€
     *     -> "ìˆ˜ì„ "ë§Œ + í•´ì²´ ì—†ìŒ + (ë‚´ë ¥ë²½/ê¸°ë‘¥/ë³´/ì§€ë¶•í‹€/ë°©í™”êµ¬íš/ê³„ë‹¨)ë§Œ
     ************************/

    function toNumber(v){
      if(v === null || v === undefined) return NaN;
      const n = Number(String(v).replace(/,/g,"").trim());
      return Number.isFinite(n) ? n : NaN;
    }

    function evaluate(){
      const triggers = []; // {id,title,why,action,value}
      const reportViolations = []; // reasons blocking report
      let reportCandidate = true;

      // í•´ì²´ ì—¬ë¶€(ì‹ ê³ ìš”ê±´)
      const dismantle = state.hasDismantle; // no/yes/unsure
      if(dismantle === "yes") reportCandidate = false;
      if(dismantle === "unsure"){
        reportCandidate = false;
        reportViolations.push("ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ ì—¬ë¶€ê°€ ë¶ˆí™•ì‹¤í•©ë‹ˆë‹¤(ì‹ ê³  ìš”ê±´ íŒë‹¨ ë¶ˆê°€).");
      }

      MAJOR_REPAIR_ITEMS.forEach(it => {
        const w = state.works[it.id];
        const action = w.action;
        const raw = w.value;
        const num = toNumber(raw);

        if(action === "none") return;

        // (A) ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±° íŒì •
        let isMajorTrigger = false;
        let why = "";

        const isAddOrRemove = (action === "add" || action === "remove");
        const isRepairOrChange = (action === "repair" || action === "change");

        if(it.metricType === "none"){
          // ë°©í™”êµ¬íš/ê³„ë‹¨/ì„¸ëŒ€ê²½ê³„ë²½: í•´ë‹¹í•˜ë©´ ë°”ë¡œ íŠ¸ë¦¬ê±°
          isMajorTrigger = true;
          why = `â€œ${ACTIONS.find(a=>a.value===action).label}â€ ì„ íƒ`;
        } else {
          // ë‚´ë ¥ë²½/ê¸°ë‘¥/ë³´/ì§€ë¶•í‹€/ì™¸ë²½ë§ˆê°: add/removeëŠ” ìˆ˜ëŸ‰ ì¡°ê±´ ì—†ì´ íŠ¸ë¦¬ê±°
          if(isAddOrRemove){
            isMajorTrigger = true;
            why = `ì¦ì„¤/í•´ì²´ëŠ” ìˆ˜ëŸ‰ê³¼ ë¬´ê´€í•˜ê²Œ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°`;
          } else if(isRepairOrChange){
            if(Number.isFinite(num) && num >= it.threshold){
              isMajorTrigger = true;
              why = `${it.threshold}${it.metricType==="area"?"ã¡":"ê°œ"} ì´ìƒ ${action==="repair"?"ìˆ˜ì„ ":"ë³€ê²½"}`;
            } else {
              // ê¸°ì¤€ ë¯¸ë‹¬ì´ë©´ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±° ì•„ë‹˜(ì´ í•­ëª©ë§Œìœ¼ë¡œëŠ”)
              isMajorTrigger = false;
              why = `ê¸°ì¤€ ë¯¸ë‹¬(ì…ë ¥ê°’: ${raw || "ë¯¸ì…ë ¥"})`;
            }
          }
        }

        if(isMajorTrigger){
          triggers.push({
            id: it.id,
            title: it.title,
            action,
            value: raw,
            why
          });

          // (B) ì‹ ê³  ê°€ëŠ¥ ì—¬ë¶€ ì²´í¬(ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡)
          // - í•­ëª©ì´ reportEligible(true)ì—¬ì•¼ í•˜ê³ 
          // - actionì€ ë°˜ë“œì‹œ repair(ìˆ˜ì„ )ë§Œ í—ˆìš©
          // - í•´ì²´ ì—†ìŒ(no)ì´ì–´ì•¼ í•¨
          if(!it.reportEligible){
            reportCandidate = false;
            reportViolations.push(`â€œ${it.title}â€ì€(ëŠ”) í˜„ì¬ ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡ì˜ ì‹ ê³  ê°€ëŠ¥ ëŒ€ìˆ˜ì„  ë²”ìœ„ì— í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.`);
          }
          if(action !== "repair"){
            reportCandidate = false;
            reportViolations.push(`â€œ${it.title}â€ì€(ëŠ”) â€œìˆ˜ì„ â€ì´ ì•„ë‹Œ ê³µì‚¬(${ACTIONS.find(a=>a.value===action).label})ê°€ í¬í•¨ë˜ì–´ ì‹ ê³  ìš”ê±´ì— ë§ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
          }
          if(dismantle === "yes"){
            reportCandidate = false;
            reportViolations.push("ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ê°€ ìˆì–´ ì‹ ê³  ìš”ê±´(í•´ì²´ ì—†ìŒ)ì— ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.");
          }
        }
      });

      const isMajorRepair = triggers.length > 0;

      // ì‹ ê³  í›„ë³´ì¸ë°, íŠ¸ë¦¬ê±°ê°€ í•˜ë‚˜ë„ ì—†ìœ¼ë©´ ì˜ë¯¸ì—†ìŒ
      if(!isMajorRepair) reportCandidate = false;

      // ì‹ ê³  í›„ë³´ì¼ ë•Œë„ ìˆ«ììš”ê±´ ì²´í¬(ë‚´ë ¥ë²½/ê¸°ë‘¥/ë³´/ì§€ë¶•í‹€ì€ 'ìˆ˜ì„ ' + ê¸°ì¤€ì¹˜ í•„ìš”)
      if(reportCandidate){
        // triggersì— ìˆëŠ” í•­ëª©ë§Œ ë³´ë©´ ë¨
        triggers.forEach(t => {
          const it = MAJOR_REPAIR_ITEMS.find(x => x.id === t.id);
          if(!it) return;
          if(it.metricType === "area" || it.metricType === "count"){
            const n = toNumber(t.value);
            if(!Number.isFinite(n) || n < it.threshold){
              reportCandidate = false;
              reportViolations.push(`â€œ${it.title}â€ ìˆ˜ì„ ì€ ${it.threshold}${it.metricType==="area"?"ã¡":"ê°œ"} ì´ìƒì´ì–´ì•¼ ì‹ ê³  ë²”ìœ„ë¡œ ë³´ê¸° ì–´ë µìŠµë‹ˆë‹¤.`);
            }
          }
        });
      }

      return {
        isMajorRepair,
        reportCandidate,
        triggers,
        reportViolations: Array.from(new Set(reportViolations))
      };
    }

    /***********************
     * 5) Render result + right summary
     ************************/
    const kpiUse = document.getElementById("kpiUse");
    const kpiDismantle = document.getElementById("kpiDismantle");
    const kpiList = document.getElementById("kpiList");

    function renderRight(){
      kpiUse.textContent = state.useMain ? state.useMain : "ë¯¸ì…ë ¥";
      const d = state.hasDismantle;
      kpiDismantle.textContent =
        d === "no" ? "í•´ì²´ ì—†ìŒ" :
        d === "yes" ? "í•´ì²´ ìˆìŒ" : "ë¶ˆí™•ì‹¤";

      const { triggers } = evaluate();
      kpiList.innerHTML = "";
      if(triggers.length === 0){
        const li = document.createElement("li");
        li.textContent = "ì•„ì§ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±° í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.";
        li.style.color = "rgba(156,163,175,.95)";
        kpiList.appendChild(li);
        return;
      }
      triggers.forEach(t => {
        const li = document.createElement("li");
        const val = (t.value && String(t.value).trim()) ? ` / ì…ë ¥: ${t.value}` : "";
        li.textContent = `${t.title} - ${ACTIONS.find(a=>a.value===t.action).label}${val}`;
        kpiList.appendChild(li);
      });
    }

    const resultBox = document.getElementById("resultBox");
    const resultTitle = document.getElementById("resultTitle");
    const resultSub = document.getElementById("resultSub");
    const resultDetail = document.getElementById("resultDetail");
    const copyText = document.getElementById("copyText");

    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
    }

    function evaluateAndRender(){
      const r = evaluate();
      const use = state.useMain || "(ë¯¸ì…ë ¥)";
      const addr = state.addr || "(ë¯¸ì…ë ¥)";
      const memo = state.memo || "";
      const dismantle = state.hasDismantle;

      // ê²°ê³¼ ë°•ìŠ¤ ìŠ¤íƒ€ì¼
      resultBox.classList.remove("good","warn","bad");

      if(!r.isMajorRepair){
        resultBox.classList.add("warn");
        resultTitle.textContent = "íŒì •: í˜„ì¬ ì…ë ¥ë§Œìœ¼ë¡œëŠ” â€œëŒ€ìˆ˜ì„ (ì‹œí–‰ë ¹ ì œ3ì¡°ì˜2)â€ íŠ¸ë¦¬ê±°ê°€ ì—†ìŠµë‹ˆë‹¤.";
        resultSub.textContent =
          "ì¦‰, ëŒ€ìˆ˜ì„ (í—ˆê°€/ì‹ ê³ ) ë¡œì§ìœ¼ë¡œëŠ” â€˜ë¹„í•´ë‹¹â€™ì…ë‹ˆë‹¤. ë‹¤ë§Œ ì¦ì¶•Â·ê°œì¶•Â·ìš©ë„ë³€ê²½Â·ëŒ€ìˆ˜ì„  ì™¸ ì¸í—ˆê°€ ì´ìŠˆëŠ” ë³„ë„ë¡œ ê²€í† ê°€ í•„ìš”í•  ìˆ˜ ìˆì–´ìš”.";
        resultDetail.innerHTML = `
          <ul>
            <li>ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±° í•­ëª©(ë‚´ë ¥ë²½/ê¸°ë‘¥/ë³´/ì§€ë¶•í‹€/ë°©í™”êµ¬íš/ê³„ë‹¨/ì„¸ëŒ€ê²½ê³„ë²½/ì™¸ë²½ë§ˆê°)ì´ â€œê¸°ì¤€ì¹˜ ì´ìƒâ€ìœ¼ë¡œ ì²´í¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</li>
            <li>ê³µì‚¬ ë²”ìœ„ë¥¼ ë” ì •í™•íˆ ì²´í¬í•˜ë©´ ê²°ê³¼ê°€ ë°”ë€” ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
          </ul>
        `;
        copyText.textContent =
`[ëŒ€ìˆ˜ì„  í—ˆê°€/ì‹ ê³  íŒì • ìš”ì•½]
- ì†Œì¬ì§€: ${addr}
- ìš©ë„: ${use}
- ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´: ${dismantle}
- í˜„ì¬ ì²´í¬ ê¸°ì¤€: ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±° ì—†ìŒ(ì‹œí–‰ë ¹ ì œ3ì¡°ì˜2 ê¸°ì¤€)
- ê²°ë¡ : ëŒ€ìˆ˜ì„ (í—ˆê°€/ì‹ ê³ ) ëŒ€ìƒì€ ì•„ë‹Œ ê²ƒìœ¼ë¡œ ë³´ì„(ì…ë ¥ ê¸°ì¤€)
- ë©”ëª¨: ${memo}`.trim();

        return;
      }

      // ëŒ€ìˆ˜ì„ ì€ ë§ìŒ
      if(r.reportCandidate){
        resultBox.classList.add("good");
        resultTitle.textContent = "íŒì •: ëŒ€ìˆ˜ì„  â€˜ì‹ ê³ â€™ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤. (ê±´ì¶•ì‹ ê³ ë¡œ ê°ˆìŒ)";
        resultSub.textContent =
          "ì…ë ¥ëœ ê³µì‚¬ëŠ” â€˜ìˆ˜ì„ â€™ ì¤‘ì‹¬ì´ë©°, ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡ì˜ ì‹ ê³  ê°€ëŠ¥ ëŒ€ìˆ˜ì„  ë²”ìœ„ì— ë“¤ì–´ì˜µë‹ˆë‹¤.";
      } else {
        // permit likely
        resultBox.classList.add("bad");
        resultTitle.textContent = "íŒì •: ëŒ€ìˆ˜ì„  â€˜í—ˆê°€â€™ ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤. (ì‹ ê³  ìš”ê±´ì„ ë²—ì–´ë‚¨)";
        resultSub.textContent =
          "ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°ëŠ” ë§ì§€ë§Œ, â€˜ì‹ ê³ ë¡œ ê°€ëŠ¥í•œ ëŒ€ìˆ˜ì„ â€™ ìš”ê±´(ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡)ì„ ì¶©ì¡±í•˜ì§€ ëª»í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
      }

      const triggerLines = r.triggers.map(t => {
        const val = (t.value && String(t.value).trim()) ? ` (ì…ë ¥: ${escapeHtml(t.value)})` : "";
        return `<li><b>${escapeHtml(t.title)}</b> - ${escapeHtml(ACTIONS.find(a=>a.value===t.action).label)}${val}<br/><span style="color:rgba(156,163,175,.95);font-size:12px">${escapeHtml(t.why)}</span></li>`;
      }).join("");

      const blockLines = (r.reportViolations.length ? r.reportViolations.map(v => `<li>${escapeHtml(v)}</li>`).join("") : "");

      resultDetail.innerHTML = `
        <div class="hint">
          <b>ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°(ì…ë ¥ ê¸°ë°˜)</b>
          <ul>${triggerLines}</ul>
        </div>
        <div class="hr"></div>
        <div class="hint">
          <b>ì‹ ê³  ê°€ëŠ¥ ì—¬ë¶€ ì²´í¬(ë§‰íˆëŠ” ì´ìœ )</b>
          ${r.reportCandidate ? "<div class='note'>í˜„ì¬ ì…ë ¥ ê¸°ì¤€ìœ¼ë¡œëŠ” ì‹ ê³  ìš”ê±´ì„ í¬ê²Œ ë²—ì–´ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>" : `<ul>${blockLines || "<li>ì‹ ê³  ìš”ê±´ì„ ìë™ ì‚°ì¶œí•˜ëŠ” ê³¼ì •ì—ì„œ ì œì•½ì´ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</li>"}</ul>`}
          <div class="note">
            â€» â€œìˆ˜ì„ â€ì´ ì•„ë‹Œ â€œë³€ê²½/ì¦ì„¤/í•´ì²´â€ê°€ ì„ì´ë©´ í—ˆê°€ ìª½ìœ¼ë¡œ ê¸°ì›ë‹ˆë‹¤.
          </div>
        </div>
      `;

      const conclusion = r.reportCandidate
        ? "ëŒ€ìˆ˜ì„  ì‹ ê³ (ê±´ì¶•ì‹ ê³ ) ê°€ëŠ¥ì„± ë†’ìŒ"
        : "ëŒ€ìˆ˜ì„  í—ˆê°€(ê±´ì¶•í—ˆê°€) ê²€í†  í•„ìš”(ì‹ ê³  ìš”ê±´ ì´íƒˆ)";

      copyText.textContent =
`[ëŒ€ìˆ˜ì„  í—ˆê°€/ì‹ ê³  íŒì • ìš”ì•½]
- ì†Œì¬ì§€: ${addr}
- ìš©ë„: ${use}
- ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´: ${dismantle}
- ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°: ${r.triggers.map(t => `${t.title}:${ACTIONS.find(a=>a.value===t.action).label}${t.value?`(${t.value})`:""}`).join(", ")}
- ê²°ë¡ : ${conclusion}
- ë©”ëª¨: ${memo}

[ì£¼ì˜]
- ì´ ê²°ê³¼ëŠ” ì…ë ¥ëœ â€œê³µì‚¬ ì‚¬ì‹¤â€ ê¸°ì¤€ ìë™íŒì •ì…ë‹ˆë‹¤.
- í˜„ì¥ ì—¬ê±´, ì¡°ë¡€, êµ¬ì¡°ì•ˆì „/ë°©í™”/í”¼ë‚œ/ì„¤ë¹„ ë“± ë‹¤ë¥¸ ì¸í—ˆê°€ ìš”ê±´ì€ ë³„ë„ ê²€í† ê°€ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`.trim();
    }

    /***********************
     * 6) Buttons: copy/reset
     ************************/
    document.getElementById("btnCopy").addEventListener("click", async () => {
      try{
        await navigator.clipboard.writeText(copyText.textContent);
        alert("ìš”ì•½ì„ í´ë¦½ë³´ë“œì— ë³µì‚¬í–ˆì–´ìš”!");
      }catch(e){
        alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆì–´ìš”. ë¸Œë¼ìš°ì € ê¶Œí•œì„ í™•ì¸í•´ ì£¼ì„¸ìš”.");
      }
    });

    document.getElementById("btnReset").addEventListener("click", () => {
      // reset state
      state.useMain = "";
      state.addr = "";
      state.memo = "";
      state.hasDismantle = "no";
      initWorksState();

      // reset UI
      useMainEl.value = "";
      addrEl.value = "";
      memoEl.value = "";
      dismantleEl.value = "no";

      // reset cards
      MAJOR_REPAIR_ITEMS.forEach(it => {
        const a = worksCards.querySelector(`select[data-role="action"][data-id="${it.id}"]`);
        const v = worksCards.querySelector(`input[data-role="value"][data-id="${it.id}"]`);
        if(a) a.value = "none";
        if(v) v.value = "";
      });

      renderRight();
      showStep(0);
    });

    /***********************
     * 7) Initial render
     ************************/
    renderStepper();
    renderRight();
    showStep(0);
  </script>
</body>
</html>
