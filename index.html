<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ëŒ€ìˆ˜ì„  í—ˆê°€/ì‹ ê³  íŒì •ê¸° (MVP) + ìš©ë„ë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸</title>
  <style>
    :root{
      --bg:#f6f8fc;
      --card:#ffffff;
      --ink:#0f172a;
      --muted:#475569;
      --line:#e2e8f0;
      --soft:#f1f5f9;
      --accent:#2563eb;
      --accent2:#06b6d4;
      --good:#16a34a;
      --warn:#f59e0b;
      --bad:#dc2626;
      --shadow: 0 12px 30px rgba(15,23,42,.08);
      --radius: 18px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", "Apple SD Gothic Neo", "Malgun Gothic", Arial, sans-serif;
      background: radial-gradient(1200px 600px at 10% 0%, #eef2ff 0%, transparent 55%),
                  radial-gradient(900px 500px at 90% 10%, #ecfeff 0%, transparent 50%),
                  var(--bg);
      color:var(--ink);
    }

    .wrap{
      max-width: 1200px;
      margin: 26px auto 56px;
      padding: 0 16px;
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap: 16px;
    }

    @media (max-width: 980px){
      .wrap{grid-template-columns: 1fr; }
    }

    .topbar{
      max-width: 1200px;
      margin: 22px auto 0;
      padding: 0 16px;
    }

    .hero{
      background: linear-gradient(180deg, rgba(255,255,255,.95), rgba(255,255,255,.86));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px 16px 14px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
    }

    .hero h1{
      font-size: 18px;
      margin: 0 0 4px;
      letter-spacing: -0.2px;
    }
    .hero p{
      margin: 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.45;
    }
    .chips{
      display:flex;
      gap: 8px;
      flex-wrap:wrap;
      justify-content:flex-end;
      margin-top: 2px;
    }
    .chip{
      font-size: 12px;
      padding: 8px 10px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: #ffffff;
      color: var(--muted);
      white-space:nowrap;
      display:flex;
      align-items:center;
      gap: 6px;
    }
    .dot{width:8px;height:8px;border-radius:99px;display:inline-block}
    .dot.a{background: var(--accent2)}
    .dot.b{background: var(--accent)}
    .dot.c{background: #0ea5e9}

    .card{
      background: var(--card);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardHead{
      padding: 14px 16px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(180deg, #ffffff, #fbfdff);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .cardHead h2{
      font-size: 14px;
      margin:0;
      letter-spacing:-0.1px;
    }
    .cardHead .sub{
      font-size: 12px;
      color: var(--muted);
      margin-top: 2px;
    }

    .content{ padding: 16px; }

    .steps{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      padding: 12px 16px;
      border-bottom: 1px solid var(--line);
      background: #f8fbff;
    }
    .stepPill{
      display:flex;
      align-items:center;
      gap: 10px;
      padding: 8px 10px;
      border:1px solid var(--line);
      border-radius: 999px;
      background:#ffffff;
      font-size: 13px;
      color: var(--muted);
      user-select:none;
    }
    .stepPill.active{
      border-color: rgba(37,99,235,.35);
      box-shadow: 0 0 0 4px rgba(37,99,235,.10);
      color: var(--ink);
    }
    .stepNum{
      width: 22px; height: 22px;
      border-radius: 99px;
      display:grid; place-items:center;
      background: #e8f0ff;
      color: var(--accent);
      font-weight: 700;
      font-size: 12px;
    }
    .navBtns{
      display:flex;
      gap: 10px;
      align-items:center;
    }
    button{
      border: 1px solid var(--line);
      background: #ffffff;
      border-radius: 12px;
      padding: 10px 12px;
      font-weight: 700;
      cursor: pointer;
      color: var(--ink);
    }
    button.primary{
      background: var(--accent);
      border-color: rgba(37,99,235,.4);
      color:#fff;
    }
    button:disabled{
      opacity:.55;
      cursor:not-allowed;
    }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 740px){
      .grid2{grid-template-columns:1fr}
    }

    .field{
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 12px;
      background: linear-gradient(180deg, #ffffff, #fbfdff);
    }
    .field.blue{
      border-color: rgba(37,99,235,.25);
    }
    .field.blue:focus-within{
      border-color: rgba(37,99,235,.60);
      box-shadow: 0 0 0 5px rgba(37,99,235,.12);
    }
    label{
      display:block;
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
      font-weight: 700;
    }
    .hint{
      font-size: 12px;
      color: var(--muted);
      margin-top: 8px;
      line-height: 1.45;
    }
    input, select{
      width: 100%;
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 10px 10px;
      font-size: 14px;
      background:#fff;
      color: var(--ink);
      outline:none;
    }
    input:focus, select:focus{
      border-color: rgba(6,182,212,.65);
      box-shadow: 0 0 0 4px rgba(6,182,212,.12);
    }

    .notice{
      padding: 12px;
      border-radius: 14px;
      background: #fff7ed;
      border: 1px solid rgba(245,158,11,.35);
      color: #7c2d12;
      font-size: 13px;
      line-height: 1.45;
      display:flex;
      gap:10px;
      align-items:flex-start;
    }
    .notice .badge{
      flex: 0 0 auto;
      width: 22px; height: 22px;
      border-radius: 99px;
      display:grid; place-items:center;
      background: rgba(245,158,11,.15);
      border: 1px solid rgba(245,158,11,.25);
      font-weight: 900;
    }

    .resultBanner{
      border-radius: 16px;
      padding: 14px;
      border: 1px solid var(--line);
      background: #ffffff;
    }
    .resultBanner h3{
      margin: 0 0 6px;
      font-size: 15px;
      letter-spacing:-0.1px;
    }
    .resultBanner p{
      margin: 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.45;
    }

    .status{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 800;
      margin-bottom: 10px;
      border:1px solid var(--line);
      background:#fff;
    }
    .status.good{color: #0b5d2a; border-color: rgba(22,163,74,.35); background: rgba(22,163,74,.08)}
    .status.warn{color: #7a4b00; border-color: rgba(245,158,11,.40); background: rgba(245,158,11,.10)}
    .status.neutral{color: #0f172a; border-color: rgba(2,132,199,.25); background: rgba(2,132,199,.07)}
    .status.bad{color: #7f1d1d; border-color: rgba(220,38,38,.35); background: rgba(220,38,38,.08)}

    .list{
      margin: 10px 0 0;
      padding-left: 18px;
      color: var(--ink);
      font-size: 13px;
      line-height: 1.5;
    }
    .list li{ margin: 6px 0; }
    .muted{ color: var(--muted); }

    .divider{height:1px;background: var(--line); margin: 14px 0;}

    .miniCard{
      border:1px solid var(--line);
      border-radius: 14px;
      padding: 12px;
      background: #ffffff;
    }
    .miniTitle{
      font-size: 12px;
      color: var(--muted);
      font-weight: 900;
      margin-bottom: 8px;
    }
    .kv{
      display:flex;
      justify-content:space-between;
      gap: 10px;
      padding: 8px 0;
      border-bottom: 1px dashed rgba(148,163,184,.5);
      font-size: 13px;
    }
    .kv:last-child{border-bottom:none}
    .kv b{font-weight:900}
    .rightSticky{
      position: sticky;
      top: 16px;
      align-self: start;
    }
    @media (max-width: 980px){
      .rightSticky{position: static;}
    }

    details{
      border:1px solid var(--line);
      border-radius: 14px;
      background:#fff;
      overflow:hidden;
    }
    summary{
      cursor:pointer;
      padding: 12px 14px;
      font-weight: 900;
      font-size: 13px;
      color: var(--ink);
      list-style:none;
      user-select:none;
      background: #f8fafc;
      border-bottom:1px solid var(--line);
    }
    details[open] summary{border-bottom:1px solid var(--line)}
    .detailsBody{padding: 12px 14px; font-size: 13px; color: var(--muted); line-height:1.5}

    .copyArea{
      width: 100%;
      height: 170px;
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 10px;
      font-size: 12px;
      background: #0b1220;
      color: #e5e7eb;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      resize: vertical;
    }
    .copyRow{display:flex; gap:10px; align-items:center; margin-top: 10px}
    .copyRow button{flex:0 0 auto}

    .tag{
      display:inline-flex;
      align-items:center;
      gap: 6px;
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: #fff;
      color: var(--muted);
    }
    .tag.ok{border-color: rgba(22,163,74,.35); background: rgba(22,163,74,.06); color:#0b5d2a}
    .tag.no{border-color: rgba(220,38,38,.35); background: rgba(220,38,38,.06); color:#7f1d1d}

    /* âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸ UI */
    .tabs{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top: 6px;
    }
    .tabBtn{
      padding: 8px 10px;
      border-radius: 999px;
      border:1px solid var(--line);
      background:#fff;
      font-size:12px;
      font-weight:900;
      color: var(--muted);
      cursor:pointer;
      user-select:none;
    }
    .tabBtn.active{
      border-color: rgba(37,99,235,.35);
      box-shadow: 0 0 0 4px rgba(37,99,235,.10);
      color: var(--ink);
    }

    .checkWrap{
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 10px;
    }
    .useBlock{
      border:1px solid var(--line);
      border-radius: 14px;
      overflow:hidden;
      background:#fff;
    }
    .useHead{
      padding: 12px 14px;
      background: #f8fafc;
      border-bottom:1px solid var(--line);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
    }
    .useHead b{font-size:13px}
    .useHead .small{
      font-size:12px;
      color: var(--muted);
      line-height:1.35;
    }
    .stageGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      padding: 12px 14px;
    }
    @media (max-width: 740px){
      .stageGrid{grid-template-columns:1fr}
    }
    .stageCard{
      border:1px solid var(--line);
      border-radius: 14px;
      padding: 10px 10px 8px;
      background: linear-gradient(180deg, #ffffff, #fbfdff);
    }
    .stageTitle{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 8px;
      margin-bottom: 6px;
    }
    .stageTitle span{
      font-size:12px;
      font-weight: 900;
      color: var(--ink);
    }
    .stageTitle i{
      font-style: normal;
      font-size: 11px;
      color: var(--muted);
      border:1px solid var(--line);
      border-radius: 999px;
      padding: 4px 8px;
      background:#fff;
      white-space:nowrap;
    }
    .ck{
      display:flex;
      gap:8px;
      align-items:flex-start;
      padding: 6px 0;
      border-bottom: 1px dashed rgba(148,163,184,.45);
      font-size: 13px;
      color: var(--ink);
    }
    .ck:last-child{border-bottom:none}
    .ck input{width:auto; margin-top: 3px}
    .ck small{display:block; color: var(--muted); margin-top: 2px; line-height:1.35}
  </style>
</head>

<body>
  <div class="topbar">
    <div class="hero">
      <div>
        <h1>ëŒ€ìˆ˜ì„  í—ˆê°€/ì‹ ê³  íŒì •ê¸° (MVP) + ìš©ë„ë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸</h1>
        <p>
          ì‚¬ìš©ìëŠ” â€œê³µì‚¬ ì‚¬ì‹¤â€ë§Œ ì²´í¬í•©ë‹ˆë‹¤. ë„êµ¬ê°€ <b>ëŒ€ìˆ˜ì„  í•´ë‹¹ ì—¬ë¶€</b>ì™€ <b>í—ˆê°€ vs ì‹ ê³ </b>ë¥¼ ìë™ íŒì •í•˜ê³ ,
          Step 3ì—ì„œ <b>ìš©ë„ë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸(ì‹¬ì˜â†’í—ˆê°€/ì‹ ê³ â†’ì°©ê³µâ†’ì‚¬ìš©ìŠ¹ì¸â†’ê±´ì¶•ë¬¼ëŒ€ì¥)</b>ê¹Œì§€ ë°”ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤.
        </p>
      </div>
      <div class="chips">
        <span class="chip"><span class="dot a"></span>ëŒ€ìˆ˜ì„  ë²”ìœ„: ì‹œí–‰ë ¹ ê¸°ì¤€(ê°„ì´)</span>
        <span class="chip"><span class="dot b"></span>ì‹ ê³  ê°€ëŠ¥ ë²”ìœ„: ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡(ê°„ì´)</span>
        <span class="chip"><span class="dot c"></span>ë³„í‘œ1: ìš©ë„ë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸</span>
      </div>
    </div>
  </div>

  <div class="wrap">
    <!-- LEFT -->
    <div class="card">
      <div class="cardHead">
        <div>
          <h2>ì˜ì‚¬ê²°ì • ì§„í–‰ìƒí™©</h2>
          <div class="sub">â€œí—ˆê°€/ì‹ ê³ â€ë¥¼ ë¬»ì§€ ì•ŠìŠµë‹ˆë‹¤. ê³µì‚¬ ì‚¬ì‹¤ ì…ë ¥ â†’ ìë™ íŒì •</div>
        </div>
        <div class="navBtns">
          <button id="btnPrev">ì´ì „</button>
          <button id="btnNext" class="primary">ë‹¤ìŒ</button>
        </div>
      </div>

      <div class="steps">
        <div class="stepPill active" data-step="1"><span class="stepNum">1</span>ê¸°ë³¸ ì •ë³´</div>
        <div class="stepPill" data-step="2"><span class="stepNum">2</span>ëŒ€ìˆ˜ì„ /ì‹ ê³  ìš”ê±´</div>
        <div class="stepPill" data-step="3"><span class="stepNum">3</span>ìë™ íŒì • ê²°ê³¼</div>
      </div>

      <div class="content">
        <!-- STEP 1 -->
        <section class="step" id="step1">
          <div class="grid2">
            <div class="field blue">
              <label for="useType">ìš©ë„(ê±´ì¶•ë²• ì‹œí–‰ë ¹ [ë³„í‘œ 1] ê¸°ë°˜, ê°„ì´ ì„ íƒ)</label>
              <select id="useType"></select>
              <div class="hint">
                ìš©ë„ëŠ” Step 3ì—ì„œ <b>ìš©ë„ë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸</b>ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” í‚¤ë¡œë„ ì“°ì…ë‹ˆë‹¤.<br/>
                ì²´í¬ë¦¬ìŠ¤íŠ¸ëŠ” <b>ë³„í‘œ1 ìˆœì„œ</b>ë¥¼ ê¸°ë³¸ìœ¼ë¡œ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.
              </div>
            </div>

            <div class="field blue">
              <label for="structDemo">ê³µì‚¬ ê³¼ì •ì—ì„œ â€œì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´(ì² ê±°)â€ê°€ ìˆë‚˜ìš”?</label>
              <select id="structDemo">
                <option value="no">ì•„ë‹ˆìš” (í•´ì²´ ì—†ìŒ)</option>
                <option value="yes">ì˜ˆ (í•´ì²´ ìˆìŒ)</option>
                <option value="unknown">ëª¨ë¥´ê² ìŒ</option>
              </select>
              <div class="hint">
                <b>ì‹ ê³  ê°€ëŠ¥ ë²”ìœ„(ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡)</b>ëŠ” ë³´í†µ â€œí•´ì²´ ì—†ìŒâ€ì„ ê°•í•˜ê²Œ ìš”êµ¬í•©ë‹ˆë‹¤.<br/>
                ëª¨ë¥´ê² ìŒì´ë©´ ê²°ê³¼ëŠ” ë³´ìˆ˜ì ìœ¼ë¡œ <b>í—ˆê°€ ê²€í† </b> ìª½ìœ¼ë¡œ ê¸°ì›ë‹ˆë‹¤.
              </div>
            </div>
          </div>

          <div style="margin-top:12px" class="notice">
            <div class="badge">!</div>
            <div>
              <b>ì…ë ¥ ë°©ì‹ ì•ˆë‚´</b><br/>
              1) â€œìˆ˜ì„ (ë³´ìˆ˜Â·êµì²´)â€ì€ ê·¸ëŒ€ë¡œ ê³ ì¹˜ëŠ” ëŠë‚Œ, 2) â€œë³€ê²½/ì¦ì„¤/í•´ì²´â€ëŠ” êµ¬ì¡°Â·ë°°ì¹˜Â·ìˆ˜ëŸ‰ì´ ë‹¬ë¼ì§€ëŠ” ëŠë‚Œìœ¼ë¡œ ì…ë ¥í•˜ì„¸ìš”.<br/>
              ì´ í˜ì´ì§€ëŠ” <span class="muted">ì§€ìì²´/ì¡°ë¡€/ì‚¬ë¡€ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆëŠ” ë¶€ë¶„</span>ì´ ìˆì–´, ìµœì¢…ì€ ê´€í• ê³¼ êµì°¨ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.
            </div>
          </div>
        </section>

        <!-- STEP 2 -->
        <section class="step" id="step2" style="display:none">
          <div class="miniCard" style="margin-bottom:12px">
            <div class="miniTitle">ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±° ì…ë ¥</div>
            <div class="muted" style="font-size:13px; line-height:1.5">
              ì•„ë˜ í•­ëª© ì¤‘ ê¸°ì¤€ì„ ë„˜ìœ¼ë©´ <b>â€œëŒ€ìˆ˜ì„  í›„ë³´â€</b>ê°€ ë©ë‹ˆë‹¤. (MVP ê°„ì´ ê¸°ì¤€)<br/>
              ê·¸ë¦¬ê³  <b>â€œì‹ ê³  ê°€ëŠ¥ ë²”ìœ„(ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡)â€</b>ëŠ” ë‹¤ìŒì„ ìš°ì„  ì²´í¬í•©ë‹ˆë‹¤:
              <ul class="list">
                <li><b>ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ ì—†ìŒ</b></li>
                <li><b>ê³µì‚¬ í˜•íƒœê°€ ìˆ˜ì„ (ë³´ìˆ˜Â·êµì²´)</b> ìœ„ì£¼ (ë³€ê²½/ì¦ì„¤/í•´ì²´ë©´ ì‹ ê³ ì—ì„œ íƒˆë½)</li>
                <li><b>ì‹ ê³ ì— í¬í•¨ë˜ëŠ” í•­ëª©ë§Œ</b>ìœ¼ë¡œ êµ¬ì„± (MVP ê¸°ì¤€: ë‚´ë ¥ë²½/ê¸°ë‘¥/ë³´/ì§€ë¶•í‹€ ì¤‘ì‹¬)</li>
              </ul>
            </div>
          </div>

          <div class="grid2">
            <!-- ë‚´ë ¥ë²½ -->
            <div class="field blue">
              <label>ë‚´ë ¥ë²½ (ê¸°ì¤€ ì˜ˆì‹œ: 30ã¡ ì´ìƒì´ë©´ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°)</label>
              <select id="bwType">
                <option value="none">í•´ë‹¹ ì—†ìŒ</option>
                <option value="repair">ìˆ˜ì„ (ë³´ìˆ˜Â·êµì²´)</option>
                <option value="change">ë³€ê²½(ë°°ì¹˜/êµ¬ì¡° ë³€ê²½)</option>
                <option value="add">ì¦ì„¤(ì¶”ê°€ ì„¤ì¹˜)</option>
                <option value="remove">í•´ì²´(ì² ê±°/ì‚­ì œ)</option>
              </select>
              <div style="height:8px"></div>
              <input id="bwAmt" type="number" min="0" step="0.1" placeholder="í•´ë‹¹ ë©´ì  í•©ê³„(ã¡) ì˜ˆ: 60" />
              <div class="hint">ì‹ ê³  í›„ë³´: <b>ìˆ˜ì„ </b> + (í•´ì²´ ì—†ìŒ) ì¡°ê±´ì—ì„œë§Œ ìœ ë¦¬</div>
            </div>

            <!-- ê¸°ë‘¥ -->
            <div class="field blue">
              <label>ê¸°ë‘¥ (ê¸°ì¤€ ì˜ˆì‹œ: 3ê°œ ì´ìƒì´ë©´ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°)</label>
              <select id="colType">
                <option value="none">í•´ë‹¹ ì—†ìŒ</option>
                <option value="repair">ìˆ˜ì„ (ë³´ìˆ˜Â·êµì²´)</option>
                <option value="change">ë³€ê²½(ë°°ì¹˜/êµ¬ì¡° ë³€ê²½)</option>
                <option value="add">ì¦ì„¤(ì¶”ê°€ ì„¤ì¹˜)</option>
                <option value="remove">í•´ì²´(ì² ê±°/ì‚­ì œ)</option>
              </select>
              <div style="height:8px"></div>
              <input id="colAmt" type="number" min="0" step="1" placeholder="í•´ë‹¹ ê°œìˆ˜(ê°œ) ì˜ˆ: 10" />
              <div class="hint">ì‹ ê³  í›„ë³´: <b>ìˆ˜ì„ </b> + (í•´ì²´ ì—†ìŒ) ì¡°ê±´ì—ì„œë§Œ ìœ ë¦¬</div>
            </div>

            <!-- ë³´ -->
            <div class="field blue">
              <label>ë³´ (ê¸°ì¤€ ì˜ˆì‹œ: 3ê°œ ì´ìƒì´ë©´ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°)</label>
              <select id="beamType">
                <option value="none">í•´ë‹¹ ì—†ìŒ</option>
                <option value="repair">ìˆ˜ì„ (ë³´ìˆ˜Â·êµì²´)</option>
                <option value="change">ë³€ê²½(ë°°ì¹˜/êµ¬ì¡° ë³€ê²½)</option>
                <option value="add">ì¦ì„¤(ì¶”ê°€ ì„¤ì¹˜)</option>
                <option value="remove">í•´ì²´(ì² ê±°/ì‚­ì œ)</option>
              </select>
              <div style="height:8px"></div>
              <input id="beamAmt" type="number" min="0" step="1" placeholder="í•´ë‹¹ ê°œìˆ˜(ê°œ) ì˜ˆ: 20" />
              <div class="hint">ì‹ ê³  í›„ë³´: <b>ìˆ˜ì„ </b> + (í•´ì²´ ì—†ìŒ) ì¡°ê±´ì—ì„œë§Œ ìœ ë¦¬</div>
            </div>

            <!-- ì§€ë¶•í‹€ -->
            <div class="field blue">
              <label>ì§€ë¶•í‹€ (ê¸°ì¤€ ì˜ˆì‹œ: 3ê°œ ì´ìƒì´ë©´ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°)</label>
              <select id="roofType">
                <option value="none">í•´ë‹¹ ì—†ìŒ</option>
                <option value="repair">ìˆ˜ì„ (ë³´ìˆ˜Â·êµì²´)</option>
                <option value="change">ë³€ê²½(ë°°ì¹˜/êµ¬ì¡° ë³€ê²½)</option>
                <option value="add">ì¦ì„¤(ì¶”ê°€ ì„¤ì¹˜)</option>
                <option value="remove">í•´ì²´(ì² ê±°/ì‚­ì œ)</option>
              </select>
              <div style="height:8px"></div>
              <input id="roofAmt" type="number" min="0" step="1" placeholder="í•´ë‹¹ ê°œìˆ˜(ê°œ) ì˜ˆ: 3" />
              <div class="hint">ì‹ ê³  í›„ë³´: <b>ìˆ˜ì„ </b> + (í•´ì²´ ì—†ìŒ) ì¡°ê±´ì—ì„œë§Œ ìœ ë¦¬</div>
            </div>

            <!-- ì™¸ë²½ ë§ˆê°ì¬ (ì‹ ê³ ì—ì„œ ì œì™¸ ì²˜ë¦¬) -->
            <div class="field blue">
              <label>ì™¸ë²½ ë§ˆê°ì¬ (ê¸°ì¤€ ì˜ˆì‹œ: 30ã¡ ì´ìƒì´ë©´ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±° â€œí›„ë³´â€ë¡œë§Œ í‘œì‹œ)</label>
              <select id="extType">
                <option value="none">í•´ë‹¹ ì—†ìŒ</option>
                <option value="repair">ìˆ˜ì„ (ë³´ìˆ˜Â·êµì²´)</option>
                <option value="change">ë³€ê²½(ë°°ì¹˜/êµ¬ì¡° ë³€ê²½)</option>
                <option value="add">ì¦ì„¤(ì¶”ê°€ ì„¤ì¹˜)</option>
                <option value="remove">í•´ì²´(ì² ê±°/ì‚­ì œ)</option>
              </select>
              <div style="height:8px"></div>
              <input id="extAmt" type="number" min="0" step="0.1" placeholder="í•´ë‹¹ ë©´ì  í•©ê³„(ã¡) ì˜ˆ: 300" />
              <div class="hint">
                MVPì—ì„œëŠ” <b>â€˜ì‹ ê³  ê°€ëŠ¥ ë²”ìœ„â€™ì—ì„œ ì œì™¸</b>ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
                (ì™¸ë²½ ë§ˆê°ì¬ëŠ” ì§€ìì²´/ì‚¬ë¡€ì— ë”°ë¼ í•´ì„ ë¶„ê¸° ê°€ëŠ¥)
              </div>
            </div>

            <div class="field">
              <label>ë©”ëª¨(ì„ íƒ)</label>
              <input id="memo" type="text" placeholder="ì˜ˆ: ë‚´ë¶€ ì² ê±° í¬í•¨, ì™¸ë²½ì€ ë™ì¼ ì¬ë£Œë¡œ êµì²´ ë“±" />
              <div class="hint">ê²°ê³¼ ìš”ì•½ ë³µì‚¬ì— ê°™ì´ í¬í•¨ë©ë‹ˆë‹¤.</div>
            </div>
          </div>

          <details style="margin-top:12px">
            <summary>ğŸ”§ ì´ MVPì˜ â€œì‹ ê³  ê°€ëŠ¥ ë²”ìœ„(ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡)â€ë¥¼ ì–´ë–»ê²Œ íŒì •í•˜ë‚˜ìš”?</summary>
            <div class="detailsBody">
              ì´ í˜ì´ì§€ëŠ” â€œì‚¬ìš©ìê°€ ë²•ì¡°ë¬¸ì„ ì½ê³  ì„ íƒâ€í•˜ì§€ ì•Šê²Œ í•˜ë ¤ê³ , ì•„ë˜ì²˜ëŸ¼ <b>ê°„ì´ íŒì • ê·œì¹™</b>ì„ ì”ë‹ˆë‹¤.<br/><br/>
              <b>ì‹ ê³  ê°€ëŠ¥</b>ìœ¼ë¡œ íŒì •í•˜ë ¤ë©´:
              <ul class="list">
                <li>ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°ê°€ 1ê°œ ì´ìƒ ë°œìƒ(= ëŒ€ìˆ˜ì„  í›„ë³´)</li>
                <li>ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ = <b>ì—†ìŒ</b></li>
                <li>íŠ¸ë¦¬ê±°ê°€ ëœ í•­ëª©ë“¤ì˜ ê³µì‚¬ í˜•íƒœê°€ ëª¨ë‘ <b>ìˆ˜ì„ (ë³´ìˆ˜Â·êµì²´)</b></li>
                <li>íŠ¸ë¦¬ê±°ê°€ ëœ í•­ëª©ì´ <b>ì‹ ê³  í—ˆìš© ëª©ë¡</b>(MVP: ë‚´ë ¥ë²½/ê¸°ë‘¥/ë³´/ì§€ë¶•í‹€) ì•ˆì— ìˆì„ ê²ƒ</li>
              </ul>
              ìœ„ ì¡°ê±´ ì¤‘ í•˜ë‚˜ë¼ë„ ê¹¨ì§€ë©´ <b>â€œëŒ€ìˆ˜ì„  í—ˆê°€ ê²€í†  í•„ìš”(ë³´ìˆ˜ì  íŒì •)â€</b>ë¡œ ë‚´ë ¤ê°‘ë‹ˆë‹¤.
            </div>
          </details>
        </section>

        <!-- STEP 3 -->
        <section class="step" id="step3" style="display:none">
          <div class="resultBanner" id="resultBanner">
            <div class="status neutral" id="statusPill">íŒì • ëŒ€ê¸°</div>
            <h3 id="resultTitle">ì…ë ¥ì„ ë°”íƒ•ìœ¼ë¡œ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.</h3>
            <p id="resultDesc" class="muted">ì¢Œì¸¡ ì…ë ¥ì„ ë°”ê¾¸ë©´ ê²°ê³¼ê°€ ì¦‰ì‹œ ê°±ì‹ ë©ë‹ˆë‹¤.</p>
          </div>

          <div class="divider"></div>

          <div class="miniCard">
            <div class="miniTitle">ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°(ë°œìƒ í•­ëª©)</div>
            <div id="triggerList" class="muted">ì•„ì§ íŠ¸ë¦¬ê±°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
          </div>

          <div style="height:12px"></div>

          <div class="miniCard">
            <div class="miniTitle">ì‹ ê³  ê°€ëŠ¥ ë²”ìœ„ ì²´í¬(ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡, ê°„ì´)</div>
            <div id="reportCheck" class="muted">ì…ë ¥ í›„ ìë™ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤.</div>
          </div>

          <div style="height:12px"></div>

          <!-- âœ… ì—¬ê¸°ë¶€í„°: ìš©ë„ë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸(ë³„í‘œ1 ìˆœì„œ) -->
          <div class="miniCard">
            <div class="miniTitle">ìš©ë„ë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸ (ì‹¬ì˜ â†’ í—ˆê°€/ì‹ ê³  â†’ ì°©ê³µ â†’ ì‚¬ìš©ìŠ¹ì¸ â†’ ê±´ì¶•ë¬¼ëŒ€ì¥)</div>
            <div class="muted" style="font-size:13px; line-height:1.5">
              ì•„ë˜ ì²´í¬ë¦¬ìŠ¤íŠ¸ëŠ” <b>ë³„í‘œ1 ìš©ë„ ìˆœì„œ</b>ë¥¼ ê¸°ì¤€ìœ¼ë¡œ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤. ìƒí™©ì— ë”°ë¼ â€œì‹¬ì˜â€ëŠ” ì—†ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
            </div>
            <div class="tabs" style="margin-top:10px">
              <button class="tabBtn active" id="tabSelected">ì„ íƒ ìš©ë„ë§Œ ë³´ê¸°</button>
              <button class="tabBtn" id="tabAll">ë³„í‘œ1 ì „ì²´(ìˆœì„œëŒ€ë¡œ) ë³´ê¸°</button>
            </div>

            <div id="checklistArea" class="checkWrap"></div>

            <div class="hint" style="margin-top:10px">
              íŒ: ì´ ì„¹ì…˜ì€ â€œì •ë³´ ì œê³µìš©â€ì…ë‹ˆë‹¤. ì‹¤ì œ ì œì¶œì„œë¥˜/ì‹¬ì˜ ì—¬ë¶€/ê²€í†  í•­ëª©ì€ ê´€í• ì²­Â·ì¡°ë¡€Â·ì‚¬ë¡€ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </div>
          </div>

          <div style="height:12px"></div>

          <div class="miniCard">
            <div class="miniTitle">ë³µì‚¬ ê°€ëŠ¥í•œ ìš”ì•½</div>
            <textarea class="copyArea" id="copyBox" readonly></textarea>
            <div class="copyRow">
              <button class="primary" id="btnCopy">ìš”ì•½ ë³µì‚¬</button>
              <span class="muted" id="copyMsg"></span>
            </div>
          </div>
        </section>
      </div>
    </div>

    <!-- RIGHT -->
    <div class="rightSticky">
      <div class="card">
        <div class="cardHead">
          <div>
            <h2>í˜„ì¬ ì…ë ¥ ìš”ì•½</h2>
            <div class="sub">â€œë‚´ê°€ ë­˜ ì²´í¬í–ˆì§€?â€ ë°”ë¡œ ë³´ì´ê²Œ</div>
          </div>
          <span class="tag" id="quickTag">ëŒ€ê¸°</span>
        </div>
        <div class="content">
          <div class="miniCard">
            <div class="miniTitle">ê¸°ë³¸</div>
            <div class="kv"><span>ìš©ë„</span><b id="sumUse">-</b></div>
            <div class="kv"><span>ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´</span><b id="sumDemo">-</b></div>
            <div class="kv"><span>ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±° ê°œìˆ˜</span><b id="sumTrig">0</b></div>
          </div>

          <div style="height:12px"></div>

          <div class="miniCard">
            <div class="miniTitle">ì²´í¬ëœ ê³µì‚¬ í•­ëª©</div>
            <div id="sumItems" class="muted">ì•„ì§ ì…ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.</div>
          </div>

          <div style="height:12px"></div>

          <details>
            <summary>ğŸ“Œ MVP ë¡œë“œë§µ(ë‹¤ìŒ í™•ì¥)</summary>
            <div class="detailsBody">
              1) â€œë³„í‘œ1 ìš©ë„â€ì— ë”°ë¼ <b>ì˜ˆì™¸/ì¶”ê°€ ê¸°ì¤€</b> ë¶™ì´ê¸°<br/>
              2) â€œì¦ì¶•/ê°œì¶•/ìš©ë„ë³€ê²½â€ê¹Œì§€ íë¦„ í™•ì¥<br/>
              3) ì¡°ë¡€/ì§€êµ¬ë‹¨ìœ„/ë°©í™”ì§€êµ¬ ë“± <b>ì¶”ê°€ ë¶„ê¸°</b> ëª¨ë“ˆí™”<br/>
              4) ê²°ê³¼ì— â€œí•„ìš” ì„œë¥˜ ì²´í¬ë¦¬ìŠ¤íŠ¸â€ ìë™ ì¶œë ¥ ê³ ë„í™”
            </div>
          </details>

          <div style="height:12px"></div>

          <div class="muted" style="font-size:12px; line-height:1.5">
            â€» ì´ ë„êµ¬ëŠ” <b>ì„¤ëª…ìš© MVP</b>ì…ë‹ˆë‹¤. ìµœì¢… íŒë‹¨ì€ ê´€í• ì²­ í•´ì„, ë„ë©´, êµ¬ì¡° ê²€í† , ì‚¬ë¡€ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  // ---------------------------
  // 1) ìš©ë„ ì˜µì…˜(ê°„ì´) + ë³„í‘œ1 ìˆœì„œ ìœ ì§€
  // ---------------------------
  const USE_OPTIONS = [
    { group: "ì£¼íƒ", items: [
      ["single", "1. ë‹¨ë…ì£¼íƒ(ë‹¨ë…/ë‹¤ê°€êµ¬/ë‹¤ì¤‘/ê³µê´€ ë“±)"],
      ["multiHouse", "1-ë‚˜. ë‹¤ì¤‘ì£¼íƒ"],
      ["multiFamily", "1-ë‹¤. ë‹¤ê°€êµ¬ì£¼íƒ"],
      ["apartment", "2-ê°€. ê³µë™ì£¼íƒ(ì•„íŒŒíŠ¸)"],
      ["row", "2-ë‚˜. ê³µë™ì£¼íƒ(ì—°ë¦½ì£¼íƒ)"],
      ["multiUnit", "2-ë‹¤. ê³µë™ì£¼íƒ(ë‹¤ì„¸ëŒ€ì£¼íƒ)"],
      ["dorm", "2-ë¼. ê¸°ìˆ™ì‚¬"]
    ]},
    { group: "ê·¼ë¦°ìƒí™œ", items: [
      ["nhood1", "3. ì œ1ì¢… ê·¼ë¦°ìƒí™œì‹œì„¤"],
      ["nhood2", "4. ì œ2ì¢… ê·¼ë¦°ìƒí™œì‹œì„¤"]
    ]},
    { group: "ê¸°íƒ€(ëŒ€í‘œ)", items: [
      ["culture", "5. ë¬¸í™” ë° ì§‘íšŒì‹œì„¤"],
      ["religion", "6. ì¢…êµì‹œì„¤"],
      ["sales", "7. íŒë§¤ì‹œì„¤"],
      ["medical", "9. ì˜ë£Œì‹œì„¤"],
      ["edu", "10. êµìœ¡ì—°êµ¬ì‹œì„¤"],
      ["elder", "11. ë…¸ìœ ìì‹œì„¤"],
      ["office", "14. ì—…ë¬´ì‹œì„¤"],
      ["lodging", "15. ìˆ™ë°•ì‹œì„¤"],
      ["factory", "17. ê³µì¥"],
      ["warehouse", "18. ì°½ê³ ì‹œì„¤"],
      ["etc", "ê¸°íƒ€/ë¯¸ìƒ"]
    ]}
  ];

  // ìš©ë„ ëª©ë¡ì„ "ë³„í‘œ1 ìˆœì„œëŒ€ë¡œ" í‰íƒ„í™” (ì „ì²´ ë³´ê¸°ìš©)
  const USE_FLAT = USE_OPTIONS.flatMap(g => g.items.map(([key, label]) => ({ key, label, group: g.group })));

  // ---------------------------
  // 2) ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°(ê°„ì´ ê·œì¹™)
  //    + ì‹ ê³  í—ˆìš© ëª©ë¡(ê°„ì´)
  // ---------------------------
  const RULES = [
    { id:"bw",   name:"ë‚´ë ¥ë²½", unit:"ã¡", threshold:30, typeEl:"bwType",   amtEl:"bwAmt",   reportAllowed:true },
    { id:"col",  name:"ê¸°ë‘¥",   unit:"ê°œ", threshold:3,  typeEl:"colType",  amtEl:"colAmt",  reportAllowed:true },
    { id:"beam", name:"ë³´",     unit:"ê°œ", threshold:3,  typeEl:"beamType", amtEl:"beamAmt", reportAllowed:true },
    { id:"roof", name:"ì§€ë¶•í‹€", unit:"ê°œ", threshold:3,  typeEl:"roofType", amtEl:"roofAmt", reportAllowed:true },
    { id:"ext",  name:"ì™¸ë²½ ë§ˆê°ì¬", unit:"ã¡", threshold:30, typeEl:"extType", amtEl:"extAmt", reportAllowed:false }
  ];

  const TYPE_LABEL = {
    none: "í•´ë‹¹ ì—†ìŒ",
    repair: "ìˆ˜ì„ (ë³´ìˆ˜Â·êµì²´)",
    change: "ë³€ê²½(ë°°ì¹˜/êµ¬ì¡° ë³€ê²½)",
    add: "ì¦ì„¤(ì¶”ê°€ ì„¤ì¹˜)",
    remove: "í•´ì²´(ì² ê±°/ì‚­ì œ)"
  };

  // ---------------------------
  // 3) ìš©ë„ë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë°ì´í„°(ê¸°ë³¸ í…œí”Œë¦¿)
  //    âœ” â€œìš©ë„ë³„ì˜ ìˆœì„œëŒ€ë¡œâ€ = USE_FLAT ìˆœì„œê°€ ê·¸ëŒ€ë¡œ ì¶œë ¥ë¨
  // ---------------------------
  const STAGES = [
    { id:"review", label:"ì‹¬ì˜", badge:"í•´ë‹¹ ì‹œ" },
    { id:"permit", label:"í—ˆê°€/ì‹ ê³ ", badge:"í•µì‹¬" },
    { id:"start", label:"ì°©ê³µ", badge:"ê³µì‚¬ ì „" },
    { id:"finish", label:"ì‚¬ìš©ìŠ¹ì¸", badge:"ì¤€ê³µ" },
    { id:"ledger", label:"ê±´ì¶•ë¬¼ëŒ€ì¥", badge:"ì‚¬í›„" }
  ];

  // ê³µí†µ ì²´í¬ í•­ëª© í…œí”Œë¦¿(ìš©ë„ë³„ë¡œ í•„ìš”í•œ ê²½ìš° ì¶”ê°€/ìˆ˜ì • ê°€ëŠ¥)
  const COMMON = {
    review: [
      { t:"ì‹¬ì˜ ëŒ€ìƒ ì—¬ë¶€ í™•ì¸(í•´ë‹¹ ì‹œ)", d:"ì§€êµ¬ë‹¨ìœ„/ê²½ê´€/êµí†µ/êµìœ¡í™˜ê²½/ë„ì‹œê³„íš ë“± ê´€í•  ê¸°ì¤€ í™•ì¸" },
      { t:"ì‚¬ì „ í˜‘ì˜(ê°€ëŠ¥í•˜ë©´)", d:"ë¯¼ì› ì°½êµ¬/ê´€ë ¨ ë¶€ì„œì™€ ìŸì  ë¯¸ë¦¬ ì •ë¦¬" }
    ],
    permit: [
      { t:"í—ˆê°€/ì‹ ê³  êµ¬ë¶„ í™•ì¸", d:"ëŒ€ìˆ˜ì„ , ì¦ì¶•, ìš©ë„ë³€ê²½ ë“± í•´ë‹¹ ì—¬ë¶€ë¥¼ ë¨¼ì € í™•ì •" },
      { t:"ê´€í•  ê¸°ì¤€ í™•ì¸", d:"ì¡°ë¡€, ì§€ì¹¨, ì‚¬ë¡€ì— ë”°ë¼ ìš”êµ¬ ì„œë¥˜ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ" },
      { t:"ë„ë©´ ë° ì œì¶œì„œë¥˜ ì¤€ë¹„", d:"ë°°ì¹˜/í‰ë©´/ì…ë©´/ë‹¨ë©´/êµ¬ì¡°/ì„¤ë¹„ ë“± ë²”ìœ„ì— ë§ì¶° ì •ë¦¬" }
    ],
    start: [
      { t:"ì°©ê³µì‹ ê³ (í•´ë‹¹ ì‹œ)", d:"í—ˆê°€/ì‹ ê³  ìœ í˜•ì— ë”°ë¥¸ ì°©ê³µ ì ˆì°¨ í™•ì¸" },
      { t:"ê°ë¦¬/ì‹œê³µì(í•´ë‹¹ ì‹œ) ì„ ì • ë° ê³„ì•½", d:"ê³µì‚¬ ë²”ìœ„, ì¼ì •, ì±…ì„ ë²”ìœ„ë¥¼ ë¬¸ì„œë¡œ ê³ ì •" },
      { t:"í˜„ì¥ ì•ˆì „Â·ë¯¼ì› ëŒ€ë¹„", d:"ê°€ì„¤, ì†ŒìŒ/ë¶„ì§„, ì•ˆì „ê³„íš, ì´ì›ƒ ì•ˆë‚´" }
    ],
    finish: [
      { t:"ì‚¬ìš©ìŠ¹ì¸(ì¤€ê³µ) ì„œë¥˜ ì¤€ë¹„", d:"ì™„ë£Œë„ì„œ, ì‚¬ì§„, ê²€ì‚¬/ì‹œí—˜ ì„±ì  ë“±" },
      { t:"í˜„ì¥ ì •ë¦¬ ë° í•˜ì ì²´í¬", d:"ì²´í¬ë¦¬ìŠ¤íŠ¸ë¡œ ëˆ„ë½ ê³µì • í™•ì¸" }
    ],
    ledger: [
      { t:"ê±´ì¶•ë¬¼ëŒ€ì¥ ì •ë¦¬/ì •ì • í•„ìš” ì—¬ë¶€ í™•ì¸", d:"ìš©ë„, ë©´ì , êµ¬ì¡°, ì¸µìˆ˜ ë“± ì •í•©ì„± í™•ì¸" },
      { t:"ëŒ€ì¥/ë„ë©´/ìŠ¹ì¸ì„œë¥˜ ë³´ê´€", d:"í–¥í›„ ë§¤ë§¤/ì„ëŒ€/ëŒ€ì¶œ/ë¶„ìŸ ëŒ€ë¹„" }
    ]
  };

  // ìš©ë„ë³„ ì»¤ìŠ¤í…€(ì§€ê¸ˆì€ ìµœì†Œ ì˜ˆì‹œë§Œ ë„£ê³ , ë‚˜ì¤‘ì— ê³„ì† ì±„ì›Œë„ ë¨)
  // í¬ì¸íŠ¸: êµ¬ì¡°ëŠ” ì´ë¯¸ ì¡í˜”ê³ , ë°ì´í„°ë§Œ ëŠ˜ë¦¬ë©´ ìë™ ë°˜ì˜ë¨.
  const CHECKLISTS = {
    // 1. ë‹¨ë…ì£¼íƒ
    single: {
      note:"ë‹¨ë…ì£¼íƒ ê³„ì—´ì€ ë‹¤ê°€êµ¬/ë‹¤ì¤‘ í¬í•¨ ì—¬ë¶€ì— ë”°ë¼ ì„¸ë¶€ ê²€í† ê°€ ê°ˆë¦½ë‹ˆë‹¤.",
      ...COMMON
    },
    multiHouse: {
      note:"ë‹¤ì¤‘ì£¼íƒì€ â€˜ì·¨ì‚¬ì‹œì„¤ ì—†ìŒâ€™ ë“± ìš”ê±´ì´ ìŸì ì´ ë˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.",
      ...COMMON
    },
    multiFamily: {
      note:"ë‹¤ê°€êµ¬ëŠ” â€˜ê³µë™ì£¼íƒ í•´ë‹¹ ì—¬ë¶€â€™(ì„¸ëŒ€ìˆ˜/ë©´ì /ì¸µìˆ˜)ì™€ í‘œê¸° ì¼ê´€ì„±ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.",
      ...COMMON
    },

    // 2. ê³µë™ì£¼íƒ
    apartment: { note:"ì•„íŒŒíŠ¸ëŠ” ê·œëª¨/ì†Œë°©/í”¼ë‚œ ë“± ë³„ë„ ê¸°ì¤€ì´ ì–¹íˆëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.", ...COMMON },
    row:       { note:"ì—°ë¦½ì€ 660ã¡ ì´ˆê³¼ ì—¬ë¶€ ë“± ê¸°ë³¸ ì •ì˜ë¶€í„° ë¨¼ì € ì²´í¬í•˜ì„¸ìš”.", ...COMMON },
    multiUnit: { note:"ë‹¤ì„¸ëŒ€ëŠ” 660ã¡ ì´í•˜ + 4ì¸µ ì´í•˜ ê¸°ë³¸ ì •ì˜ í™•ì¸ì´ ì¶œë°œì ì…ë‹ˆë‹¤.", ...COMMON },
    dorm:      { note:"ê¸°ìˆ™ì‚¬ëŠ” ê³ ì‹œ ê¸°ì¤€(ê³µê°„ êµ¬ì„±/ê³µë™ì·¨ì‚¬ ë¹„ìœ¨ ë“±) í™•ì¸ì´ í•µì‹¬ì…ë‹ˆë‹¤.", ...COMMON },

    // 3~4. ê·¼ë¦°ìƒí™œ
    nhood1: { note:"1ì¢… ê·¼ìƒì€ ì„¸ë¶€ì—…ì¢…/ë©´ì í•©ê³„ì— ë”°ë¼ ë¶„ë¥˜ê°€ ê°ˆë¦½ë‹ˆë‹¤.", ...COMMON },
    nhood2: { note:"2ì¢… ê·¼ìƒì€ ì—…ì¢… íŠ¹ì„±(ìŒì‹ì /í•™ì›/ë…¸ë˜ì—°ìŠµì¥ ë“±)ë¡œ ë¶„ê¸°ë©ë‹ˆë‹¤.", ...COMMON },

    // ê¸°íƒ€(ëŒ€í‘œ)
    culture:  { note:"ë¬¸í™”/ì§‘íšŒëŠ” ê´€ëŒì„/ê·œëª¨ì— ë”°ë¥¸ ë¶„ë¥˜ì™€ ì•ˆì „ ê¸°ì¤€ì„ í™•ì¸í•˜ì„¸ìš”.", ...COMMON },
    religion: { note:"ì¢…êµì‹œì„¤ì€ ì§‘íšŒê³µê°„ ê·œëª¨ì™€ ë¶€ì†ì‹œì„¤ í¬í•¨ ë²”ìœ„ë¥¼ ì •ë¦¬í•˜ì„¸ìš”.", ...COMMON },
    sales:    { note:"íŒë§¤ì‹œì„¤ì€ â€˜ëŒ€ê·œëª¨ ì í¬â€™ ì—¬ë¶€ì™€ ë¶€ì† ê·¼ìƒ í¬í•¨ ê´€ê³„ë¥¼ í™•ì¸í•˜ì„¸ìš”.", ...COMMON },
    medical:  { note:"ì˜ë£Œì‹œì„¤ì€ ë³‘ì› ì¢…ë¥˜ì— ë”°ë¼ ë³„ë„ ë²•ë ¹ ìš”ê±´ì´ ì–¹í™ë‹ˆë‹¤.", ...COMMON },
    edu:      { note:"êµìœ¡ì—°êµ¬ì‹œì„¤ì€ í•™ì›(ê·¼ìƒ)ê³¼ì˜ ê²½ê³„ê°€ ìì£¼ ìŸì ì…ë‹ˆë‹¤.", ...COMMON },
    elder:    { note:"ë…¸ìœ ìì‹œì„¤ì€ ì•ˆì „/í”¼ë‚œ/ì¥ì• ì¸ í¸ì˜ ë“± ì¶”ê°€ ê²€í† ê°€ ë¹ˆë²ˆí•©ë‹ˆë‹¤.", ...COMMON },
    office:   { note:"ì—…ë¬´ì‹œì„¤ì€ ì˜¤í”¼ìŠ¤í…” ë“± í¬í•¨ ì—¬ë¶€ì— ë”°ë¼ ê¸°ì¤€ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.", ...COMMON },
    lodging:  { note:"ìˆ™ë°•ì‹œì„¤ì€ ì‹ ê³ /í—ˆê°€ ë° ìœ„ìƒ ê´€ë ¨ ì ˆì°¨ê°€ ì—°ë™ë˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤.", ...COMMON },
    factory:  { note:"ê³µì¥ì€ ë°°ì¶œì‹œì„¤/ì†ŒìŒ/ìœ„í—˜ë¬¼ ë“± ì—°ê³„ ì¸í—ˆê°€ë¥¼ í•¨ê»˜ ë³´ì„¸ìš”.", ...COMMON },
    warehouse:{ note:"ì°½ê³ ëŠ” ë¬¼ë¥˜/ìœ„í—˜ë¬¼/ë¶€ì†ìš©ë„ í•´ë‹¹ ì—¬ë¶€ë¥¼ ë¨¼ì € ì •ë¦¬í•˜ì„¸ìš”.", ...COMMON },
    etc:      { note:"ìš©ë„ê°€ ë¶ˆëª…í™•í•˜ë©´ â€˜ì‹¤ì œ ì‚¬ìš©â€™ ê¸°ì¤€ìœ¼ë¡œ ê´€í• ì— ë¨¼ì € ë¶„ë¥˜ ìƒë‹´ì„ ê¶Œí•©ë‹ˆë‹¤.", ...COMMON }
  };

  // ---------------------------
  // 4) ìƒíƒœ & ì—˜ë¦¬ë¨¼íŠ¸
  // ---------------------------
  let step = 1;
  let checklistMode = "selected"; // selected | all

  const els = {
    useType: document.getElementById("useType"),
    structDemo: document.getElementById("structDemo"),
    memo: document.getElementById("memo"),

    bwType: document.getElementById("bwType"),
    bwAmt: document.getElementById("bwAmt"),
    colType: document.getElementById("colType"),
    colAmt: document.getElementById("colAmt"),
    beamType: document.getElementById("beamType"),
    beamAmt: document.getElementById("beamAmt"),
    roofType: document.getElementById("roofType"),
    roofAmt: document.getElementById("roofAmt"),
    extType: document.getElementById("extType"),
    extAmt: document.getElementById("extAmt"),

    btnPrev: document.getElementById("btnPrev"),
    btnNext: document.getElementById("btnNext"),
    stepPills: Array.from(document.querySelectorAll(".stepPill")),
    steps: [
      document.getElementById("step1"),
      document.getElementById("step2"),
      document.getElementById("step3")
    ],

    // results
    statusPill: document.getElementById("statusPill"),
    resultTitle: document.getElementById("resultTitle"),
    resultDesc: document.getElementById("resultDesc"),
    triggerList: document.getElementById("triggerList"),
    reportCheck: document.getElementById("reportCheck"),
    copyBox: document.getElementById("copyBox"),
    btnCopy: document.getElementById("btnCopy"),
    copyMsg: document.getElementById("copyMsg"),

    // checklist
    checklistArea: document.getElementById("checklistArea"),
    tabSelected: document.getElementById("tabSelected"),
    tabAll: document.getElementById("tabAll"),

    // right summary
    quickTag: document.getElementById("quickTag"),
    sumUse: document.getElementById("sumUse"),
    sumDemo: document.getElementById("sumDemo"),
    sumTrig: document.getElementById("sumTrig"),
    sumItems: document.getElementById("sumItems")
  };

  function numVal(el){
    const v = parseFloat((el.value || "").toString().trim());
    return Number.isFinite(v) ? v : 0;
  }

  function buildUseOptions(){
    els.useType.innerHTML = "";
    USE_OPTIONS.forEach(g=>{
      const og = document.createElement("optgroup");
      og.label = g.group;
      g.items.forEach(([val, label])=>{
        const o = document.createElement("option");
        o.value = val; o.textContent = label;
        og.appendChild(o);
      });
      els.useType.appendChild(og);
    });
    els.useType.value = "multiUnit";
  }

  // ---------------------------
  // 5) íŒì • ë¡œì§
  // ---------------------------
  function compute(){
    const useLabel = els.useType.options[els.useType.selectedIndex]?.textContent || "-";
    const demo = els.structDemo.value; // no/yes/unknown

    const triggers = [];
    const selectedItems = [];

    RULES.forEach(r=>{
      const t = document.getElementById(r.typeEl).value;
      const a = numVal(document.getElementById(r.amtEl));

      if(t !== "none" || a > 0){
        selectedItems.push({
          id:r.id, name:r.name, type:t, amt:a, unit:r.unit, threshold:r.threshold, reportAllowed:r.reportAllowed
        });
      }

      if(t !== "none" && a >= r.threshold){
        triggers.push({
          id:r.id, name:r.name, type:t, amt:a, unit:r.unit, threshold:r.threshold, reportAllowed:r.reportAllowed
        });
      }
    });

    const isMajor = triggers.length > 0;

    let reportOk = false;
    let reportReasons = [];
    let reportChecks = [];

    if(!isMajor){
      reportOk = false;
      reportReasons.push("ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°ê°€ ì—†ì–´ â€˜ëŒ€ìˆ˜ì„ â€™ìœ¼ë¡œ ë³´ê¸° ì–´ë µìŠµë‹ˆë‹¤.");
    } else {
      if(demo !== "no"){
        reportReasons.push("ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ê°€ ìˆê±°ë‚˜(ë˜ëŠ” ë¶ˆëª…) ì‹ ê³  ìš”ê±´(í•´ì²´ ì—†ìŒ)ì— ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.");
      }

      const nonRepair = triggers.filter(x => x.type !== "repair");
      if(nonRepair.length){
        reportReasons.push("íŠ¸ë¦¬ê±° í•­ëª© ì¤‘ â€˜ìˆ˜ì„ â€™ì´ ì•„ë‹Œ ê³µì‚¬(ë³€ê²½/ì¦ì„¤/í•´ì²´)ê°€ í¬í•¨ë˜ì–´ ì‹ ê³  ë²”ìœ„ë¥¼ ë²—ì–´ë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
      }

      const notAllowed = triggers.filter(x => !x.reportAllowed);
      if(notAllowed.length){
        reportReasons.push("íŠ¸ë¦¬ê±° í•­ëª© ì¤‘ ì¼ë¶€ê°€ ì‹ ê³  í—ˆìš© ëª©ë¡(MVP ê¸°ì¤€) ë°–ì…ë‹ˆë‹¤.");
      }

      reportOk = (demo === "no" && nonRepair.length === 0 && notAllowed.length === 0);
    }

    if(isMajor){
      reportChecks = triggers.map(tr => {
        const ok1 = (demo === "no");
        const ok2 = (tr.type === "repair");
        const ok3 = tr.reportAllowed;

        const ok = ok1 && ok2 && ok3;
        const why = [];
        if(!ok1) why.push("í•´ì²´ ì—†ìŒ ìš”ê±´ ë¶ˆì¶©ì¡±");
        if(!ok2) why.push("ìˆ˜ì„ ì´ ì•„ë‹˜");
        if(!ok3) why.push("ì‹ ê³  í—ˆìš© ëª©ë¡ ë°–(MVP)");
        return { ok, name: tr.name, type: tr.type, amt: tr.amt, unit: tr.unit, why };
      });
    }

    let decision = "WAIT";
    let title = "ì…ë ¥ì„ ë°”íƒ•ìœ¼ë¡œ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.";
    let desc = "ì¢Œì¸¡ ì…ë ¥ì„ ë°”ê¾¸ë©´ ê²°ê³¼ê°€ ì¦‰ì‹œ ê°±ì‹ ë©ë‹ˆë‹¤.";

    if(!isMajor){
      decision = "NOT_MAJOR";
      title = "íŒì •: ëŒ€ìˆ˜ì„  ì•„ë‹˜(ë˜ëŠ” ê²½ë¯¸ ìˆ˜ì„  ë²”ì£¼ì¼ ê°€ëŠ¥ì„±)";
      desc = "í˜„ì¬ ì…ë ¥ ê¸°ì¤€ì—ì„œëŠ” ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ë§Œ ì¦ì¶•/ìš©ë„ë³€ê²½ ë“±ì€ ë³„ë„ ë¡œì§ì´ í•„ìš”í•©ë‹ˆë‹¤.";
    } else if(reportOk){
      decision = "REPORT_OK";
      title = "íŒì •: ëŒ€ìˆ˜ì„  â€˜ì‹ ê³ â€™ ê°€ëŠ¥ í›„ë³´ì…ë‹ˆë‹¤.";
      desc = "ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°ëŠ” ë°œìƒí–ˆê³ , (í•´ì²´ ì—†ìŒ) + (ìˆ˜ì„  ì¤‘ì‹¬) + (ì‹ ê³  í—ˆìš© í•­ëª©) ì¡°ê±´ì„ ë§Œì¡±í•©ë‹ˆë‹¤. ê´€í• ì²­ í•´ì„ê³¼ ì„œë¥˜ ìš”ê±´ì„ í•¨ê»˜ í™•ì¸í•˜ì„¸ìš”.";
    } else {
      decision = "PERMIT";
      title = "íŒì •: ëŒ€ìˆ˜ì„  â€˜í—ˆê°€â€™ ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤. (ì‹ ê³  ìš”ê±´ì„ ë²—ì–´ë‚¨)";
      desc = "ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°ëŠ” ë°œìƒí–ˆê³ , ì‹ ê³  ê°€ëŠ¥ ë²”ìœ„(ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡, ê°„ì´)ì˜ ì¡°ê±´ì„ ì¶©ì¡±í•˜ì§€ ëª»í•œ ì‚¬ìœ ê°€ ìˆìŠµë‹ˆë‹¤. ë³´ìˆ˜ì  íŒì •ìœ¼ë¡œ ë¦¬ìŠ¤í¬ë¥¼ ì¤„ì´ëŠ” ë°©í–¥ì…ë‹ˆë‹¤.";
    }

    return { useLabel, demo, triggers, selectedItems, isMajor, reportOk, reportReasons, reportChecks, decision, title, desc };
  }

  // ---------------------------
  // 6) ìš©ë„ë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë Œë”
  // ---------------------------
  function checklistDataFor(key){
    return CHECKLISTS[key] || { note:"", ...COMMON };
  }

  function renderChecklistBlock(useKey, useLabel){
    const data = checklistDataFor(useKey);

    const block = document.createElement("div");
    block.className = "useBlock";

    const head = document.createElement("div");
    head.className = "useHead";
    head.innerHTML = `
      <div>
        <b>${useLabel}</b>
        <div class="small">${data.note ? data.note : " "}</div>
      </div>
      <div class="tag">ì²´í¬ë¦¬ìŠ¤íŠ¸</div>
    `;
    block.appendChild(head);

    const grid = document.createElement("div");
    grid.className = "stageGrid";

    STAGES.forEach(s=>{
      const card = document.createElement("div");
      card.className = "stageCard";

      const title = document.createElement("div");
      title.className = "stageTitle";
      title.innerHTML = `<span>${s.label}</span><i>${s.badge}</i>`;
      card.appendChild(title);

      const items = (data[s.id] || []).length ? data[s.id] : [];
      if(items.length === 0){
        const empty = document.createElement("div");
        empty.className = "muted";
        empty.style.fontSize = "13px";
        empty.textContent = "í•­ëª©ì„ ì¶”ê°€í•˜ì„¸ìš”.";
        card.appendChild(empty);
      } else {
        items.forEach((it, idx)=>{
          const row = document.createElement("label");
          row.className = "ck";
          row.innerHTML = `
            <input type="checkbox" data-ck="${useKey}:${s.id}:${idx}">
            <div>
              <div><b>${escapeHtml(it.t)}</b></div>
              ${it.d ? `<small>${escapeHtml(it.d)}</small>` : ""}
            </div>
          `;
          card.appendChild(row);
        });
      }

      grid.appendChild(card);
    });

    block.appendChild(grid);
    return block;
  }

  function renderChecklists(){
    els.checklistArea.innerHTML = "";

    const selectedKey = els.useType.value;
    const selectedLabel = els.useType.options[els.useType.selectedIndex]?.textContent || "-";

    if(checklistMode === "selected"){
      els.checklistArea.appendChild(renderChecklistBlock(selectedKey, selectedLabel));
    } else {
      // ë³„í‘œ1 ìˆœì„œëŒ€ë¡œ ì „ì²´ ì¶œë ¥
      USE_FLAT.forEach(u=>{
        els.checklistArea.appendChild(renderChecklistBlock(u.key, u.label));
      });
    }
  }

  function escapeHtml(str){
    return (str ?? "").toString()
      .replaceAll("&", "&amp;")
      .replaceAll("<", "&lt;")
      .replaceAll(">", "&gt;")
      .replaceAll('"', "&quot;")
      .replaceAll("'", "&#039;");
  }

  // ---------------------------
  // 7) ë Œë”(ê¸°ì¡´ + ì²´í¬ë¦¬ìŠ¤íŠ¸ í¬í•¨)
  // ---------------------------
  function setStatus(decision){
    els.statusPill.className = "status neutral";
    els.quickTag.className = "tag";

    if(decision === "REPORT_OK"){
      els.statusPill.className = "status good";
      els.statusPill.textContent = "ëŒ€ìˆ˜ì„  ì‹ ê³  ê°€ëŠ¥ í›„ë³´";
      els.quickTag.className = "tag ok";
      els.quickTag.textContent = "ì‹ ê³  í›„ë³´";
    } else if(decision === "PERMIT"){
      els.statusPill.className = "status warn";
      els.statusPill.textContent = "ëŒ€ìˆ˜ì„  í—ˆê°€ ê²€í† ";
      els.quickTag.className = "tag no";
      els.quickTag.textContent = "í—ˆê°€ ê²€í† ";
    } else if(decision === "NOT_MAJOR"){
      els.statusPill.className = "status neutral";
      els.statusPill.textContent = "ëŒ€ìˆ˜ì„  ì•„ë‹˜";
      els.quickTag.className = "tag";
      els.quickTag.textContent = "ëŒ€ìˆ˜ì„  ì•„ë‹˜";
    } else {
      els.statusPill.className = "status neutral";
      els.statusPill.textContent = "íŒì • ëŒ€ê¸°";
      els.quickTag.className = "tag";
      els.quickTag.textContent = "ëŒ€ê¸°";
    }
  }

  function render(){
    const r = compute();

    setStatus(r.decision);
    els.resultTitle.textContent = r.title;
    els.resultDesc.textContent = r.desc;

    if(r.triggers.length === 0){
      els.triggerList.textContent = "ì•„ì§ íŠ¸ë¦¬ê±°ê°€ ì—†ìŠµë‹ˆë‹¤.";
    } else {
      const ul = document.createElement("ul");
      ul.className = "list";
      r.triggers.forEach(t=>{
        const li = document.createElement("li");
        li.innerHTML = `<b>${t.name}</b> Â· ${TYPE_LABEL[t.type]} Â· ${t.amt}${t.unit} (ê¸°ì¤€ ${t.threshold}${t.unit})`;
        ul.appendChild(li);
      });
      els.triggerList.innerHTML = "";
      els.triggerList.appendChild(ul);
    }

    if(!r.isMajor){
      els.reportCheck.innerHTML = `<span class="muted">ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°ê°€ ì—†ìœ¼ë¯€ë¡œ ì‹ ê³ /í—ˆê°€ íŒì • ë‹¨ê³„ë¡œ ì§„ì…í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</span>`;
    } else {
      const parts = [];
      if(r.reportChecks.length){
        parts.push(`<div style="display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px">
          <span class="tag ${r.demo === "no" ? "ok":"no"}">${r.demo === "no" ? "í•´ì²´ ì—†ìŒ":"í•´ì²´ ìˆìŒ/ë¶ˆëª…"}</span>
          <span class="tag ${r.reportOk ? "ok":"no"}">${r.reportOk ? "ì‹ ê³  ìš”ê±´(ê°„ì´) ì¶©ì¡±":"ì‹ ê³  ìš”ê±´(ê°„ì´) ë¯¸ì¶©ì¡±"}</span>
        </div>`);
        parts.push(`<ul class="list">`);
        r.reportChecks.forEach(c=>{
          if(c.ok){
            parts.push(`<li>âœ… <b>${c.name}</b> Â· ${TYPE_LABEL[c.type]} Â· ${c.amt}${c.unit} <span class="muted">(ì‹ ê³  í›„ë³´)</span></li>`);
          } else {
            parts.push(`<li>âŒ <b>${c.name}</b> Â· ${TYPE_LABEL[c.type]} Â· ${c.amt}${c.unit}
              <div class="muted" style="margin-top:4px; font-size:12px">ì´ìœ : ${c.why.join(", ")}</div>
            </li>`);
          }
        });
        parts.push(`</ul>`);
      }

      if(!r.reportOk){
        const ul2 = document.createElement("ul");
        ul2.className = "list";
        r.reportReasons.forEach(x=>{
          const li = document.createElement("li");
          li.textContent = x;
          ul2.appendChild(li);
        });
        const wrap = document.createElement("div");
        wrap.innerHTML = `<div class="miniTitle" style="margin-bottom:6px">ì‹ ê³  ë¶ˆê°€(ë˜ëŠ” ë¶ˆë¦¬) ì‚¬ìœ </div>`;
        wrap.appendChild(ul2);
        els.reportCheck.innerHTML = parts.join("");
        els.reportCheck.appendChild(wrap);
      } else {
        els.reportCheck.innerHTML = parts.join("") + `<div class="muted" style="margin-top:8px">â€» ê´€í• ì²­ í•´ì„/ì„œë¥˜ìš”ê±´ì€ ë³„ë„ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</div>`;
      }
    }

    // right summary
    els.sumUse.textContent = r.useLabel;
    els.sumDemo.textContent = (r.demo === "no") ? "í•´ì²´ ì—†ìŒ" : (r.demo === "yes") ? "í•´ì²´ ìˆìŒ" : "ëª¨ë¥´ê² ìŒ";
    els.sumTrig.textContent = String(r.triggers.length);

    if(r.selectedItems.length === 0){
      els.sumItems.textContent = "ì•„ì§ ì…ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.";
    } else {
      const ul = document.createElement("ul");
      ul.className = "list";
      r.selectedItems.forEach(s=>{
        const amtText = (s.amt > 0) ? ` Â· ${s.amt}${s.unit}` : "";
        const li = document.createElement("li");
        li.innerHTML = `<b>${s.name}</b> Â· ${TYPE_LABEL[s.type]}${amtText}`;
        ul.appendChild(li);
      });
      els.sumItems.innerHTML = "";
      els.sumItems.appendChild(ul);
    }

    // âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸ ë Œë”(ìš©ë„ ì„ íƒ/ì „ì²´ ë³´ê¸°)
    renderChecklists();

    // copy summary
    const lines = [];
    lines.push("[ëŒ€ìˆ˜ì„  í—ˆê°€/ì‹ ê³  íŒì • ìš”ì•½]");
    lines.push(`- ìš©ë„: ${r.useLabel}`);
    lines.push(`- ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´: ${els.sumDemo.textContent}`);
    lines.push(`- ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±° ê°œìˆ˜: ${r.triggers.length}`);
    lines.push(`- ê²°ê³¼: ${els.statusPill.textContent} / ${r.title}`);
    lines.push("");
    if(r.triggers.length){
      lines.push("[ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°(ë°œìƒ)]");
      r.triggers.forEach(t=>{
        lines.push(`- ${t.name}: ${TYPE_LABEL[t.type]} / ${t.amt}${t.unit} (ê¸°ì¤€ ${t.threshold}${t.unit})`);
      });
      lines.push("");
    }
    if(r.isMajor){
      lines.push("[ì‹ ê³  ê°€ëŠ¥ ë²”ìœ„ ì²´í¬(ê°„ì´)]");
      if(r.reportOk){
        lines.push("- ì‹ ê³  ìš”ê±´(ê°„ì´) ì¶©ì¡±: í•´ì²´ ì—†ìŒ + ìˆ˜ì„  ì¤‘ì‹¬ + ì‹ ê³  í—ˆìš© í•­ëª©");
      } else {
        r.reportReasons.forEach(x=> lines.push(`- ${x}`));
      }
      lines.push("");
    }

    // âœ… ì„ íƒ ìš©ë„ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìš”ì•½(ì§§ê²Œ)
    const selectedKey = els.useType.value;
    const selectedChecklist = checklistDataFor(selectedKey);
    lines.push("[ìš©ë„ë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸(ì„ íƒ ìš©ë„)]");
    STAGES.forEach(s=>{
      const count = (selectedChecklist[s.id] || []).length;
      lines.push(`- ${s.label}: ${count}ê°œ í•­ëª©`);
    });
    lines.push("");

    const memo = (els.memo.value || "").trim();
    if(memo){
      lines.push(`[ë©”ëª¨] ${memo}`);
      lines.push("");
    }
    lines.push("[ì£¼ì˜]");
    lines.push("- ë³¸ ê²°ê³¼ëŠ” ì„¤ëª…ìš© MVP(ê°„ì´ ë¡œì§)ì…ë‹ˆë‹¤. ì§€ìì²´/ì¡°ë¡€/ì‚¬ë¡€/êµ¬ì¡°ê²€í† ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.");

    els.copyBox.value = lines.join("\n");
  }

  // ---------------------------
  // 8) ìŠ¤í… ì´ë™
  // ---------------------------
  function showStep(n){
    step = n;
    els.steps.forEach((s,i)=> s.style.display = (i === (n-1)) ? "block" : "none");
    els.stepPills.forEach(p=>{
      p.classList.toggle("active", Number(p.dataset.step) === n);
    });
    els.btnPrev.disabled = (n === 1);
    els.btnNext.textContent = (n === 3) ? "ì™„ë£Œ" : "ë‹¤ìŒ";
    render();
  }

  els.btnPrev.addEventListener("click", ()=> showStep(Math.max(1, step-1)));
  els.btnNext.addEventListener("click", ()=>{
    if(step < 3) showStep(step+1);
    else showStep(3);
  });

  els.stepPills.forEach(p=>{
    p.addEventListener("click", ()=> showStep(Number(p.dataset.step)));
  });

  // ---------------------------
  // 9) ì´ë²¤íŠ¸ ë°”ì¸ë”©
  // ---------------------------
  const watch = [
    els.useType, els.structDemo, els.memo,
    els.bwType, els.bwAmt,
    els.colType, els.colAmt,
    els.beamType, els.beamAmt,
    els.roofType, els.roofAmt,
    els.extType, els.extAmt
  ];
  watch.forEach(x=> x.addEventListener("input", render));
  watch.forEach(x=> x.addEventListener("change", render));

  els.btnCopy.addEventListener("click", async ()=>{
    try{
      await navigator.clipboard.writeText(els.copyBox.value);
      els.copyMsg.textContent = "ë³µì‚¬ ì™„ë£Œ!";
      setTimeout(()=> els.copyMsg.textContent = "", 1500);
    }catch(e){
      els.copyMsg.textContent = "ë³µì‚¬ ì‹¤íŒ¨(ë¸Œë¼ìš°ì € ê¶Œí•œ í™•ì¸)";
      setTimeout(()=> els.copyMsg.textContent = "", 2000);
    }
  });

  // âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸ íƒ­
  els.tabSelected.addEventListener("click", ()=>{
    checklistMode = "selected";
    els.tabSelected.classList.add("active");
    els.tabAll.classList.remove("active");
    renderChecklists();
  });
  els.tabAll.addEventListener("click", ()=>{
    checklistMode = "all";
    els.tabAll.classList.add("active");
    els.tabSelected.classList.remove("active");
    renderChecklists();
  });

  // init
  buildUseOptions();
  showStep(1);
</script>
</body>
</html>
