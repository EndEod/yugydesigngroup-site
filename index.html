<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ê±´ì¶•í—ˆê°€/ì‹ ê³  ë¹ ë¥¸íŒì • ë„ìš°ë¯¸ (ë² íƒ€)</title>
  <meta name="description" content="ê±´ì¶•í—ˆê°€ vs ê±´ì¶•ì‹ ê³ (í—ˆê°€ ê°ˆìŒ) íŒë‹¨ì„ ìœ„í•œ ì…ë ¥í˜• ì²´í¬ë¦¬ìŠ¤íŠ¸. GitHub Pagesìš© ë‹¨ì¼ index.html"/>
  <style>
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --ink:#111827;
      --muted:#6b7280;
      --line:#e5e7eb;
      --brand:#2563eb;
      --ok:#16a34a;
      --warn:#f59e0b;
      --bad:#dc2626;
      --shadow: 0 10px 28px rgba(0,0,0,.08);
      --radius:16px;
      --radius2:22px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Malgun Gothic", Apple SD Gothic Neo, "Noto Sans KR", sans-serif;
      background: radial-gradient(1200px 600px at 20% -10%, rgba(37,99,235,.10), transparent 55%),
                  radial-gradient(900px 500px at 90% 0%, rgba(22,163,74,.10), transparent 55%),
                  var(--bg);
      color:var(--ink);
    }
    header{
      padding:28px 18px 6px;
      max-width:1200px;
      margin:0 auto;
    }
    .title{
      display:flex;
      gap:12px;
      align-items:center;
      flex-wrap:wrap;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border-radius:999px;
      background:rgba(37,99,235,.10);
      color:#1d4ed8;
      font-weight:700;
      font-size:13px;
    }
    h1{
      margin:0;
      font-size:24px;
      letter-spacing:-.2px;
    }
    .sub{
      margin:10px 0 0;
      color:var(--muted);
      line-height:1.5;
      font-size:14px;
      max-width:980px;
    }
    .wrap{
      max-width:1200px;
      margin:0 auto;
      padding:14px 18px 34px;
      display:grid;
      grid-template-columns: 1.35fr .65fr;
      gap:16px;
    }
    @media (max-width: 980px){
      .wrap{grid-template-columns:1fr}
    }
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius2);
      box-shadow: var(--shadow);
      padding:16px;
    }
    .card h2{
      margin:0 0 10px;
      font-size:16px;
      letter-spacing:-.2px;
    }
    .hint{
      margin:0 0 12px;
      color:var(--muted);
      font-size:13px;
      line-height:1.5;
    }

    .grid2{display:grid; grid-template-columns:1fr 1fr; gap:10px;}
    @media (max-width: 620px){ .grid2{grid-template-columns:1fr} }

    .tiles{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:10px;
    }
    @media (max-width: 980px){ .tiles{grid-template-columns: repeat(2, 1fr);} }
    .tile{
      border:1px solid var(--line);
      border-radius:16px;
      padding:12px 12px 10px;
      cursor:pointer;
      background:#fff;
      transition: transform .06s ease, border-color .06s ease, box-shadow .06s ease;
      user-select:none;
      min-height:74px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
    }
    .tile:hover{ transform: translateY(-1px); box-shadow: 0 10px 18px rgba(0,0,0,.06); }
    .tile .k{font-weight:800; font-size:15px;}
    .tile .d{color:var(--muted); font-size:12px; line-height:1.35}
    input[type="radio"]{display:none}
    input[type="radio"]:checked + .tile{
      border-color: rgba(37,99,235,.65);
      box-shadow: 0 10px 22px rgba(37,99,235,.14);
      background: linear-gradient(180deg, rgba(37,99,235,.08), rgba(37,99,235,.02));
    }

    label.row{
      display:flex; gap:10px; align-items:flex-start;
      padding:10px 12px;
      border:1px solid var(--line);
      border-radius:14px;
      background:#fff;
    }
    .row input[type="checkbox"]{ margin-top:3px; transform: scale(1.15); }
    .row .rt{display:flex; flex-direction:column; gap:4px;}
    .row .rt b{font-size:14px}
    .row .rt span{color:var(--muted); font-size:12.5px; line-height:1.45}

    .field{
      display:flex;
      flex-direction:column;
      gap:6px;
      padding:10px 12px;
      border:1px solid var(--line);
      border-radius:14px;
      background:#fff;
    }
    .field label{font-size:12px; color:var(--muted);}
    .field input, .field select{
      width:100%;
      border:1px solid var(--line);
      border-radius:12px;
      padding:10px 12px;
      font-size:14px;
      outline:none;
      background:#fff;
    }
    .field input:focus, .field select:focus{
      border-color: rgba(37,99,235,.6);
      box-shadow: 0 0 0 4px rgba(37,99,235,.12);
    }

    .actions{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:10px;
    }
    button{
      border:0;
      border-radius:14px;
      padding:12px 14px;
      font-weight:800;
      cursor:pointer;
      background:var(--brand);
      color:#fff;
      box-shadow: 0 10px 18px rgba(37,99,235,.20);
    }
    button.secondary{
      background:#111827;
      box-shadow: 0 10px 18px rgba(17,24,39,.18);
    }
    button.ghost{
      background:#fff;
      color:#111827;
      border:1px solid var(--line);
      box-shadow:none;
    }
    button:active{ transform: translateY(1px); }

    .result{
      border-radius:18px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.9), rgba(255,255,255,.65));
      padding:14px;
    }
    .big{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      margin-bottom:8px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius:999px;
      font-weight:900;
      letter-spacing:-.1px;
      border:1px solid var(--line);
      background:#fff;
      font-size:14px;
    }
    .pill.ok{ color: #065f46; border-color: rgba(22,163,74,.35); background: rgba(22,163,74,.08); }
    .pill.warn{ color: #92400e; border-color: rgba(245,158,11,.40); background: rgba(245,158,11,.10); }
    .pill.bad{ color: #7f1d1d; border-color: rgba(220,38,38,.35); background: rgba(220,38,38,.10); }

    .why{
      margin:0;
      color:var(--muted);
      font-size:13px;
      line-height:1.55;
    }
    .list{
      margin:10px 0 0;
      padding-left:18px;
      color:#111827;
      font-size:13px;
      line-height:1.6;
    }
    .list li{ margin:4px 0; }
    .muted{color:var(--muted)}
    .tiny{font-size:12px; color:var(--muted); line-height:1.5}

    .progress{
      display:flex; flex-direction:column; gap:10px;
    }
    .step{
      border:1px solid var(--line);
      border-radius:16px;
      padding:12px;
      background:#fff;
    }
    .step .top{
      display:flex; justify-content:space-between; align-items:center; gap:10px;
    }
    .step b{font-size:14px}
    .chip{
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      color:var(--muted);
      white-space:nowrap;
    }
    .chip.done{ color:#065f46; border-color: rgba(22,163,74,.35); background: rgba(22,163,74,.08); }
    .chip.todo{ color:#92400e; border-color: rgba(245,158,11,.40); background: rgba(245,158,11,.10); }
    .chip.block{ color:#7f1d1d; border-color: rgba(220,38,38,.35); background: rgba(220,38,38,.10); }
    .step p{margin:8px 0 0; color:var(--muted); font-size:12.5px; line-height:1.55}

    .foot{
      margin-top:10px;
      padding-top:10px;
      border-top:1px dashed var(--line);
      color:var(--muted);
      font-size:12px;
      line-height:1.6;
    }

    .hide{display:none !important;}
    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform:translateX(-50%);
      background:#111827;
      color:#fff;
      padding:10px 12px;
      border-radius:14px;
      font-size:13px;
      box-shadow: 0 10px 22px rgba(0,0,0,.22);
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
    }
    .toast.show{
      opacity:1;
      transform:translateX(-50%) translateY(-2px);
    }
    .split{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
    }
  </style>
</head>

<body>
  <header>
    <div class="title">
      <span class="badge">ğŸ§­ ì˜ì‚¬ê²°ì • ì§„í–‰ìƒí™©ì´ ë³´ì´ëŠ” ë²„ì „</span>
      <h1>ê±´ì¶•í—ˆê°€ vs ê±´ì¶•ì‹ ê³ (í—ˆê°€ ê°ˆìŒ) ë¹ ë¥¸íŒì • ë„ìš°ë¯¸</h1>
    </div>
    <p class="sub">
      ì´ í˜ì´ì§€ëŠ” â€œí—ˆê°€ì¸ì§€, ì‹ ê³ (í—ˆê°€ ê°ˆìŒ)ì¸ì§€, ì¶”ê°€ê²€í† ì¸ì§€â€ë¥¼ <b>ì…ë ¥ë§Œìœ¼ë¡œ</b> ë¹ ë¥´ê²Œ ì •ë¦¬í•´ì£¼ëŠ” ì²´í¬ë¦¬ìŠ¤íŠ¸í˜• ë„êµ¬ì…ë‹ˆë‹¤.<br/>
      âš ï¸ ìµœì¢… íŒë‹¨ì€ ê´€í•  í—ˆê°€ê¶Œì(êµ¬ì²­ ë“±)ì™€ ë²•ë ¹/ì¡°ë¡€/ëŒ€í†µë ¹ë ¹ ì„¸ë¶€ê¸°ì¤€ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆì–´ìš”.
    </p>
  </header>

  <main class="wrap">
    <!-- LEFT: Inputs + Result -->
    <section class="split">
      <div class="card">
        <h2>1) ë¬´ì—‡ì„ í•˜ì‹œë‚˜ìš”? (í–‰ìœ„ ì„ íƒ)</h2>
        <p class="hint">ê°€ì¥ ë¨¼ì € â€œí–‰ìœ„â€ë¥¼ ê³ ë¥´ë©´, ì•„ë˜ ì…ë ¥ì¹¸ì´ ìë™ìœ¼ë¡œ í•„ìš”í•œ ê²ƒë§Œ ë³´ì—¬ìš”.</p>

        <div class="tiles" id="actionTiles">
          <label>
            <input type="radio" name="action" value="ì‹ ì¶•">
            <div class="tile">
              <div class="k">ì‹ ì¶•</div>
              <div class="d">ìƒˆë¡œ ì§“ê¸°</div>
            </div>
          </label>
          <label>
            <input type="radio" name="action" value="ì¦ì¶•">
            <div class="tile">
              <div class="k">ì¦ì¶•</div>
              <div class="d">ë©´ì  ì¦ê°€</div>
            </div>
          </label>
          <label>
            <input type="radio" name="action" value="ê°œì¶•">
            <div class="tile">
              <div class="k">ê°œì¶•</div>
              <div class="d">ì „ë¶€/ì¼ë¶€ë¥¼ ì² ê±° í›„ ìƒˆë¡œ</div>
            </div>
          </label>
          <label>
            <input type="radio" name="action" value="ì¬ì¶•">
            <div class="tile">
              <div class="k">ì¬ì¶•</div>
              <div class="d">ë©¸ì‹¤ í›„ ë‹¤ì‹œ</div>
            </div>
          </label>
          <label>
            <input type="radio" name="action" value="ì´ì „">
            <div class="tile">
              <div class="k">ì´ì „</div>
              <div class="d">ì˜®ê²¨ ì§“ê¸°</div>
            </div>
          </label>
          <label>
            <input type="radio" name="action" value="ëŒ€ìˆ˜ì„ ">
            <div class="tile">
              <div class="k">ëŒ€ìˆ˜ì„ </div>
              <div class="d">ì£¼ìš”êµ¬ì¡°ë¶€ ê´€ë ¨ ìˆ˜ì„  ë“±</div>
            </div>
          </label>
          <label>
            <input type="radio" name="action" value="ìš©ë„ë³€ê²½">
            <div class="tile">
              <div class="k">ìš©ë„ë³€ê²½</div>
              <div class="d">ë³„í‘œ1 ìš©ë„ ë³€ê²½</div>
            </div>
          </label>
          <label>
            <input type="radio" name="action" value="ê¸°íƒ€">
            <div class="tile">
              <div class="k">ê¸°íƒ€</div>
              <div class="d">ì•„ì§ ëª¨ë¥´ê² ìŒ</div>
            </div>
          </label>
        </div>

        <div style="height:10px"></div>

        <h2>2) ì–´ë””ì¸ê°€ìš”? (ì…ì§€)</h2>
        <p class="hint">ë„ì‹œì§€ì—­ ì—¬ë¶€ì™€ â€œë„ì‹œì§€ì—­ì´ ì•„ë‹Œ ê²½ìš°â€ì˜ ì„¸ë¶€ ì§€ì—­(ê´€ë¦¬/ë†ë¦¼/ìì—°í™˜ê²½ë³´ì „)ì´ ì¤‘ìš”í•´ìš”.</p>

        <div class="grid2">
          <div class="field">
            <label for="isUrban">ë„ì‹œì§€ì—­ì¸ê°€ìš”?</label>
            <select id="isUrban">
              <option value="">ì„ íƒ</option>
              <option value="yes">ì˜ˆ, ë„ì‹œì§€ì—­</option>
              <option value="no">ì•„ë‹ˆì˜¤, ë„ì‹œì§€ì—­ ì•„ë‹˜</option>
            </select>
          </div>

          <div class="field" id="zoneWrap">
            <label for="zone">ë„ì‹œì§€ì—­ì´ ì•„ë‹ˆë¼ë©´, ì–´ë””ì¸ê°€ìš”?</label>
            <select id="zone">
              <option value="">ì„ íƒ</option>
              <option value="ê´€ë¦¬ì§€ì—­">ê´€ë¦¬ì§€ì—­</option>
              <option value="ë†ë¦¼ì§€ì—­">ë†ë¦¼ì§€ì—­</option>
              <option value="ìì—°í™˜ê²½ë³´ì „ì§€ì—­">ìì—°í™˜ê²½ë³´ì „ì§€ì—­</option>
              <option value="ê¸°íƒ€">ê·¸ ì™¸(ë„ì‹œì§€ì—­ ì•„ë‹˜)</option>
            </select>
          </div>
        </div>

        <div style="height:10px"></div>

        <h2>3) ê·œëª¨ ì…ë ¥ (ë©´ì /ì¸µìˆ˜)</h2>
        <p class="hint">í•„ìš”í•œ ì¹¸ë§Œ ì±„ìš°ë©´ ë¼ìš”. ëª¨ë¥´ë©´ ë¹ˆì¹¸ìœ¼ë¡œ ë‘ê³  â€œì¶”ê°€ê²€í† â€ë¡œ ëŒë ¤ë„ ë©ë‹ˆë‹¤.</p>

        <div class="grid2">
          <div class="field" id="gfaWrap">
            <label for="gfa">ì—°ë©´ì (mÂ²)</label>
            <input id="gfa" type="number" inputmode="decimal" min="0" step="0.01" placeholder="ì˜ˆ: 180">
          </div>
          <div class="field" id="floorsWrap">
            <label for="floors">ì£¼íƒìœ¼ë¡œ ì“°ëŠ” ì¸µìˆ˜(ì§€í•˜ ì œì™¸ ê¸°ì¤€ìœ¼ë¡œ ì…ë ¥)</label>
            <input id="floors" type="number" inputmode="numeric" min="0" step="1" placeholder="ì˜ˆ: 2">
          </div>
          <div class="field hide" id="deltaWrap">
            <label for="delta">ì¦ê°€ ì—°ë©´ì  í•©ê³„(mÂ²) (ì¦ì¶•/ê°œì¶•/ì¬ì¶• íŒë‹¨ìš©)</label>
            <input id="delta" type="number" inputmode="decimal" min="0" step="0.01" placeholder="ì˜ˆ: 60">
          </div>
          <div class="field">
            <label for="note">ë©”ëª¨(ì„ íƒ)</label>
            <input id="note" type="text" placeholder="ì˜ˆ: 1ì¸µ ì¼ë¶€ í•„ë¡œí‹° ì£¼ì°¨ì¥">
          </div>
        </div>

        <div style="height:10px"></div>

        <div id="majorRepairCard" class="hide">
          <h2>4) ëŒ€ìˆ˜ì„  ì¶”ê°€ ì§ˆë¬¸</h2>
          <p class="hint">ëŒ€ìˆ˜ì„ ì€ ëŒ€í†µë ¹ë ¹ ìš”ê±´ ë“± â€œì²´í¬ë°•ìŠ¤â€ë¡œ ê°ˆë¼ì§€ëŠ” êµ¬ê°„ì´ ìˆì–´ìš”. ëª°ë¼ë„ ê´œì°®ì•„ìš”.</p>

          <div class="grid2">
            <label class="row">
              <input type="checkbox" id="mrDecree">
              <div class="rt">
                <b>ëŒ€í†µë ¹ë ¹ìœ¼ë¡œ ì •í•˜ëŠ” ëŒ€ìˆ˜ì„ ì— í•´ë‹¹</b>
                <span>ì˜ˆ: ë²•ë ¹ì—ì„œ ì§€ì •í•œ ìœ í˜•ì˜ ëŒ€ìˆ˜ì„ (ì„¸ë¶€ê¸°ì¤€ì€ ë³„ë„ í™•ì¸)</span>
              </div>
            </label>
            <label class="row">
              <input type="checkbox" id="mrNoStructure">
              <div class="rt">
                <b>ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ ì—†ìŒ ë“± ìš”ê±´ ì¶©ì¡±</b>
                <span>â€œë„ì‹œì§€ì—­ì´ ì•„ë‹Œ ê´€ë¦¬/ë†ë¦¼/ìì—°í™˜ê²½ë³´ì „ + ì—°ë©´ì  200 ë¯¸ë§Œ + 3ì¸µ ë¯¸ë§Œâ€ì¼ ë•Œ ì¤‘ìš”</span>
              </div>
            </label>
          </div>

          <div class="tiny" style="margin-top:8px">
            â€» ì—¬ê¸° ì²´í¬ëŠ” â€œíŒì • ë¡œì§â€ì— ë°˜ì˜ë˜ì§€ë§Œ, ì‹¤ì œ ì ìš©ì€ í˜„ì¥ ì¡°ê±´ê³¼ ë²•ë ¹ í•´ì„ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          </div>
        </div>

        <div id="useChangeCard" class="hide" style="margin-top:10px">
          <h2>5) ìš©ë„ë³€ê²½ ì…ë ¥ (ë³„í‘œ1 ëŒ€ë¶„ë¥˜ ê¸°ì¤€)</h2>
          <p class="hint">ì§€ê¸ˆì€ â€œëŒ€ë¶„ë¥˜ê°€ ë‹¬ë¼ì§€ë©´ í—ˆê°€ ê°€ëŠ¥ì„± ë†’ìŒâ€ ìˆ˜ì¤€ì˜ 1ì°¨ ìŠ¤í¬ë¦¬ë‹ì…ë‹ˆë‹¤. (ì‹œì„¤êµ° í…Œì´ë¸”ì€ ì¶”í›„ ì—…ë°ì´íŠ¸)</p>

          <div class="grid2">
            <div class="field">
              <label for="useFrom">ë³€ê²½ ì „ ìš©ë„(ëŒ€ë¶„ë¥˜)</label>
              <select id="useFrom"></select>
            </div>
            <div class="field">
              <label for="useTo">ë³€ê²½ í›„ ìš©ë„(ëŒ€ë¶„ë¥˜)</label>
              <select id="useTo"></select>
            </div>
          </div>

          <div class="tiny" style="margin-top:8px">
            íŒ: ì£¼íƒ(ë‹¨ë…/ê³µë™)ì€ ëŒ€ë¶„ë¥˜ê°€ ê°™ì•„ë„ ì„¸ë¶€(ë‹¤ì¤‘/ë‹¤ê°€êµ¬/ë‹¤ì„¸ëŒ€/ì—°ë¦½/ì•„íŒŒíŠ¸)ì—ì„œ ê·œì •ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆì–´ìš”.
          </div>
        </div>

        <div class="actions">
          <button id="btnJudge" type="button">íŒì •í•˜ê¸°</button>
          <button id="btnCopy" type="button" class="ghost">ê²°ê³¼ ìš”ì•½ ë³µì‚¬</button>
          <button id="btnReset" type="button" class="secondary">ì´ˆê¸°í™”</button>
        </div>

        <div style="height:12px"></div>

        <div class="result" id="resultBox">
          <div class="big">
            <div class="pill warn" id="resultPill">ğŸŸ¡ ì…ë ¥ ëŒ€ê¸°</div>
            <div class="tiny muted" id="resultShort">í–‰ìœ„ë¥¼ ì„ íƒí•˜ê³  í•„ìš”í•œ ì…ë ¥ì„ ì±„ì›Œì£¼ì„¸ìš”.</div>
          </div>

          <p class="why" id="resultWhy">
            ì´ ë„êµ¬ëŠ” â€œì›ì¹™(í—ˆê°€)â€ì—ì„œ ì‹œì‘í•´ì„œ â€œì˜ˆì™¸(ì‹ ê³ ë¡œ í—ˆê°€ ê°ˆìŒ)â€ ì¡°ê±´ì„ ìˆœì„œëŒ€ë¡œ ì²´í¬í•©ë‹ˆë‹¤.
          </p>

          <ul class="list" id="resultBullets">
            <li class="muted">ì•„ì§ íŒì • ì „ì…ë‹ˆë‹¤.</li>
          </ul>

          <div class="foot">
            <b>ì£¼ì˜</b>: ì´ í˜ì´ì§€ëŠ” ìƒë‹´ìš© â€œë¹ ë¥¸ ì •ë¦¬â€ ë„êµ¬ì…ë‹ˆë‹¤. ê±´ì¶•ë²• ì™¸ì—ë„ ì¡°ë¡€, ì§€êµ¬ë‹¨ìœ„ê³„íš, ê°ì¢… ê°œë³„ë²•(ì†Œë°©ë²• ë“±) ì˜í–¥ì´ ìˆì„ ìˆ˜ ìˆì–´ìš”.
          </div>
        </div>
      </div>
    </section>

    <!-- RIGHT: Progress -->
    <aside class="card">
      <h2>ğŸ§­ ì˜ì‚¬ê²°ì • ì§„í–‰ìƒí™©</h2>
      <p class="hint">ì—¬ê¸°ë§Œ ë³´ë©´ â€œì§€ê¸ˆ ì–´ë””ê¹Œì§€ ì…ë ¥í–ˆëŠ”ì§€â€ì™€ â€œì–´ë–¤ ê·œì¹™ì— ê±¸ë ¸ëŠ”ì§€â€ê°€ ë³´ì—¬ìš”.</p>

      <div class="progress">
        <div class="step" id="p1">
          <div class="top">
            <b>Step 1. í–‰ìœ„ ì„ íƒ</b>
            <span class="chip todo" id="p1c">ì…ë ¥ í•„ìš”</span>
          </div>
          <p id="p1t">ì‹ ì¶•/ì¦ì¶•/ê°œì¶•/ì¬ì¶•/ì´ì „/ëŒ€ìˆ˜ì„ /ìš©ë„ë³€ê²½ ì¤‘ í•˜ë‚˜ë¥¼ ê³ ë¥´ì„¸ìš”.</p>
        </div>

        <div class="step" id="p2">
          <div class="top">
            <b>Step 2. ì…ì§€ ì…ë ¥</b>
            <span class="chip todo" id="p2c">ì…ë ¥ í•„ìš”</span>
          </div>
          <p id="p2t">ë„ì‹œì§€ì—­ ì—¬ë¶€ë¥¼ ì„ íƒí•˜ê³ , ë„ì‹œì§€ì—­ì´ ì•„ë‹ˆë¼ë©´ ì„¸ë¶€ ì§€ì—­ì„ ê³ ë¥´ì„¸ìš”.</p>
        </div>

        <div class="step" id="p3">
          <div class="top">
            <b>Step 3. ê·œëª¨ ì…ë ¥</b>
            <span class="chip todo" id="p3c">ì…ë ¥ í•„ìš”</span>
          </div>
          <p id="p3t">ì—°ë©´ì , ì¸µìˆ˜, (ì¦ì¶•/ê°œì¶•/ì¬ì¶•ì´ë©´) ì¦ê°€ ì—°ë©´ì ì„ ì…ë ¥í•˜ì„¸ìš”.</p>
        </div>

        <div class="step" id="p4">
          <div class="top">
            <b>Step 4. ì˜ˆì™¸ì¡°ê±´ ì²´í¬</b>
            <span class="chip todo" id="p4c">ì§„í–‰ ì¤‘</span>
          </div>
          <p id="p4t">ì›ì¹™ì€ í—ˆê°€ì…ë‹ˆë‹¤. ì˜ˆì™¸(ì‹ ê³ ë¡œ í—ˆê°€ ê°ˆìŒ)ì— í•´ë‹¹í•˜ë©´ ê²°ê³¼ê°€ ë°”ë€ë‹ˆë‹¤.</p>
        </div>

        <div class="step" id="p5">
          <div class="top">
            <b>Step 5. ê²°ê³¼</b>
            <span class="chip todo" id="p5c">ëŒ€ê¸°</span>
          </div>
          <p id="p5t">â€œí—ˆê°€ / ì‹ ê³ (í—ˆê°€ ê°ˆìŒ) / ì¶”ê°€ê²€í† â€ ì¤‘ í•˜ë‚˜ë¡œ ì•ˆë‚´ë©ë‹ˆë‹¤.</p>
        </div>
      </div>

      <div class="foot">
        <b>ì‚¬ìš© íŒ</b><br/>
        1) ëª¨ë¥´ë©´ ë¹ˆì¹¸ìœ¼ë¡œ ë‘ê³  â€œíŒì •í•˜ê¸°â€ ëˆ„ë¥´ì„¸ìš”. ê·¸ëŸ¼ â€œì¶”ê°€ê²€í† â€ë¡œ ì•ˆì „í•˜ê²Œ ë¹ ì§‘ë‹ˆë‹¤.<br/>
        2) â€œê²°ê³¼ ìš”ì•½ ë³µì‚¬â€ ëˆ„ë¥´ë©´ ì¹´í†¡/ë©”ëª¨ì¥ìœ¼ë¡œ ë°”ë¡œ ë¶™ì—¬ë„£ê¸° ë©ë‹ˆë‹¤.
      </div>
    </aside>
  </main>

  <div class="toast" id="toast">ë³µì‚¬ ì™„ë£Œ!</div>

  <script>
    // ====== Data: ë³„í‘œ1 ëŒ€ë¶„ë¥˜(ìš”ì•½) ======
    const USE_CATEGORIES = [
      ["", "ì„ íƒ"],
      ["1", "1. ë‹¨ë…ì£¼íƒ"],
      ["2", "2. ê³µë™ì£¼íƒ"],
      ["3", "3. ì œ1ì¢… ê·¼ë¦°ìƒí™œì‹œì„¤"],
      ["4", "4. ì œ2ì¢… ê·¼ë¦°ìƒí™œì‹œì„¤"],
      ["5", "5. ë¬¸í™” ë° ì§‘íšŒì‹œì„¤"],
      ["6", "6. ì¢…êµì‹œì„¤"],
      ["7", "7. íŒë§¤ì‹œì„¤"],
      ["8", "8. ìš´ìˆ˜ì‹œì„¤"],
      ["9", "9. ì˜ë£Œì‹œì„¤"],
      ["10", "10. êµìœ¡ì—°êµ¬ì‹œì„¤"],
      ["11", "11. ë…¸ìœ ìì‹œì„¤"],
      ["12", "12. ìˆ˜ë ¨ì‹œì„¤"],
      ["13", "13. ìš´ë™ì‹œì„¤"],
      ["14", "14. ì—…ë¬´ì‹œì„¤"],
      ["15", "15. ìˆ™ë°•ì‹œì„¤"],
      ["16", "16. ìœ„ë½ì‹œì„¤"],
      ["17", "17. ê³µì¥"],
      ["18", "18. ì°½ê³ ì‹œì„¤"],
      ["19", "19. ìœ„í—˜ë¬¼ ì €ì¥ ë° ì²˜ë¦¬ì‹œì„¤"],
      ["20", "20. ìë™ì°¨ ê´€ë ¨ ì‹œì„¤"],
      ["21", "21. ë™ë¬¼ ë° ì‹ë¬¼ ê´€ë ¨ ì‹œì„¤"],
      ["22", "22. ìì›ìˆœí™˜ ê´€ë ¨ ì‹œì„¤"],
      ["23", "23. êµì •ì‹œì„¤"],
      ["23-2", "23ì˜2. êµ­ë°©Â·êµ°ì‚¬ì‹œì„¤"],
      ["24", "24. ë°©ì†¡í†µì‹ ì‹œì„¤"],
      ["25", "25. ë°œì „ì‹œì„¤"],
      ["26", "26. ë¬˜ì§€ ê´€ë ¨ ì‹œì„¤"],
      ["27", "27. ê´€ê´‘ íœ´ê²Œì‹œì„¤"],
      ["28", "28. ì¥ë¡€ì‹œì„¤"],
      ["29", "29. ì•¼ì˜ì¥ ì‹œì„¤"]
    ];

    // ====== Helpers ======
    const $ = (id)=>document.getElementById(id);
    const toast = (msg)=>{
      const t = $("toast");
      t.textContent = msg || "ì™„ë£Œ!";
      t.classList.add("show");
      setTimeout(()=>t.classList.remove("show"), 1200);
    };
    const num = (v)=>{
      const x = parseFloat(v);
      return Number.isFinite(x) ? x : null;
    };

    // ====== Populate selects ======
    function populateUseSelect(sel){
      sel.innerHTML = "";
      USE_CATEGORIES.forEach(([v, label])=>{
        const opt = document.createElement("option");
        opt.value = v;
        opt.textContent = label;
        sel.appendChild(opt);
      });
    }
    populateUseSelect($("useFrom"));
    populateUseSelect($("useTo"));

    // ====== UI State ======
    function getAction(){
      const r = document.querySelector('input[name="action"]:checked');
      return r ? r.value : "";
    }
    function requiredFieldsForAction(action){
      // returns list of required keys
      if (!action || action==="ê¸°íƒ€") return [];
      if (action==="ìš©ë„ë³€ê²½") return ["isUrban", "useFrom", "useTo"];
      // ê±´ì¶•/ëŒ€ìˆ˜ì„  ê³„ì—´
      const keys = ["isUrban", "gfa", "floors"];
      if (["ì¦ì¶•","ê°œì¶•","ì¬ì¶•"].includes(action)) keys.push("delta");
      if (action==="ëŒ€ìˆ˜ì„ ") keys.push("mrBox"); // special group
      return keys;
    }

    function refreshVisibility(){
      const action = getAction();

      // delta field visibility
      const needDelta = ["ì¦ì¶•","ê°œì¶•","ì¬ì¶•"].includes(action);
      $("deltaWrap").classList.toggle("hide", !needDelta);

      // major repair visibility
      $("majorRepairCard").classList.toggle("hide", action!=="ëŒ€ìˆ˜ì„ ");

      // use change visibility
      $("useChangeCard").classList.toggle("hide", action!=="ìš©ë„ë³€ê²½");

      // zone visibility: only relevant when isUrban is 'no'
      const isUrban = $("isUrban").value;
      $("zoneWrap").classList.toggle("hide", isUrban!=="no");

      // progress text
      $("p1t").textContent = action ? `ì„ íƒë¨: ${action}` : "ì‹ ì¶•/ì¦ì¶•/ê°œì¶•/ì¬ì¶•/ì´ì „/ëŒ€ìˆ˜ì„ /ìš©ë„ë³€ê²½ ì¤‘ í•˜ë‚˜ë¥¼ ê³ ë¥´ì„¸ìš”.";
    }

    function progressSet(idChip, status, text){
      const chip = $(idChip);
      chip.classList.remove("done","todo","block");
      chip.classList.add(status);
      if (text) chip.textContent = text;
      else chip.textContent = status==="done" ? "ì™„ë£Œ" : (status==="block" ? "ì…ë ¥ ë¶€ì¡±" : "ì…ë ¥ í•„ìš”");
    }

    function updateProgress(missing){
      const action = getAction();
      // Step1
      if (action && action!=="ê¸°íƒ€") progressSet("p1c","done","ì™„ë£Œ");
      else progressSet("p1c","todo","ì…ë ¥ í•„ìš”");

      // Step2: isUrban required always once action is meaningful
      const isUrban = $("isUrban").value;
      if (!action || action==="ê¸°íƒ€") progressSet("p2c","todo","ì…ë ¥ í•„ìš”");
      else{
        if (!isUrban) progressSet("p2c","todo","ì…ë ¥ í•„ìš”");
        else if (isUrban==="no" && !$("zone").value) progressSet("p2c","todo","ì¶”ê°€ì…ë ¥");
        else progressSet("p2c","done","ì™„ë£Œ");
      }

      // Step3: size fields for most actions
      if (!action || action==="ê¸°íƒ€" || action==="ìš©ë„ë³€ê²½"){
        progressSet("p3c","todo","ëŒ€ìƒ ì•„ë‹˜");
      } else{
        const gfaOk = num($("gfa").value)!=null;
        const floorsOk = num($("floors").value)!=null;
        const needDelta = ["ì¦ì¶•","ê°œì¶•","ì¬ì¶•"].includes(action);
        const deltaOk = !needDelta || (num($("delta").value)!=null);
        if (gfaOk && floorsOk && deltaOk) progressSet("p3c","done","ì™„ë£Œ");
        else progressSet("p3c","todo","ì…ë ¥ í•„ìš”");
      }

      // Step4: exception check step
      if (!action || action==="ê¸°íƒ€") progressSet("p4c","todo","ëŒ€ê¸°");
      else progressSet("p4c", missing.length ? "block" : "done", missing.length ? "ì…ë ¥ ë¶€ì¡±" : "ì²´í¬ ì™„ë£Œ");

      // Step5 result
      progressSet("p5c", missing.length ? "todo" : "done", missing.length ? "ëŒ€ê¸°" : "í‘œì‹œë¨");
    }

    // ====== Core Logic ======
    function judge(){
      const action = getAction();
      const isUrban = $("isUrban").value;          // yes/no
      const zone = $("zone").value;                // ê´€ë¦¬/ë†ë¦¼/ìì—°/ê¸°íƒ€
      const gfa = num($("gfa").value);             // m2
      const floors = num($("floors").value);       // count
      const delta = num($("delta").value);         // m2
      const note = ($("note").value || "").trim();

      const mrDecree = $("mrDecree").checked;
      const mrNoStructure = $("mrNoStructure").checked;

      const useFrom = $("useFrom").value;
      const useTo = $("useTo").value;

      // Validate required fields
      const req = requiredFieldsForAction(action);
      const missing = [];

      if (req.includes("isUrban") && !isUrban) missing.push("ë„ì‹œì§€ì—­ ì—¬ë¶€");
      if (isUrban==="no" && !zone && (action && action!=="ê¸°íƒ€")) missing.push("ë„ì‹œì§€ì—­ì´ ì•„ë‹Œ ê²½ìš° ì§€ì—­(ê´€ë¦¬/ë†ë¦¼/ìì—°/ê¸°íƒ€)");

      if (req.includes("gfa") && gfa==null) missing.push("ì—°ë©´ì (mÂ²)");
      if (req.includes("floors") && floors==null) missing.push("ì¸µìˆ˜(ì§€í•˜ ì œì™¸)");
      if (req.includes("delta") && delta==null) missing.push("ì¦ê°€ ì—°ë©´ì  í•©ê³„(mÂ²)");

      if (action==="ìš©ë„ë³€ê²½"){
        if (!useFrom) missing.push("ë³€ê²½ ì „ ìš©ë„(ëŒ€ë¶„ë¥˜)");
        if (!useTo) missing.push("ë³€ê²½ í›„ ìš©ë„(ëŒ€ë¶„ë¥˜)");
      }

      refreshVisibility();
      updateProgress(missing);

      // If action not chosen or ê¸°íƒ€
      if (!action || action==="ê¸°íƒ€"){
        renderResult({
          status: "warn",
          title: "ğŸŸ¡ ì…ë ¥ ëŒ€ê¸°",
          short: "ë¨¼ì € í–‰ìœ„ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.",
          why: "í–‰ìœ„ë¥¼ ì„ íƒí•˜ë©´ í•„ìš”í•œ ì§ˆë¬¸ì´ ìë™ìœ¼ë¡œ ì—´ë¦½ë‹ˆë‹¤.",
          bullets: [
            "ì˜ˆ: ì¦ì¶•ì´ë©´ â€˜ì¦ê°€ ì—°ë©´ì  í•©ê³„â€™ë¥¼ ì…ë ¥í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.",
            "ëª¨ë¥´ë©´ â€˜ê¸°íƒ€â€™ë¥¼ ì„ íƒí•˜ì§€ ë§ê³ , ê°€ì¥ ê°€ê¹Œìš´ í–‰ìœ„ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”."
          ],
          path: []
        });
        return { ok:false, missing, decision:null };
      }

      // If missing required inputs
      if (missing.length){
        renderResult({
          status:"warn",
          title:"ğŸŸ¡ ì¶”ê°€ ì…ë ¥ í•„ìš”",
          short:`ì•„ì§ ${missing.length}ê°œ ì…ë ¥ì´ ë¹„ì—ˆìŠµë‹ˆë‹¤.`,
          why:"ëª¨ë¥´ëŠ” ì¹¸ì€ ë¹ˆì¹¸ìœ¼ë¡œ ë‘˜ ìˆ˜ ìˆì§€ë§Œ, ê·¸ ê²½ìš° ê²°ê³¼ëŠ” â€˜ì¶”ê°€ê²€í† â€™ë¡œ ì•ˆë‚´ë©ë‹ˆë‹¤.",
          bullets: [
            "ë¹„ì–´ìˆëŠ” í•­ëª©: " + missing.join(", "),
            "ê·¸ë˜ë„ ì§„í–‰í•˜ë ¤ë©´: ì•„ëŠ” ê°’ë§Œ ë„£ê³  â€˜íŒì •í•˜ê¸°â€™ ë²„íŠ¼ì„ ë‹¤ì‹œ ëˆŒëŸ¬ ì£¼ì„¸ìš”."
          ],
          path: ["ì›ì¹™ì€ í—ˆê°€", "ì˜ˆì™¸ì¡°ê±´ ì²´í¬ ì „ì— ì…ë ¥ì´ ë¶€ì¡±"]
        });
        return { ok:false, missing, decision:null };
      }

      // ===== Decision engine =====
      // Outputs: PERMIT / REPORT_IN_LIEU / REVIEW
      let decision = "PERMIT";
      let reason = [];
      let path = ["ì‹œì‘", "í–‰ìœ„ í™•ì¸"];

      if (action==="ìš©ë„ë³€ê²½"){
        path.push("ìš©ë„ë³€ê²½ ëª¨ë“œ");
        if (useFrom && useTo){
          if (useFrom !== useTo){
            decision = "PERMIT";
            reason.push("ë³„í‘œ1 ëŒ€ë¶„ë¥˜ê°€ ì„œë¡œ ë‹¤ë¦…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ í—ˆê°€ ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§‘ë‹ˆë‹¤(ì¶”ê°€ê²€í†  í¬í•¨).");
            path.push("ëŒ€ë¶„ë¥˜ ìƒì´ -> í—ˆê°€ ê°€ëŠ¥ì„± ë†’ìŒ");
          }else{
            decision = "REVIEW";
            reason.push("ë³„í‘œ1 ëŒ€ë¶„ë¥˜ëŠ” ë™ì¼í•©ë‹ˆë‹¤. ì„¸ë¶€ìš©ë„/ì‹œì„¤êµ°/ë©´ì /êµ¬ì¡°/í”¼ë‚œ ë“± ì¶”ê°€ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤.");
            path.push("ëŒ€ë¶„ë¥˜ ë™ì¼ -> ì¶”ê°€ê²€í† ");
          }
        }else{
          decision = "REVIEW";
          reason.push("ìš©ë„ë³€ê²½ ì „/í›„ ìš©ë„ ì…ë ¥ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.");
          path.push("ì…ë ¥ ë¶€ì¡± -> ì¶”ê°€ê²€í† ");
        }

        renderDecision(decision, {
          action, isUrban, zone, gfa, floors, delta, note,
          useFrom, useTo, mrDecree, mrNoStructure,
          reason, path
        });
        return { ok:true, missing:[], decision };
      }

      // ê±´ì¶•/ëŒ€ìˆ˜ì„  ê³„ì—´
      path.push("ê±´ì¶•/ëŒ€ìˆ˜ì„  ëª¨ë“œ");
      // ì›ì¹™: í—ˆê°€
      decision = "PERMIT";
      reason.push("ì›ì¹™: ê±´ì¶•(ì‹ ì¶•/ì¦ì¶•/ê°œì¶•/ì¬ì¶•/ì´ì „) ë° ëŒ€ìˆ˜ì„ ì€ í—ˆê°€ë¥¼ ê¸°ë³¸ìœ¼ë¡œ ë´…ë‹ˆë‹¤.");

      // ì˜ˆì™¸ 1: ì¦ì¶•/ê°œì¶•/ì¬ì¶• ì¦ê°€ì—°ë©´ì  í•©ê³„ 85ã¡ ì´í•˜
      if (["ì¦ì¶•","ê°œì¶•","ì¬ì¶•"].includes(action)){
        path.push("ì˜ˆì™¸(85ã¡) ì²´í¬");
        if (delta != null && delta <= 85){
          decision = "REPORT_IN_LIEU";
          reason.push(`ì˜ˆì™¸: ${action} ì¦ê°€ ì—°ë©´ì  í•©ê³„ ${delta}ã¡ â‰¤ 85ã¡ ì´ë¯€ë¡œ â€˜ì‹ ê³ ë¡œ í—ˆê°€ë¥¼ ê°ˆìŒâ€™ ê°€ëŠ¥ êµ¬ê°„ì…ë‹ˆë‹¤.`);
          path.push("85ã¡ ì´í•˜ ì¶©ì¡± -> ì‹ ê³ (í—ˆê°€ ê°ˆìŒ)");
        } else {
          path.push("85ã¡ ì˜ˆì™¸ ë¶ˆì¶©ì¡±");
        }
      }

      // ì˜ˆì™¸ 2/3: ë„ì‹œì§€ì—­ì´ ì•„ë‹Œ ê´€ë¦¬/ë†ë¦¼/ìì—°í™˜ê²½ë³´ì „ + ì—°ë©´ì <200 + 3ì¸µ ë¯¸ë§Œ
      const nonUrbanSpecial = (isUrban==="no" && ["ê´€ë¦¬ì§€ì—­","ë†ë¦¼ì§€ì—­","ìì—°í™˜ê²½ë³´ì „ì§€ì—­"].includes(zone));
      if (decision !== "REPORT_IN_LIEU"){ // already decided by stronger simple rule
        path.push("ì˜ˆì™¸(ë¹„ë„ì‹œ + íŠ¹ìˆ˜ì§€ì—­) ì²´í¬");
        if (nonUrbanSpecial){
          const sizeOk = (gfa != null && gfa < 200);
          const floorsOk = (floors != null && floors < 3);

          if (sizeOk && floorsOk){
            if (["ì‹ ì¶•","ì¦ì¶•","ê°œì¶•","ì¬ì¶•"].includes(action)){
              decision = "REPORT_IN_LIEU";
              reason.push("ì˜ˆì™¸: ë„ì‹œì§€ì—­ ì•„ë‹˜ + (ê´€ë¦¬/ë†ë¦¼/ìì—°í™˜ê²½ë³´ì „) + ì—°ë©´ì  200ã¡ ë¯¸ë§Œ + 3ì¸µ ë¯¸ë§Œ ì¡°ê±´ ì¶©ì¡±ìœ¼ë¡œ â€˜ì‹ ê³ ë¡œ í—ˆê°€ ê°ˆìŒâ€™ ê°€ëŠ¥ êµ¬ê°„ì…ë‹ˆë‹¤.");
              path.push("200ã¡/3ì¸µ ë¯¸ë§Œ ì¶©ì¡± -> ì‹ ê³ (í—ˆê°€ ê°ˆìŒ)");
            } else if (action==="ëŒ€ìˆ˜ì„ "){
              // ëŒ€ìˆ˜ì„ ì€ ì¶”ê°€ ìš”ê±´ ì²´í¬
              if (mrNoStructure){
                decision = "REPORT_IN_LIEU";
                reason.push("ì˜ˆì™¸: ë¹„ë„ì‹œ íŠ¹ìˆ˜ì§€ì—­ + ì—°ë©´ì  200ã¡ ë¯¸ë§Œ + 3ì¸µ ë¯¸ë§Œ + (ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ ì—†ìŒ ë“±) ìš”ê±´ ì²´í¬ë¨ -> â€˜ì‹ ê³ ë¡œ í—ˆê°€ ê°ˆìŒâ€™ ê°€ëŠ¥ êµ¬ê°„.");
                path.push("ëŒ€ìˆ˜ì„  ìš”ê±´ ì²´í¬ë¨ -> ì‹ ê³ (í—ˆê°€ ê°ˆìŒ)");
              } else {
                decision = "REVIEW";
                reason.push("ëŒ€ìˆ˜ì„ ì€ â€˜ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ ì—†ìŒ ë“±â€™ ëŒ€í†µë ¹ë ¹ ìš”ê±´ ì—¬ë¶€ì— ë”°ë¼ ê°ˆë¦½ë‹ˆë‹¤. í˜„ì¬ ë¯¸ì²´í¬ ìƒíƒœë¼ ì¶”ê°€ê²€í† ë¡œ ì•ˆë‚´í•©ë‹ˆë‹¤.");
                path.push("ëŒ€ìˆ˜ì„  ìš”ê±´ ë¶ˆëª… -> ì¶”ê°€ê²€í† ");
              }
            } else if (action==="ì´ì „"){
              decision = "PERMIT";
              reason.push("ì´ì „ì€ ì—¬ê¸° ì˜ˆì™¸ ì¡°í•­ì— ë‹¨ìˆœ ë§¤ì¹­ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í—ˆê°€ ìª½ìœ¼ë¡œ ì•ˆë‚´í•©ë‹ˆë‹¤.");
              path.push("ì´ì „ -> í—ˆê°€ ìœ ì§€");
            }
          } else {
            path.push("200ã¡/3ì¸µ ë¯¸ë§Œ ë¶ˆì¶©ì¡±");
          }
        } else {
          path.push("ë¹„ë„ì‹œ íŠ¹ìˆ˜ì§€ì—­ ì•„ë‹˜");
        }
      }

      // ì˜ˆì™¸ 4: ëŒ€í†µë ¹ë ¹ìœ¼ë¡œ ì •í•˜ëŠ” ëŒ€ìˆ˜ì„ 
      if (action==="ëŒ€ìˆ˜ì„ " && decision !== "REPORT_IN_LIEU"){
        path.push("ì˜ˆì™¸(ëŒ€í†µë ¹ë ¹ ëŒ€ìˆ˜ì„ ) ì²´í¬");
        if (mrDecree){
          decision = "REPORT_IN_LIEU";
          reason.push("ì˜ˆì™¸: ëŒ€í†µë ¹ë ¹ìœ¼ë¡œ ì •í•˜ëŠ” ëŒ€ìˆ˜ì„ ì— í•´ë‹¹ ì²´í¬ë¨ -> â€˜ì‹ ê³ ë¡œ í—ˆê°€ë¥¼ ê°ˆìŒâ€™ ê°€ëŠ¥ êµ¬ê°„.");
          path.push("ëŒ€í†µë ¹ë ¹ ëŒ€ìˆ˜ì„  ì²´í¬ë¨ -> ì‹ ê³ (í—ˆê°€ ê°ˆìŒ)");
        } else {
          // keep decision as PERMIT or REVIEW depending earlier
          if (decision === "PERMIT") path.push("ëŒ€í†µë ¹ë ¹ ëŒ€ìˆ˜ì„  ë¯¸ì²´í¬ -> í—ˆê°€ ìœ ì§€");
        }
      }

      // If still REVIEW due to unknowns, keep it
      // else, final
      renderDecision(decision, {
        action, isUrban, zone, gfa, floors, delta, note,
        useFrom, useTo, mrDecree, mrNoStructure,
        reason, path
      });

      return { ok:true, missing:[], decision };
    }

    function renderDecision(decision, ctx){
      const bullets = [];
      const a = ctx.action;
      const isUrbanLabel = ctx.isUrban==="yes" ? "ë„ì‹œì§€ì—­" : "ë„ì‹œì§€ì—­ ì•„ë‹˜";
      const zoneLabel = ctx.isUrban==="no" ? (ctx.zone || "ë¯¸ì…ë ¥") : "-";
      const gfaLabel = (ctx.gfa!=null) ? `${ctx.gfa}ã¡` : "ë¯¸ì…ë ¥";
      const floorsLabel = (ctx.floors!=null) ? `${ctx.floors}ì¸µ` : "ë¯¸ì…ë ¥";

      bullets.push(`í–‰ìœ„: ${a}`);
      bullets.push(`ì…ì§€: ${isUrbanLabel} / (ë„ì‹œì§€ì—­ ì•„ë‹˜ì¸ ê²½ìš°) ${zoneLabel}`);
      if (a !== "ìš©ë„ë³€ê²½"){
        bullets.push(`ê·œëª¨: ì—°ë©´ì  ${gfaLabel}, ì¸µìˆ˜ ${floorsLabel}`);
        if (["ì¦ì¶•","ê°œì¶•","ì¬ì¶•"].includes(a)){
          bullets.push(`ì¦ê°€ ì—°ë©´ì  í•©ê³„: ${ctx.delta!=null ? ctx.delta+"ã¡" : "ë¯¸ì…ë ¥"}`);
        }
        if (a==="ëŒ€ìˆ˜ì„ "){
          bullets.push(`ëŒ€ìˆ˜ì„  ì²´í¬: ëŒ€í†µë ¹ë ¹ ëŒ€ìˆ˜ì„ =${ctx.mrDecree ? "ì˜ˆ" : "ì•„ë‹ˆì˜¤"}, ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ ì—†ìŒ ë“±=${ctx.mrNoStructure ? "ì˜ˆ" : "ì•„ë‹ˆì˜¤"}`);
        }
      } else {
        const fromLabel = USE_CATEGORIES.find(x=>x[0]===ctx.useFrom)?.[1] || "ë¯¸ì…ë ¥";
        const toLabel = USE_CATEGORIES.find(x=>x[0]===ctx.useTo)?.[1] || "ë¯¸ì…ë ¥";
        bullets.push(`ìš©ë„ë³€ê²½: ${fromLabel} â†’ ${toLabel}`);
      }
      if (ctx.note) bullets.push(`ë©”ëª¨: ${ctx.note}`);

      let status="warn", title="ğŸŸ¡ ì¶”ê°€ê²€í† ", short="ì •ë³´ê°€ ë” í•„ìš”í•©ë‹ˆë‹¤.", why=ctx.reason.join(" ");
      if (decision==="PERMIT"){
        status="bad";
        title="ğŸ”´ í—ˆê°€ ìª½ìœ¼ë¡œ ì•ˆë‚´";
        short="ì›ì¹™ ë˜ëŠ” ì˜ˆì™¸ ë¶ˆì¶©ì¡±ìœ¼ë¡œ í—ˆê°€ ë£¨íŠ¸ê°€ ìœ ë ¥í•©ë‹ˆë‹¤.";
      } else if (decision==="REPORT_IN_LIEU"){
        status="ok";
        title="ğŸŸ¢ ì‹ ê³ (í—ˆê°€ ê°ˆìŒ) ìª½ìœ¼ë¡œ ì•ˆë‚´";
        short="ì œ14ì¡° ì˜ˆì™¸ì¡°ê±´ì— ê±¸ë ¤ â€˜ì‹ ê³ ë¡œ í—ˆê°€ë¥¼ ê°ˆìŒâ€™ ê°€ëŠ¥ êµ¬ê°„ì…ë‹ˆë‹¤.";
      } else if (decision==="REVIEW"){
        status="warn";
        title="ğŸŸ¡ ì¶”ê°€ê²€í†  í•„ìš”";
        short="í•µì‹¬ ì…ë ¥ì€ ìˆìœ¼ë‚˜, ëŒ€í†µë ¹ë ¹/ì„¸ë¶€ìš©ë„/ìš”ê±´ì— ë”°ë¼ ê°ˆë¦½ë‹ˆë‹¤.";
      }

      // show path in bullets as last item
      bullets.push("ì˜ì‚¬ê²°ì • ê²½ë¡œ: " + ctx.path.join(" â†’ "));

      renderResult({ status, title, short, why, bullets, path: ctx.path });
    }

    function renderResult({status, title, short, why, bullets}){
      const pill = $("resultPill");
      pill.classList.remove("ok","warn","bad");
      pill.classList.add(status);
      pill.textContent = title;

      $("resultShort").textContent = short || "";
      $("resultWhy").textContent = why || "";

      const ul = $("resultBullets");
      ul.innerHTML = "";
      (bullets || []).forEach(b=>{
        const li = document.createElement("li");
        li.textContent = b;
        ul.appendChild(li);
      });

      // progress Step5 text
      $("p5t").textContent = title + " | " + short;
    }

    function makeSummaryText(){
      const action = getAction();
      const isUrban = $("isUrban").value;
      const zone = $("zone").value;
      const gfa = $("gfa").value;
      const floors = $("floors").value;
      const delta = $("delta").value;
      const mrDecree = $("mrDecree").checked;
      const mrNoStructure = $("mrNoStructure").checked;
      const note = ($("note").value || "").trim();

      const useFrom = $("useFrom").value;
      const useTo = $("useTo").value;
      const fromLabel = USE_CATEGORIES.find(x=>x[0]===useFrom)?.[1] || "";
      const toLabel = USE_CATEGORIES.find(x=>x[0]===useTo)?.[1] || "";

      const pillText = $("resultPill").textContent;
      const short = $("resultShort").textContent;
      const bullets = Array.from($("resultBullets").querySelectorAll("li")).map(li=>" - " + li.textContent).join("\n");

      return [
        "ê±´ì¶•í—ˆê°€/ì‹ ê³  ë¹ ë¥¸íŒì • ìš”ì•½",
        "--------------------------------",
        `ê²°ê³¼: ${pillText}`,
        `í•œì¤„ìš”ì•½: ${short}`,
        "",
        "[ì…ë ¥ê°’]",
        `í–‰ìœ„: ${action || "ë¯¸ì„ íƒ"}`,
        `ë„ì‹œì§€ì—­: ${isUrban || "ë¯¸ì„ íƒ"}`,
        `ì„¸ë¶€ì§€ì—­(ë„ì‹œì§€ì—­ ì•„ë‹˜ì¸ ê²½ìš°): ${zone || "-"}`,
        `ì—°ë©´ì (mÂ²): ${gfa || "-"}`,
        `ì¸µìˆ˜(ì§€í•˜ ì œì™¸): ${floors || "-"}`,
        `ì¦ê°€ ì—°ë©´ì  í•©ê³„(mÂ²): ${delta || "-"}`,
        `ëŒ€ìˆ˜ì„  ì²´í¬(ëŒ€í†µë ¹ë ¹): ${mrDecree ? "ì˜ˆ" : "ì•„ë‹ˆì˜¤"}`,
        `ëŒ€ìˆ˜ì„  ì²´í¬(ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ ì—†ìŒ ë“±): ${mrNoStructure ? "ì˜ˆ" : "ì•„ë‹ˆì˜¤"}`,
        `ìš©ë„ë³€ê²½: ${fromLabel ? fromLabel : "-"} â†’ ${toLabel ? toLabel : "-"}`,
        `ë©”ëª¨: ${note || "-"}`,
        "",
        "[ê·¼ê±°/ê²½ë¡œ]",
        bullets,
        "",
        "ì£¼ì˜: ë³¸ ë„êµ¬ëŠ” ì°¸ê³ ìš©ì…ë‹ˆë‹¤. ìµœì¢… íŒë‹¨ì€ ê´€í• ì²­ ë° ë²•ë ¹/ì¡°ë¡€/ëŒ€í†µë ¹ë ¹ ì„¸ë¶€ê¸°ì¤€ì„ í™•ì¸í•˜ì„¸ìš”."
      ].join("\n");
    }

    function resetAll(){
      // radios
      document.querySelectorAll('input[name="action"]').forEach(r=>r.checked=false);

      $("isUrban").value = "";
      $("zone").value = "";
      $("gfa").value = "";
      $("floors").value = "";
      $("delta").value = "";
      $("note").value = "";
      $("mrDecree").checked = false;
      $("mrNoStructure").checked = false;
      $("useFrom").value = "";
      $("useTo").value = "";

      refreshVisibility();
      updateProgress(["í–‰ìœ„ ì„ íƒ"]);
      renderResult({
        status:"warn",
        title:"ğŸŸ¡ ì…ë ¥ ëŒ€ê¸°",
        short:"í–‰ìœ„ë¥¼ ì„ íƒí•˜ê³  í•„ìš”í•œ ì…ë ¥ì„ ì±„ì›Œì£¼ì„¸ìš”.",
        why:"ì›ì¹™(í—ˆê°€)ì—ì„œ ì¶œë°œí•´ ì˜ˆì™¸(ì‹ ê³ ë¡œ í—ˆê°€ ê°ˆìŒ)ë¥¼ ìˆœì„œëŒ€ë¡œ ì²´í¬í•©ë‹ˆë‹¤.",
        bullets:["ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œì‘í•´ ì£¼ì„¸ìš”."]
      });
    }

    // ====== Events ======
    document.addEventListener("change", (e)=>{
      refreshVisibility();
      // live judge for user friendliness
      judge();
    });

    $("btnJudge").addEventListener("click", ()=>{
      judge();
      toast("íŒì • ì—…ë°ì´íŠ¸!");
    });

    $("btnCopy").addEventListener("click", async ()=>{
      // ensure latest
      judge();
      const text = makeSummaryText();
      try{
        await navigator.clipboard.writeText(text);
        toast("ê²°ê³¼ ìš”ì•½ ë³µì‚¬ ì™„ë£Œ!");
      }catch(err){
        // fallback
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        document.body.removeChild(ta);
        toast("ë³µì‚¬ ì™„ë£Œ(ëŒ€ì²´ ë°©ì‹)!");
      }
    });

    $("btnReset").addEventListener("click", ()=>{
      resetAll();
      toast("ì´ˆê¸°í™” ì™„ë£Œ!");
    });

    // initial
    refreshVisibility();
    updateProgress(["í–‰ìœ„ ì„ íƒ"]);
  </script>
</body>
</html>
