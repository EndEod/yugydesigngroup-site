<!doctype html>
<html lang="ko" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ëŒ€ìˆ˜ì„  í—ˆê°€/ì‹ ê³  íŒì •ê¸° (MVP)</title>
  <style>
    /* =========================
       THEME TOKENS
    ========================== */
    :root{
      --bg0:#f6f8ff;
      --bg1:#eef2f7;
      --card:#ffffff;
      --card2:#fbfcff;
      --ink:#0f172a;
      --muted:#475569;
      --line:#dbe3ef;
      --line2:#e7edf7;
      --shadow: 0 10px 28px rgba(15, 23, 42, .08);
      --shadow2: 0 6px 18px rgba(15, 23, 42, .08);
      --radius: 18px;

      --accent:#2563eb;   /* blue */
      --accent2:#14b8a6;  /* teal */
      --warn:#f59e0b;     /* amber */
      --danger:#ef4444;   /* red */
      --ok:#16a34a;       /* green */

      --field-bg:#f8fafc;
      --field-ink:#0b1220;
      --field-muted:#64748b;
      --field-focus: rgba(37, 99, 235, .25);

      --pill:#eef2ff;
      --pill-ink:#1e3a8a;

      --focus-ring: 0 0 0 4px var(--field-focus);
    }

    /* Dark theme (optional toggle) */
    html[data-theme="dark"]{
      --bg0:#0b1220;
      --bg1:#0b1629;
      --card:#0f1b2e;
      --card2:#0d182a;
      --ink:#e7eefc;
      --muted:#a9b6cf;
      --line:#203353;
      --line2:#1b2d4c;
      --shadow: 0 18px 40px rgba(0,0,0,.35);
      --shadow2: 0 10px 26px rgba(0,0,0,.30);

      --field-bg:#0b1628;
      --field-ink:#eaf1ff;
      --field-muted:#a4b3d3;
      --pill:#132b5c;
      --pill-ink:#cfe0ff;
      --focus-ring: 0 0 0 4px rgba(96,165,250,.25);
    }

    /* =========================
       BASE
    ========================== */
    *{ box-sizing: border-box; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", "Apple SD Gothic Neo", "Malgun Gothic", Arial, sans-serif;
      color: var(--ink);
      background:
        radial-gradient(1200px 600px at 20% 0%, rgba(37, 99, 235, .12), transparent 60%),
        radial-gradient(900px 500px at 80% 10%, rgba(20, 184, 166, .10), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
    }
    a{ color: var(--accent); text-decoration:none; }
    .wrap{
      max-width: 1180px;
      margin: 28px auto 60px;
      padding: 0 18px;
    }

    /* =========================
       HEADER
    ========================== */
    .topbar{
      display:flex;
      gap:14px;
      align-items: stretch;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    .hero{
      flex: 1 1 640px;
      background: linear-gradient(180deg, var(--card), var(--card2));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px 18px 16px;
    }
    .hero h1{
      margin: 0 0 6px;
      font-size: 20px;
      letter-spacing: -0.2px;
    }
    .hero p{
      margin: 0;
      color: var(--muted);
      line-height: 1.55;
      font-size: 13.5px;
    }
    .chips{
      flex: 0 1 360px;
      background: linear-gradient(180deg, var(--card), var(--card2));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px;
      display:flex;
      flex-direction: column;
      gap:10px;
      min-width: 270px;
    }
    .chipRow{
      display:flex;
      gap:10px;
      flex-wrap: wrap;
      align-items:center;
    }
    .chip{
      display:flex;
      align-items:center;
      gap:8px;
      padding: 9px 10px;
      border-radius: 999px;
      border:1px solid var(--line2);
      background: rgba(255,255,255,.55);
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1;
      user-select:none;
    }
    html[data-theme="dark"] .chip{ background: rgba(0,0,0,.18); }
    .dot{
      width:10px; height:10px; border-radius:999px;
      background: var(--accent2);
      box-shadow: 0 0 0 3px rgba(20,184,166,.18);
    }
    .dot.warn{ background: var(--warn); box-shadow: 0 0 0 3px rgba(245,158,11,.18); }
    .dot.gray{ background:#94a3b8; box-shadow: 0 0 0 3px rgba(148,163,184,.15); }
    .tools{
      display:flex;
      gap:10px;
      justify-content: space-between;
      align-items:center;
    }
    .btn{
      appearance:none;
      border:1px solid var(--line);
      background: var(--card);
      color: var(--ink);
      border-radius: 12px;
      padding: 10px 12px;
      cursor:pointer;
      font-weight: 700;
      font-size: 13px;
      box-shadow: var(--shadow2);
      transition: transform .08s ease, box-shadow .12s ease, border-color .12s ease;
    }
    .btn:hover{ transform: translateY(-1px); }
    .btn:active{ transform: translateY(0px); box-shadow: none; }
    .btn.primary{
      background: linear-gradient(180deg, rgba(37,99,235,.95), rgba(37,99,235,.84));
      color: #fff;
      border-color: rgba(37,99,235,.35);
      box-shadow: 0 14px 30px rgba(37,99,235,.22);
    }
    .btn.ghost{
      background: transparent;
      box-shadow:none;
    }
    .btn.small{ padding: 9px 10px; font-size: 12.5px; border-radius: 999px; }
    .btnRow{ display:flex; gap:10px; flex-wrap: wrap; }

    /* =========================
       LAYOUT
    ========================== */
    .grid{
      margin-top: 16px;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 14px;
      align-items: start;
    }
    @media (max-width: 980px){
      .grid{ grid-template-columns: 1fr; }
    }

    .panel{
      background: linear-gradient(180deg, var(--card), var(--card2));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    .panelHead{
      padding: 14px 16px 12px;
      border-bottom: 1px solid var(--line2);
      display:flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }
    .panelHead h2{
      margin:0;
      font-size: 14.5px;
      letter-spacing: -0.1px;
    }
    .panelHead .sub{
      margin-top: 4px;
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.35;
    }
    .panelBody{ padding: 14px 16px 16px; }

    /* =========================
       STEPPER
    ========================== */
    .stepper{
      display:flex;
      gap:10px;
      flex-wrap: wrap;
      align-items:center;
    }
    .step{
      display:flex;
      align-items:center;
      gap:8px;
      padding: 10px 12px;
      border-radius: 999px;
      border:1px solid var(--line2);
      background: rgba(37,99,235,.06);
      color: var(--muted);
      font-weight: 800;
      font-size: 12.5px;
      user-select:none;
    }
    html[data-theme="dark"] .step{ background: rgba(96,165,250,.10); }
    .step .num{
      width: 22px; height: 22px;
      border-radius: 999px;
      display:grid;
      place-items:center;
      background: rgba(37,99,235,.18);
      color: var(--ink);
      border:1px solid rgba(37,99,235,.18);
      font-size: 12px;
    }
    html[data-theme="dark"] .step .num{ color: #eaf1ff; }
    .step.active{
      background: rgba(20,184,166,.12);
      border-color: rgba(20,184,166,.30);
      color: var(--ink);
    }
    .step.active .num{
      background: rgba(20,184,166,.22);
      border-color: rgba(20,184,166,.20);
    }

    /* =========================
       FORM (ë” ë°ê³ , ë” êµ¬ë¶„ë˜ê²Œ)
    ========================== */
    .hint{
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px dashed rgba(245,158,11,.45);
      background: rgba(245,158,11,.10);
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.5;
      margin-bottom: 12px;
    }

    .q{
      border:1px solid var(--line2);
      background: var(--field-bg);
      border-radius: 16px;
      padding: 12px;
      margin-bottom: 10px;
      transition: box-shadow .12s ease, border-color .12s ease, transform .08s ease;
      position: relative;
    }
    .q:hover{ transform: translateY(-1px); }
    .q:focus-within{
      border-color: rgba(37,99,235,.45);
      box-shadow: var(--focus-ring);
      transform: translateY(-1px);
    }
    .q.active{
      border-color: rgba(20,184,166,.45);
      box-shadow: 0 0 0 4px rgba(20,184,166,.20);
    }
    .qTop{
      display:flex;
      align-items: center;
      justify-content: space-between;
      gap:10px;
      margin-bottom: 8px;
      flex-wrap: wrap;
    }
    .qTitle{
      display:flex;
      align-items: center;
      gap:8px;
      font-weight: 900;
      font-size: 13px;
      letter-spacing: -0.1px;
    }
    .badge{
      font-size: 11px;
      font-weight: 900;
      color: var(--pill-ink);
      background: var(--pill);
      border:1px solid rgba(37,99,235,.20);
      padding: 6px 8px;
      border-radius: 999px;
      white-space: nowrap;
    }
    .qHelp{
      color: var(--field-muted);
      font-size: 12.2px;
      line-height: 1.45;
      margin-top: 2px;
    }

    label{ display:block; font-size: 12px; color: var(--muted); margin: 10px 0 6px; font-weight: 800; }
    select, input[type="number"], input[type="text"]{
      width:100%;
      border-radius: 14px;
      border:1px solid var(--line);
      background: var(--card);
      color: var(--field-ink);
      padding: 11px 12px;
      font-size: 13.5px;
      outline: none;
      transition: box-shadow .12s ease, border-color .12s ease;
    }
    select:focus, input:focus{
      border-color: rgba(37,99,235,.55);
      box-shadow: var(--focus-ring);
    }
    .row2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    @media (max-width: 560px){
      .row2{ grid-template-columns: 1fr; }
    }
    .inlineNote{
      margin-top: 8px;
      color: var(--muted);
      font-size: 12.2px;
      line-height: 1.45;
    }

    /* =========================
       RESULT
    ========================== */
    .result{
      border-radius: 16px;
      border: 1px solid var(--line2);
      background: linear-gradient(180deg, var(--card), var(--card2));
      padding: 14px;
      margin-top: 10px;
    }
    .callout{
      border-radius: 16px;
      padding: 12px 12px;
      border: 1px solid var(--line2);
      background: rgba(37,99,235,.06);
    }
    .callout h3{ margin:0 0 6px; font-size: 14px; letter-spacing:-0.1px; }
    .callout p{ margin:0; color: var(--muted); font-size: 12.8px; line-height: 1.55; }
    .callout.ok{ background: rgba(22,163,74,.10); border-color: rgba(22,163,74,.25); }
    .callout.warn{ background: rgba(245,158,11,.12); border-color: rgba(245,158,11,.25); }
    .callout.danger{ background: rgba(239,68,68,.10); border-color: rgba(239,68,68,.25); }

    .list{
      margin: 10px 0 0;
      padding-left: 16px;
      color: var(--muted);
      font-size: 12.8px;
      line-height: 1.55;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 7px 10px;
      border-radius: 999px;
      border:1px solid var(--line2);
      background: rgba(20,184,166,.10);
      color: var(--ink);
      font-weight: 900;
      font-size: 12.3px;
    }
    .pill .mini{ width:9px; height:9px; border-radius: 999px; background: var(--accent2); }
    .pill.gray{ background: rgba(148,163,184,.12); color: var(--muted); }
    .pill.gray .mini{ background:#94a3b8; }
    .pill.amber{ background: rgba(245,158,11,.14); }
    .pill.amber .mini{ background: var(--warn); }

    /* =========================
       SUMMARY PANEL
    ========================== */
    .summaryBox{
      display:flex;
      flex-direction: column;
      gap:10px;
    }
    .kv{
      border:1px solid var(--line2);
      background: var(--field-bg);
      border-radius: 16px;
      padding: 12px;
    }
    .kv .k{
      color: var(--muted);
      font-size: 12px;
      font-weight: 900;
      margin-bottom: 6px;
    }
    .kv .v{
      font-weight: 900;
      color: var(--ink);
      font-size: 13.5px;
      line-height: 1.35;
    }
    .kv .v.muted{ color: var(--muted); font-weight: 800; }

    details{
      border:1px solid var(--line2);
      border-radius: 16px;
      padding: 10px 12px;
      background: rgba(37,99,235,.05);
    }
    details summary{
      cursor:pointer;
      font-weight: 900;
      font-size: 13px;
    }
    details .inside{
      margin-top: 8px;
      color: var(--muted);
      font-size: 12.6px;
      line-height: 1.55;
    }

    .footerNote{
      margin-top: 10px;
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.6;
    }

    /* tiny helper */
    .sr-only{
      position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div class="hero">
        <h1>ëŒ€ìˆ˜ì„  í—ˆê°€/ì‹ ê³  íŒì •ê¸° (MVP)</h1>
        <p>
          â€œí—ˆê°€ëƒ? ì‹ ê³ ëƒ?â€ë¥¼ ì‚¬ìš©ìì—ê²Œ ë– ë„˜ê¸°ì§€ ì•Šê³ ,
          <b>ê³µì‚¬ ì‚¬ì‹¤</b>ë§Œ ì…ë ¥í•˜ë©´ <b>ëŒ€ìˆ˜ì„  í•´ë‹¹ ì—¬ë¶€</b>ì™€ <b>í—ˆê°€ ê²€í†  vs ì‹ ê³  ê°€ëŠ¥</b>ì„ ìë™ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” íë¦„ì…ë‹ˆë‹¤. ğŸ§­
        </p>
      </div>

      <div class="chips">
        <div class="chipRow" aria-label="ìƒíƒœ ë°°ì§€">
          <div class="chip"><span class="dot"></span>ëŒ€ìˆ˜ì„  ë²”ìœ„: ì‹œí–‰ë ¹ ê¸°ì¤€</div>
          <div class="chip"><span class="dot warn"></span>ì‹ ê³  ê°€ëŠ¥ ë²”ìœ„: ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡</div>
          <div class="chip"><span class="dot gray"></span>MVP: ëŒ€ìˆ˜ì„  ìš°ì„  êµ¬í˜„</div>
        </div>
        <div class="tools">
          <button class="btn small" id="themeBtn" type="button" title="í™”ë©´ ë°ê²Œ/ì–´ë‘¡ê²Œ ì „í™˜">í…Œë§ˆ: ë¼ì´íŠ¸</button>
          <button class="btn small" id="copyBtn" type="button" title="ìš”ì•½ì„ ë³µì‚¬">ìš”ì•½ ë³µì‚¬</button>
        </div>
      </div>
    </div>

    <div class="grid">
      <!-- LEFT: MAIN FLOW -->
      <div class="panel" id="mainPanel">
        <div class="panelHead">
          <div>
            <h2>ì˜ì‚¬ê²°ì • ì§„í–‰ìƒí™©</h2>
            <div class="sub">ë‹¤ìŒ ë²„íŠ¼ë§Œ ëˆŒëŸ¬ë„ íë¦„ì´ ì´ì–´ì§‘ë‹ˆë‹¤. ì…ë ¥ì¹¸ì€ <b>ë°ì€ ì¹´ë“œ</b>ë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤.</div>
          </div>
          <div class="btnRow">
            <button class="btn" id="prevBtn" type="button">ì´ì „</button>
            <button class="btn primary" id="nextBtn" type="button">ë‹¤ìŒ</button>
          </div>
        </div>

        <div class="panelBody">
          <div class="stepper" role="list" aria-label="ë‹¨ê³„ í‘œì‹œ">
            <div class="step active" id="stepPill1" role="listitem"><span class="num">1</span>ê¸°ë³¸ ì •ë³´</div>
            <div class="step" id="stepPill2" role="listitem"><span class="num">2</span>ê³µì‚¬ ì‚¬ì‹¤ ì²´í¬</div>
            <div class="step" id="stepPill3" role="listitem"><span class="num">3</span>ìë™ íŒì • ê²°ê³¼</div>
          </div>

          <div id="step1" style="margin-top:12px;">
            <div class="hint">
              âœ… <b>ì—¬ê¸°ì„œëŠ” â€œìš©ë„â€ë§Œ ì¡ìŠµë‹ˆë‹¤.</b><br/>
              í—ˆê°€/ì‹ ê³ ë¥¼ ë¬»ì§€ ì•ŠìŠµë‹ˆë‹¤. ê·¸ê±´ ë„êµ¬ê°€ ê²°ì •í•©ë‹ˆë‹¤.
            </div>

            <div class="q" data-q="use">
              <div class="qTop">
                <div>
                  <div class="qTitle"><span class="badge">ì…ë ¥ 1</span> ê±´ì¶•ë¬¼ ìš©ë„ (ê±´ì¶•ë²• ì‹œí–‰ë ¹ ë³„í‘œ1)</div>
                  <div class="qHelp">ëŒ€ë¶„ë¥˜ë¥¼ ì„ íƒí•˜ë©´ ì„¸ë¶€ ìš©ë„ê°€ ìë™ìœ¼ë¡œ ë”°ë¼ì˜µë‹ˆë‹¤.</div>
                </div>
                <span class="pill gray" id="usePill"><span class="mini"></span>ë¯¸ì…ë ¥</span>
              </div>

              <div class="row2">
                <div>
                  <label for="useCat">ìš©ë„ ëŒ€ë¶„ë¥˜</label>
                  <select id="useCat">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                  </select>
                </div>
                <div>
                  <label for="useDetail">ìš©ë„ ì„¸ë¶€</label>
                  <select id="useDetail" disabled>
                    <option value="">ëŒ€ë¶„ë¥˜ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</option>
                  </select>
                </div>
              </div>

              <div class="inlineNote">
                â€» ì´ MVPëŠ” â€œëŒ€ìˆ˜ì„  í—ˆê°€/ì‹ ê³ â€ë¶€í„° ì‹œì‘í•©ë‹ˆë‹¤. ì‹ ì¶•/ì¦ì¶•/ìš©ë„ë³€ê²½ ë“±ì€ ë‹¤ìŒ ë‹¨ê³„ í™•ì¥ í•­ëª©ì…ë‹ˆë‹¤.
              </div>
            </div>
          </div>

          <div id="step2" style="display:none; margin-top:12px;">
            <div class="hint">
              âœ… <b>ê³µì‚¬ ì‚¬ì‹¤ë§Œ ì²´í¬</b>í•˜ì„¸ìš”.<br/>
              â€œëŒ€ìˆ˜ì„ ì¸ê°€?â€ â€œì‹ ê³ ë¡œ ê°€ëŠ¥í•œê°€?â€ëŠ” ì•„ë˜ ì…ë ¥ì„ ë°”íƒ•ìœ¼ë¡œ ìë™íŒì •ë©ë‹ˆë‹¤.
            </div>

            <div class="q" data-q="major">
              <div class="qTop">
                <div>
                  <div class="qTitle"><span class="badge">ì…ë ¥ 2</span> ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´(ì² ê±°)ê°€ ìˆë‚˜ìš”?</div>
                  <div class="qHelp">ì‹ ê³  ê°€ëŠ¥ ëŒ€ìˆ˜ì„ (ì‹œí–‰ë ¹ ì œ11ì¡°â‘¡)ì€ ì¼ë°˜ì ìœ¼ë¡œ â€œì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ ì—†ìŒâ€ ì¡°ê±´ê³¼ í•¨ê»˜ íŒë‹¨í•©ë‹ˆë‹¤.</div>
                </div>
                <span class="pill gray" id="majorPill"><span class="mini"></span>ë¯¸ì„ íƒ</span>
              </div>

              <label for="majorRemoval">í•´ì²´ ì—¬ë¶€</label>
              <select id="majorRemoval">
                <option value="">ì„ íƒ</option>
                <option value="no">ì•„ë‹ˆì˜¤ (í•´ì²´ ì—†ìŒ)</option>
                <option value="yes">ì˜ˆ (í•´ì²´ ìˆìŒ)</option>
              </select>
            </div>

            <!-- Triggers -->
            <div class="q" data-q="triggers">
              <div class="qTop">
                <div>
                  <div class="qTitle"><span class="badge">ì…ë ¥ 3</span> ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±° í•­ëª©</div>
                  <div class="qHelp">ì•„ë˜ í•­ëª© ì¤‘ â€œê¸°ì¤€ ì´ìƒâ€ì´ ìˆìœ¼ë©´ ëŒ€ìˆ˜ì„  í›„ë³´ê°€ ë©ë‹ˆë‹¤. (MVPìš© ë‹¨ìˆœ ë¡œì§)</div>
                </div>
                <span class="pill gray" id="triggerPill"><span class="mini"></span>ë¯¸ì…ë ¥</span>
              </div>

              <div class="row2">
                <div>
                  <label for="bearingWorkType">ë‚´ë ¥ë²½ ê³µì‚¬ í˜•íƒœ</label>
                  <select id="bearingWorkType">
                    <option value="none">í•´ë‹¹ ì—†ìŒ</option>
                    <option value="repair">ìˆ˜ì„ (ë³´ìˆ˜Â·êµì²´)</option>
                    <option value="change">ë³€ê²½(ë°°ì¹˜/êµ¬ì¡° ë³€ê²½)</option>
                    <option value="add">ì¦ì„¤(ì¶”ê°€ ì„¤ì¹˜)</option>
                    <option value="remove">í•´ì²´(ì² ê±°/ì‚­ì œ)</option>
                  </select>
                  <label for="bearingArea">ë‚´ë ¥ë²½ ìˆ˜ì„ /ë³€ê²½ ë©´ì  í•©ê³„ (mÂ²)</label>
                  <input id="bearingArea" type="number" min="0" step="0.1" placeholder="ì˜ˆ: 30" />
                  <div class="inlineNote">ê¸°ì¤€(ì˜ˆì‹œ): <b>30mÂ² ì´ìƒ</b>ì´ë©´ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°</div>
                </div>

                <div>
                  <label for="columnWorkType">ê¸°ë‘¥ ê³µì‚¬ í˜•íƒœ</label>
                  <select id="columnWorkType">
                    <option value="none">í•´ë‹¹ ì—†ìŒ</option>
                    <option value="repair">ìˆ˜ì„ (ë³´ìˆ˜Â·êµì²´)</option>
                    <option value="change">ë³€ê²½(ë°°ì¹˜/êµ¬ì¡° ë³€ê²½)</option>
                    <option value="add">ì¦ì„¤(ì¶”ê°€ ì„¤ì¹˜)</option>
                    <option value="remove">í•´ì²´(ì² ê±°/ì‚­ì œ)</option>
                  </select>
                  <label for="columnCount">ê¸°ë‘¥ ìˆ˜ì„ /ë³€ê²½ ê°œìˆ˜ (ê°œ)</label>
                  <input id="columnCount" type="number" min="0" step="1" placeholder="ì˜ˆ: 3" />
                  <div class="inlineNote">ê¸°ì¤€(ì˜ˆì‹œ): <b>3ê°œ ì´ìƒ</b>ì´ë©´ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°</div>
                </div>
              </div>

              <div class="row2" style="margin-top:10px;">
                <div>
                  <label for="beamWorkType">ë³´ ê³µì‚¬ í˜•íƒœ</label>
                  <select id="beamWorkType">
                    <option value="none">í•´ë‹¹ ì—†ìŒ</option>
                    <option value="repair">ìˆ˜ì„ (ë³´ìˆ˜Â·êµì²´)</option>
                    <option value="change">ë³€ê²½(ë°°ì¹˜/êµ¬ì¡° ë³€ê²½)</option>
                    <option value="add">ì¦ì„¤(ì¶”ê°€ ì„¤ì¹˜)</option>
                    <option value="remove">í•´ì²´(ì² ê±°/ì‚­ì œ)</option>
                  </select>
                  <label for="beamCount">ë³´ ìˆ˜ì„ /ë³€ê²½ ê°œìˆ˜ (ê°œ)</label>
                  <input id="beamCount" type="number" min="0" step="1" placeholder="ì˜ˆ: 3" />
                  <div class="inlineNote">ê¸°ì¤€(ì˜ˆì‹œ): <b>3ê°œ ì´ìƒ</b>ì´ë©´ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°</div>
                </div>

                <div>
                  <label for="extFinishWorkType">ì™¸ë²½ ë§ˆê°ì¬ ê³µì‚¬ í˜•íƒœ</label>
                  <select id="extFinishWorkType">
                    <option value="none">í•´ë‹¹ ì—†ìŒ</option>
                    <option value="repair">ìˆ˜ì„ (ë³´ìˆ˜Â·êµì²´)</option>
                    <option value="change">ë³€ê²½(ë°°ì¹˜/êµ¬ì¡° ë³€ê²½)</option>
                    <option value="add">ì¦ì„¤(ì¶”ê°€ ì„¤ì¹˜)</option>
                    <option value="remove">í•´ì²´(ì² ê±°/ì‚­ì œ)</option>
                  </select>
                  <label for="extFinishArea">ì™¸ë²½ ë§ˆê°ì¬ ë³€ê²½/ìˆ˜ì„  ë©´ì  í•©ê³„ (mÂ²)</label>
                  <input id="extFinishArea" type="number" min="0" step="0.1" placeholder="ì˜ˆ: 100" />
                  <div class="inlineNote">ê¸°ì¤€(ì˜ˆì‹œ): <b>30mÂ² ì´ìƒ</b>ì´ë©´ ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°</div>
                </div>
              </div>

              <div class="inlineNote" style="margin-top:10px;">
                â€» ì‹¤ì œ ë²•ë ¹ í•´ì„ì€ ì§€ìì²´/ì¡°ë¡€/ì‚¬ë¡€ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í˜ì´ì§€ëŠ” â€œì…ë ¥ êµ¬ì¡°â€ì™€ â€œíë¦„â€ì„ ë¨¼ì € ê³ ì •í•˜ëŠ” MVPì…ë‹ˆë‹¤.
              </div>
            </div>
          </div>

          <div id="step3" style="display:none; margin-top:12px;">
            <div class="hint">
              âœ… ê²°ê³¼ëŠ” <b>ë°ì€ ìƒì</b>ì—, í•µì‹¬ì€ <b>êµµì€ ê¸€ì”¨</b>ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤.<br/>
              ê¸€ì”¨ê°€ í•˜ì–˜ì„œ ì•ˆ ë³´ì´ëŠ” ë¬¸ì œë¥¼ ì—†ì• ê¸° ìœ„í•´, ê²°ê³¼ ì˜ì—­ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë°ì€ ë°°ê²½ + ì§„í•œ ê¸€ìì…ë‹ˆë‹¤.
            </div>

            <div class="result" id="resultBox">
              <div class="callout" id="decisionCallout">
                <h3 id="decisionTitle">íŒì • ì¤€ë¹„ ì¤‘â€¦</h3>
                <p id="decisionDesc">ì¢Œì¸¡ ì…ë ¥ì„ ì™„ë£Œí•˜ë©´ ìë™ìœ¼ë¡œ íŒì •ë©ë‹ˆë‹¤.</p>
              </div>

              <div style="margin-top:12px; display:flex; gap:10px; flex-wrap: wrap;">
                <span class="pill" id="pillMajor"><span class="mini"></span>ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´: -</span>
                <span class="pill" id="pillTrigger"><span class="mini"></span>ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°: -</span>
                <span class="pill" id="pillReport"><span class="mini"></span>ì‹ ê³  ê°€ëŠ¥ì„±: -</span>
              </div>

              <ul class="list" id="reasonList"></ul>

              <details style="margin-top:12px;">
                <summary>ë³µì‚¬ ê°€ëŠ¥í•œ ìš”ì•½</summary>
                <div class="inside">
                  <pre id="copyText" style="white-space:pre-wrap; margin:10px 0 0; background: rgba(148,163,184,.12); padding:10px; border-radius:12px; border:1px solid var(--line2); color: var(--ink);"></pre>
                </div>
              </details>

              <div class="footerNote">
                âš ï¸ <b>ì£¼ì˜</b>:
                ë³¸ MVPëŠ” â€œëŒ€ìˆ˜ì„  íŒë‹¨ íë¦„â€ê³¼ â€œì…ë ¥ UIâ€ë¥¼ ë¨¼ì € ì•ˆì •í™”í•˜ëŠ” ëª©ì ì…ë‹ˆë‹¤.
                ì‹¤ì œ ì¸í—ˆê°€ ê°€ëŠ¥ ì—¬ë¶€ëŠ” ê´€í• ì²­ ê²€í† , ì¡°ë¡€, êµ¬ì¡°/ë°©í™”/í”¼ë‚œ ë“± íƒ€ ê¸°ì¤€ê³¼ í•¨ê»˜ ì¢…í•© íŒë‹¨ì´ í•„ìš”í•©ë‹ˆë‹¤.
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- RIGHT: LIVE SUMMARY -->
      <div class="panel">
        <div class="panelHead">
          <div>
            <h2>í˜„ì¬ ì…ë ¥ ìš”ì•½</h2>
            <div class="sub">â€œë‚´ê°€ ë­˜ ì²´í¬í–ˆì§€?â€ê°€ ë°”ë¡œ ë³´ì´ê²Œ</div>
          </div>
          <button class="btn ghost" type="button" id="recalcBtn" title="ì…ë ¥ê°’ìœ¼ë¡œ ë‹¤ì‹œ ê³„ì‚°">ìƒˆë¡œ ê³„ì‚°</button>
        </div>

        <div class="panelBody">
          <div class="summaryBox">
            <div class="kv">
              <div class="k">ìš©ë„</div>
              <div class="v" id="sumUse">ë¯¸ì…ë ¥</div>
            </div>

            <div class="kv">
              <div class="k">ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´</div>
              <div class="v muted" id="sumMajor">ë¯¸ì„ íƒ</div>
            </div>

            <div class="kv">
              <div class="k">ì²´í¬ëœ ê³µì‚¬ í•­ëª©</div>
              <div class="v muted" id="sumTriggers">ì•„ì§ ì—†ìŒ</div>
            </div>

            <details>
              <summary>MVP ë¡œë“œë§µ (ë‹¤ìŒ í™•ì¥)</summary>
              <div class="inside">
                1) ì‹ ì¶•/ì¦ì¶•/ê°œì¶•/ìš©ë„ë³€ê²½ ë¡œì§<br/>
                2) ë³„í‘œ1 ìš©ë„ ê¸°ë°˜ ì˜ˆì™¸/ì œí•œ ìë™ ì•ˆë‚´<br/>
                3) ì¡°ë¡€/ì§€êµ¬ë‹¨ìœ„/ë°©í™”ì§€êµ¬ ë“± â€œë™ë„¤ ë£°â€ ì¡°ê±´ ì¶”ê°€
              </div>
            </details>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  /* =========================
     1) ìš©ë„ ë°ì´í„° (ë³„í‘œ1 ê¸°ë°˜, MVPìš©)
     ========================= */
  const USES = [
    { cat: "1. ë‹¨ë…ì£¼íƒ", details: ["ê°€. ë‹¨ë…ì£¼íƒ", "ë‚˜. ë‹¤ì¤‘ì£¼íƒ", "ë‹¤. ë‹¤ê°€êµ¬ì£¼íƒ", "ë¼. ê³µê´€(å…¬é¤¨)"] },
    { cat: "2. ê³µë™ì£¼íƒ", details: ["ê°€. ì•„íŒŒíŠ¸", "ë‚˜. ì—°ë¦½ì£¼íƒ", "ë‹¤. ë‹¤ì„¸ëŒ€ì£¼íƒ", "ë¼. ê¸°ìˆ™ì‚¬(ì¼ë°˜/ì„ëŒ€í˜•)"] },
    { cat: "3. ì œ1ì¢… ê·¼ë¦°ìƒí™œì‹œì„¤", details: ["ê°€. ì†Œë§¤ì (1,000ã¡ ë¯¸ë§Œ)", "ë‚˜. íœ´ê²ŒìŒì‹ì /ì œê³¼ì (300ã¡ ë¯¸ë§Œ)", "ë‹¤. ì´ìš©ì›/ë¯¸ìš©ì›/ëª©ìš•ì¥/ì„¸íƒì†Œ", "ë¼. ì˜ì›/ì¹˜ê³¼/í•œì˜ì› ë“±", "ë§ˆ. íƒêµ¬ì¥/ì²´ìœ¡ë„ì¥(500ã¡ ë¯¸ë§Œ)", "ë°”. ê³µê³µì—…ë¬´ì‹œì„¤(1,000ã¡ ë¯¸ë§Œ)", "ì‚¬. ë§ˆì„íšŒê´€ ë“±", "ì•„. ë³€ì „ì†Œ/í†µì‹ /ì •ìˆ˜ì¥ ë“±(1,000ã¡ ë¯¸ë§Œ)", "ì. ì†Œê·œëª¨ ì‚¬ë¬´ì†Œ(30ã¡ ë¯¸ë§Œ)", "ì°¨. ì „ê¸°ì°¨ ì¶©ì „ì†Œ(1,000ã¡ ë¯¸ë§Œ)", "ì¹´. ë™ë¬¼ë³‘ì›/ë¯¸ìš©ì‹¤(300ã¡ ë¯¸ë§Œ)"] },
    { cat: "4. ì œ2ì¢… ê·¼ë¦°ìƒí™œì‹œì„¤", details: ["ê°€. ê³µì—°ì¥(500ã¡ ë¯¸ë§Œ)", "ë‚˜. ì¢…êµì§‘íšŒì¥(500ã¡ ë¯¸ë§Œ)", "ë‹¤. ìë™ì°¨ì˜ì—…ì†Œ(1,000ã¡ ë¯¸ë§Œ)", "ë¼. ì„œì ", "ë§ˆ. ì´í¬íŒë§¤ì†Œ", "ë°”. ì‚¬ì§„ê´€/í‘œêµ¬ì ", "ì‚¬. ê²Œì„/ì²´í—˜ì‹œì„¤(500ã¡ ë¯¸ë§Œ)", "ì•„. íœ´ê²ŒìŒì‹ì /ì œê³¼ì (300ã¡ ì´ìƒ)", "ì. ì¼ë°˜ìŒì‹ì ", "ì°¨. ì¥ì˜ì‚¬/ë™ë¬¼ìœ„íƒê´€ë¦¬ì—… ë“±", "ì¹´. í•™ì›/êµìŠµì†Œ/ì§ì—…í›ˆë ¨ì†Œ(500ã¡ ë¯¸ë§Œ)", "íƒ€. ë…ì„œì‹¤/ê¸°ì›", "íŒŒ. ì²´ë ¥ë‹¨ë ¨/ê³¨í”„ì—°ìŠµì¥ ë“±(500ã¡ ë¯¸ë§Œ)", "í•˜. ì‚¬ë¬´ì†Œ(500ã¡ ë¯¸ë§Œ)", "ê±°. ë‹¤ì¤‘ìƒí™œì‹œì„¤(ê³ ì‹œì› ë“±)", "ë„ˆ. ì œì¡°ì—…ì†Œ/ìˆ˜ë¦¬ì (500ã¡ ë¯¸ë§Œ)", "ë”. ë‹¨ë€ì£¼ì (150ã¡ ë¯¸ë§Œ)", "ëŸ¬. ì•ˆë§ˆì‹œìˆ ì†Œ/ë…¸ë˜ì—°ìŠµì¥", "ë¨¸. ì£¼ë¬¸ë°°ì†¡ì‹œì„¤(500ã¡ ë¯¸ë§Œ)", "ë²„. ê³µìœ ë³´ê´€ì‹œì„¤(1,000ã¡ ë¯¸ë§Œ)"] },
    { cat: "5. ë¬¸í™” ë° ì§‘íšŒì‹œì„¤", details: ["ê°€. ê³µì—°ì¥(ì œ2ì¢… ì œì™¸)", "ë‚˜. ì§‘íšŒì¥(ì œ2ì¢… ì œì™¸)", "ë‹¤. ê´€ëŒì¥(ê´€ëŒì„ 1,000ã¡ ì´ìƒ)", "ë¼. ì „ì‹œì¥", "ë§ˆ. ë™Â·ì‹ë¬¼ì›"] },
    { cat: "6. ì¢…êµì‹œì„¤", details: ["ê°€. ì¢…êµì§‘íšŒì¥(ì œ2ì¢… ì œì™¸)", "ë‚˜. ë´‰ì•ˆë‹¹"] },
    { cat: "7. íŒë§¤ì‹œì„¤", details: ["ê°€. ë„ë§¤ì‹œì¥", "ë‚˜. ì†Œë§¤ì‹œì¥", "ë‹¤. ìƒì (ì¡°ê±´ í•´ë‹¹)"] },
    { cat: "8. ìš´ìˆ˜ì‹œì„¤", details: ["ê°€. ì—¬ê°ìë™ì°¨í„°ë¯¸ë„", "ë‚˜. ì² ë„ì‹œì„¤", "ë‹¤. ê³µí•­ì‹œì„¤", "ë¼. í•­ë§Œì‹œì„¤", "ë§ˆ. ë²„í‹°í¬íŠ¸", "ë°”. ìœ ì‚¬ì‹œì„¤"] },
    { cat: "9. ì˜ë£Œì‹œì„¤", details: ["ê°€. ë³‘ì›", "ë‚˜. ê²©ë¦¬ë³‘ì›"] },
    { cat: "10. êµìœ¡ì—°êµ¬ì‹œì„¤", details: ["ê°€. í•™êµ", "ë‚˜. êµìœ¡ì›", "ë‹¤. ì§ì—…í›ˆë ¨ì†Œ", "ë¼. í•™ì›/êµìŠµì†Œ", "ë§ˆ. ì—°êµ¬ì†Œ", "ë°”. ë„ì„œê´€"] },
    { cat: "11. ë…¸ìœ ìì‹œì„¤", details: ["ê°€. ì•„ë™ ê´€ë ¨ ì‹œì„¤", "ë‚˜. ë…¸ì¸ë³µì§€ì‹œì„¤", "ë‹¤. ê¸°íƒ€ ì‚¬íšŒë³µì§€/ê·¼ë¡œë³µì§€"] },
    { cat: "12. ìˆ˜ë ¨ì‹œì„¤", details: ["ê°€. ìƒí™œê¶Œ ìˆ˜ë ¨ì‹œì„¤", "ë‚˜. ìì—°ê¶Œ ìˆ˜ë ¨ì‹œì„¤", "ë‹¤. ìœ ìŠ¤í˜¸ìŠ¤í…”", "ë¼. ì•¼ì˜ì¥(ì œ29í˜¸ ì œì™¸)"] },
    { cat: "13. ìš´ë™ì‹œì„¤", details: ["ê°€. ìš´ë™ì‹œì„¤(ê·¼ìƒ ì œì™¸)", "ë‚˜. ì²´ìœ¡ê´€(ê´€ëŒì„ 1,000ã¡ ë¯¸ë§Œ)", "ë‹¤. ìš´ë™ì¥(ê´€ëŒì„ 1,000ã¡ ë¯¸ë§Œ)"] },
    { cat: "14. ì—…ë¬´ì‹œì„¤", details: ["ê°€. ê³µê³µì—…ë¬´ì‹œì„¤", "ë‚˜. ì¼ë°˜ì—…ë¬´ì‹œì„¤(ì˜¤í”¼ìŠ¤í…” í¬í•¨)"] },
    { cat: "15. ìˆ™ë°•ì‹œì„¤", details: ["ê°€. ì¼ë°˜/ìƒí™œìˆ™ë°•", "ë‚˜. ê´€ê´‘ìˆ™ë°•", "ë‹¤. ë‹¤ì¤‘ìƒí™œì‹œì„¤(ì œ2ì¢… ì œì™¸)", "ë¼. ìœ ì‚¬ì‹œì„¤"] },
    { cat: "16. ìœ„ë½ì‹œì„¤", details: ["ê°€. ë‹¨ë€ì£¼ì (ì œ2ì¢… ì œì™¸)", "ë‚˜. ìœ í¥ì£¼ì ", "ë‹¤. í…Œë§ˆíŒŒí¬ì—… ì‹œì„¤", "ë§ˆ. ë¬´ë„ì¥/ë¬´ë„í•™ì›", "ë°”. ì¹´ì§€ë…¸"] },
    { cat: "17. ê³µì¥", details: ["ê³µì¥(ë³„ë„ ë¶„ë¥˜ ì œì™¸)"] },
    { cat: "18. ì°½ê³ ì‹œì„¤", details: ["ê°€. ì°½ê³ ", "ë‚˜. í•˜ì—­ì¥", "ë‹¤. ë¬¼ë¥˜í„°ë¯¸ë„", "ë¼. ì§‘ë°°ì†¡ ì‹œì„¤"] },
    { cat: "19. ìœ„í—˜ë¬¼ ì €ì¥ ë° ì²˜ë¦¬ ì‹œì„¤", details: ["ê°€. ì£¼ìœ ì†Œ/ì„ìœ íŒë§¤", "ë‚˜. LPG ì¶©ì „/ì €ì¥", "ë‹¤. ìœ„í—˜ë¬¼ ì œì¡°/ì €ì¥/ì·¨ê¸‰", "ë¼. ì•¡í™”ê°€ìŠ¤", "ë§ˆ. ìœ ë…ë¬¼", "ë°”. ê³ ì••ê°€ìŠ¤", "ì‚¬. ë„ë£Œë¥˜", "ì•„. ë„ì‹œê°€ìŠ¤ ì œì¡°", "ì. í™”ì•½ë¥˜", "ì°¨. ìœ ì‚¬ì‹œì„¤"] },
    { cat: "20. ìë™ì°¨ ê´€ë ¨ ì‹œì„¤", details: ["ê°€. ì£¼ì°¨ì¥", "ë‚˜. ì„¸ì°¨ì¥", "ë‹¤. íì°¨ì¥", "ë¼. ê²€ì‚¬ì¥", "ë§ˆ. ë§¤ë§¤ì¥", "ë°”. ì •ë¹„ê³µì¥", "ì‚¬. ìš´ì „/ì •ë¹„í•™ì›", "ì•„. ì°¨ê³ /ì£¼ê¸°ì¥", "ì. ì „ê¸°ì°¨ ì¶©ì „ì†Œ(ê·¼ìƒ ì œì™¸)"] },
    { cat: "21. ë™ë¬¼ ë° ì‹ë¬¼ ê´€ë ¨ ì‹œì„¤", details: ["ê°€. ì¶•ì‚¬", "ë‚˜. ê°€ì¶•ì‹œì„¤", "ë‹¤. ë„ì¶•ì¥", "ë¼. ë„ê³„ì¥", "ë§ˆ. ì‘ë¬¼ì¬ë°°ì‚¬", "ë°”. ì¢…ë¬˜ë°°ì–‘", "ì‚¬. ì˜¨ì‹¤", "ì•„. ìœ ì‚¬ì‹œì„¤"] },
    { cat: "22. ìì›ìˆœí™˜ ê´€ë ¨ ì‹œì„¤", details: ["ê°€. í•˜ìˆ˜ ë“± ì²˜ë¦¬", "ë‚˜. ê³ ë¬¼ìƒ", "ë‹¤. íê¸°ë¬¼ì¬í™œìš©", "ë¼. íê¸°ë¬¼ì²˜ë¶„", "ë§ˆ. ê°ëŸ‰í™”"] },
    { cat: "23. êµì •ì‹œì„¤", details: ["ê°€. êµì •ì‹œì„¤", "ë‚˜. ê°±ìƒë³´í˜¸ì‹œì„¤", "ë‹¤. ì†Œë…„ì›/ì†Œë…„ë¶„ë¥˜ì‹¬ì‚¬ì›"] },
    { cat: "23ì˜2. êµ­ë°©Â·êµ°ì‚¬ì‹œì„¤", details: ["êµ­ë°©Â·êµ°ì‚¬ì‹œì„¤"] },
    { cat: "24. ë°©ì†¡í†µì‹ ì‹œì„¤", details: ["ê°€. ë°©ì†¡êµ­", "ë‚˜. ì „ì‹ ì „í™”êµ­", "ë‹¤. ì´¬ì˜ì†Œ", "ë¼. í†µì‹ ìš© ì‹œì„¤", "ë§ˆ. ë°ì´í„°ì„¼í„°", "ë°”. ìœ ì‚¬ì‹œì„¤"] },
    { cat: "25. ë°œì „ì‹œì„¤", details: ["ë°œì „ì†Œ(ì§‘ë‹¨ì—ë„ˆì§€ í¬í•¨)"] },
    { cat: "26. ë¬˜ì§€ ê´€ë ¨ ì‹œì„¤", details: ["ê°€. í™”ì¥ì‹œì„¤", "ë‚˜. ë´‰ì•ˆë‹¹", "ë‹¤. ë¬˜ì§€ ë¶€ìˆ˜", "ë¼. ë™ë¬¼ í™”ì¥/ë‚©ê³¨"] },
    { cat: "27. ê´€ê´‘ íœ´ê²Œì‹œì„¤", details: ["ê°€. ì•¼ì™¸ìŒì•…ë‹¹", "ë‚˜. ì•¼ì™¸ê·¹ì¥", "ë‹¤. ì–´ë¦°ì´íšŒê´€", "ë¼. ê´€ë§íƒ‘", "ë§ˆ. íœ´ê²Œì†Œ", "ë°”. ê³µì›/ê´€ê´‘ì§€ ë¶€ìˆ˜"] },
    { cat: "28. ì¥ë¡€ì‹œì„¤", details: ["ê°€. ì¥ë¡€ì‹ì¥", "ë‚˜. ë™ë¬¼ ì „ìš© ì¥ë¡€ì‹ì¥"] },
    { cat: "29. ì•¼ì˜ì¥ ì‹œì„¤", details: ["ì•¼ì˜ì¥ ì‹œì„¤(ê´€ë¦¬ë™ ë“± 300ã¡ ë¯¸ë§Œ)"] }
  ];

  /* =========================
     2) UI ELEMENTS
     ========================= */
  const els = {
    themeBtn: document.getElementById("themeBtn"),
    copyBtn: document.getElementById("copyBtn"),
    recalcBtn: document.getElementById("recalcBtn"),

    prevBtn: document.getElementById("prevBtn"),
    nextBtn: document.getElementById("nextBtn"),

    step1: document.getElementById("step1"),
    step2: document.getElementById("step2"),
    step3: document.getElementById("step3"),

    stepPill1: document.getElementById("stepPill1"),
    stepPill2: document.getElementById("stepPill2"),
    stepPill3: document.getElementById("stepPill3"),

    useCat: document.getElementById("useCat"),
    useDetail: document.getElementById("useDetail"),

    majorRemoval: document.getElementById("majorRemoval"),

    bearingWorkType: document.getElementById("bearingWorkType"),
    bearingArea: document.getElementById("bearingArea"),
    columnWorkType: document.getElementById("columnWorkType"),
    columnCount: document.getElementById("columnCount"),
    beamWorkType: document.getElementById("beamWorkType"),
    beamCount: document.getElementById("beamCount"),
    extFinishWorkType: document.getElementById("extFinishWorkType"),
    extFinishArea: document.getElementById("extFinishArea"),

    sumUse: document.getElementById("sumUse"),
    sumMajor: document.getElementById("sumMajor"),
    sumTriggers: document.getElementById("sumTriggers"),

    usePill: document.getElementById("usePill"),
    majorPill: document.getElementById("majorPill"),
    triggerPill: document.getElementById("triggerPill"),

    decisionCallout: document.getElementById("decisionCallout"),
    decisionTitle: document.getElementById("decisionTitle"),
    decisionDesc: document.getElementById("decisionDesc"),
    reasonList: document.getElementById("reasonList"),

    pillMajor: document.getElementById("pillMajor"),
    pillTrigger: document.getElementById("pillTrigger"),
    pillReport: document.getElementById("pillReport"),

    copyText: document.getElementById("copyText"),
  };

  const qs = Array.from(document.querySelectorAll(".q"));

  /* =========================
     3) STATE
     ========================= */
  let step = 1;

  const state = {
    useCat: "",
    useDetail: "",
    majorRemoval: "", // yes/no
    bearingWorkType: "none",
    bearingArea: 0,
    columnWorkType: "none",
    columnCount: 0,
    beamWorkType: "none",
    beamCount: 0,
    extFinishWorkType: "none",
    extFinishArea: 0,
  };

  /* =========================
     4) INIT: populate use categories
     ========================= */
  function initUses(){
    USES.forEach((u) => {
      const opt = document.createElement("option");
      opt.value = u.cat;
      opt.textContent = u.cat;
      els.useCat.appendChild(opt);
    });
  }

  function setStep(n){
    step = Math.max(1, Math.min(3, n));
    els.step1.style.display = (step === 1) ? "" : "none";
    els.step2.style.display = (step === 2) ? "" : "none";
    els.step3.style.display = (step === 3) ? "" : "none";

    els.stepPill1.classList.toggle("active", step === 1);
    els.stepPill2.classList.toggle("active", step === 2);
    els.stepPill3.classList.toggle("active", step === 3);

    els.prevBtn.disabled = (step === 1);
    els.nextBtn.textContent = (step === 3) ? "ì™„ë£Œ" : "ë‹¤ìŒ";

    // Step3 ë“¤ì–´ì˜¤ë©´ ê³„ì‚° í•œë²ˆ
    if(step === 3) computeAll();
  }

  /* =========================
     5) INPUT HELPERS
     ========================= */
  function numVal(el){
    const v = parseFloat(el.value);
    return isNaN(v) ? 0 : v;
  }
  function txt(v){ return (v && String(v).trim().length) ? String(v).trim() : ""; }

  function workLabel(code){
    const map = {
      none: "í•´ë‹¹ ì—†ìŒ",
      repair: "ìˆ˜ì„ (ë³´ìˆ˜Â·êµì²´)",
      change: "ë³€ê²½(ë°°ì¹˜/êµ¬ì¡° ë³€ê²½)",
      add: "ì¦ì„¤(ì¶”ê°€ ì„¤ì¹˜)",
      remove: "í•´ì²´(ì² ê±°/ì‚­ì œ)"
    };
    return map[code] || "-";
  }

  /* =========================
     6) MVP LOGIC (ë‹¨ìˆœ íŒì •)
        - ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°: ë‚´ë ¥ë²½ 30ã¡+, ê¸°ë‘¥ 3ê°œ+, ë³´ 3ê°œ+, ì™¸ë²½ë§ˆê°ì¬ 30ã¡+
        - ì‹ ê³  ê°€ëŠ¥ì„±(ëŒ€ëµ): ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ ì—†ìŒ + íŠ¸ë¦¬ê±° í•­ëª©ì˜ ê³µì‚¬ í˜•íƒœê°€ "ìˆ˜ì„ " ì¤‘ì‹¬
          (ë³€ê²½/ì¦ì„¤/í•´ì²´ê°€ ì„ì´ë©´ í—ˆê°€ ìª½ìœ¼ë¡œ ê¸°ìš¸ê²Œ í‘œì‹œ)
     ========================= */
  function evaluate(){
    const reasons = [];
    const triggers = [];

    const majorRemoval = state.majorRemoval; // yes/no/""
    const majorRemovalYes = (majorRemoval === "yes");
    const majorRemovalNo  = (majorRemoval === "no");

    // Trigger checks
    const bearingHit = (state.bearingArea >= 30 && state.bearingWorkType !== "none");
    const columnHit  = (state.columnCount >= 3 && state.columnWorkType !== "none");
    const beamHit    = (state.beamCount >= 3 && state.beamWorkType !== "none");
    const extHit     = (state.extFinishArea >= 30 && state.extFinishWorkType !== "none");

    if(bearingHit) triggers.push(`ë‚´ë ¥ë²½ ${workLabel(state.bearingWorkType)} / ${state.bearingArea}ã¡`);
    if(columnHit)  triggers.push(`ê¸°ë‘¥ ${workLabel(state.columnWorkType)} / ${state.columnCount}ê°œ`);
    if(beamHit)    triggers.push(`ë³´ ${workLabel(state.beamWorkType)} / ${state.beamCount}ê°œ`);
    if(extHit)     triggers.push(`ì™¸ë²½ ë§ˆê°ì¬ ${workLabel(state.extFinishWorkType)} / ${state.extFinishArea}ã¡`);

    const isMajorRenovationCandidate = triggers.length > 0;

    // ì‹ ê³  ê°€ëŠ¥ì„±(ë‹¨ìˆœ)
    const anyNonRepair =
      [state.bearingWorkType, state.columnWorkType, state.beamWorkType, state.extFinishWorkType]
        .some(t => (t === "change" || t === "add" || t === "remove"));

    let reportPossible = false;
    if(isMajorRenovationCandidate && majorRemovalNo && !anyNonRepair){
      reportPossible = true;
    }

    // Decision text
    let decision = {
      level: "info", // ok/warn/danger/info
      title: "íŒì • ì¤€ë¹„ ì¤‘â€¦",
      desc: "ì…ë ¥ê°’ì„ ë” ì±„ìš°ë©´ ê²°ê³¼ê°€ ì„ ëª…í•´ì§‘ë‹ˆë‹¤.",
      reportTag: "-"
    };

    if(!txt(state.useCat)){
      reasons.push("ìš©ë„(ë³„í‘œ1)ë¥¼ ì„ íƒí•˜ì§€ ì•Šì•„, í›„ì† ìë™ì•ˆë‚´(ì˜ˆì™¸/ì œí•œ)ê°€ ì œí•œë©ë‹ˆë‹¤.");
    }

    if(!txt(state.majorRemoval)){
      reasons.push("ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ ì—¬ë¶€ê°€ ë¯¸ì„ íƒì…ë‹ˆë‹¤. ì‹ ê³  ê°€ëŠ¥ì„± íŒë‹¨ì´ ì•½í•´ì§‘ë‹ˆë‹¤.");
    }

    if(!isMajorRenovationCandidate){
      decision = {
        level: "warn",
        title: "í˜„ì¬ ì…ë ¥ë§Œìœ¼ë¡œëŠ” â€˜ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°â€™ê°€ ëšœë ·í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
        desc: "ë‚´ë ¥ë²½/ê¸°ë‘¥/ë³´/ì™¸ë²½ë§ˆê°ì¬ í•­ëª©ì—ì„œ ê¸°ì¤€ ì´ìƒì´ ìˆìœ¼ë©´ ëŒ€ìˆ˜ì„  í›„ë³´ê°€ ë©ë‹ˆë‹¤.",
        reportTag: "ëŒ€ìˆ˜ì„  í›„ë³´ ì•„ë‹˜(í˜„ì¬ ì…ë ¥ ê¸°ì¤€)"
      };
      reasons.push("ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±° í•­ëª©ì´ ì•„ì§ ê¸°ì¤€ì— ë„ë‹¬í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
    } else {
      // ëŒ€ìˆ˜ì„  í›„ë³´
      if(majorRemovalYes){
        decision = {
          level: "danger",
          title: "íŒì •: ëŒ€ìˆ˜ì„  â€˜í—ˆê°€(ê²€í† )â€™ ê°€ëŠ¥ì„±ì´ í½ë‹ˆë‹¤. (í•´ì²´ í¬í•¨)",
          desc: "ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ê°€ ìˆìœ¼ë©´ ì‹ ê³  ê°€ëŠ¥ ìš”ê±´ì„ ë²—ì–´ë‚  ê°€ëŠ¥ì„±ì´ ì»¤ì§‘ë‹ˆë‹¤. ê´€í• ì²­/êµ¬ì¡°ê²€í†  ë“± ì¶”ê°€ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.",
          reportTag: "ì‹ ê³  ì–´ë ¤ì›€(í•´ì²´ ìˆìŒ)"
        };
        reasons.push("ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´(ì² ê±°)ê°€ ìˆì–´ ì‹ ê³  ìš”ê±´ ì¶©ì¡±ì´ ì–´ë µë‹¤ê³  í‘œì‹œí•©ë‹ˆë‹¤.");
      } else if(reportPossible){
        decision = {
          level: "ok",
          title: "íŒì •: ëŒ€ìˆ˜ì„  â€˜ì‹ ê³  ê°€ëŠ¥â€™ í›„ë³´ì…ë‹ˆë‹¤. (ë‹¨ìˆœ ì¡°ê±´ ì¶©ì¡±)",
          desc: "í˜„ì¬ ì…ë ¥ ê¸°ì¤€ìœ¼ë¡œëŠ” â€˜í•´ì²´ ì—†ìŒ + ìˆ˜ì„  ì¤‘ì‹¬â€™ íŒ¨í„´ì´ë¼ ì‹ ê³  ê°€ëŠ¥ ìª½ìœ¼ë¡œ ì•ˆë‚´í•©ë‹ˆë‹¤. ë‹¨, ì‹¤ì œ ì œì¶œ ì„œë¥˜Â·êµ¬ì¡°Â·ë°©í™” ê¸°ì¤€ì€ ë³„ë„ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.",
          reportTag: "ì‹ ê³  ê°€ëŠ¥ í›„ë³´"
        };
        reasons.push("í•´ì²´ ì—†ìŒ + íŠ¸ë¦¬ê±° í•­ëª©ì´ â€˜ìˆ˜ì„ â€™ ì¤‘ì‹¬ì´ë¼ ì‹ ê³  í›„ë³´ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.");
      } else {
        decision = {
          level: "warn",
          title: "íŒì •: ëŒ€ìˆ˜ì„  â€˜í—ˆê°€(ê²€í† )â€™ ìª½ìœ¼ë¡œ ê¸°ìš¸ì–´ì§‘ë‹ˆë‹¤.",
          desc: "íŠ¸ë¦¬ê±°ëŠ” ë§ì§€ë§Œ, â€˜ë³€ê²½/ì¦ì„¤/í•´ì²´â€™ í˜•íƒœê°€ í¬í•¨ë˜ê±°ë‚˜ í•´ì²´ ì—¬ë¶€ê°€ ë¯¸ì„ íƒì´ë©´ ì‹ ê³  ìš”ê±´ì„ ë²—ì–´ë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
          reportTag: "í—ˆê°€ ê²€í†  í•„ìš”"
        };
        if(anyNonRepair) reasons.push("íŠ¸ë¦¬ê±° í•­ëª© ì¤‘ â€˜ë³€ê²½/ì¦ì„¤/í•´ì²´â€™ê°€ í¬í•¨ë˜ì–´ ì‹ ê³  ìš”ê±´ì„ ë²—ì–´ë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
        if(!majorRemovalNo) reasons.push("ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´ê°€ â€˜ì—†ìŒâ€™ìœ¼ë¡œ í™•ì •ë˜ì§€ ì•Šì•„ ì‹ ê³  íŒë‹¨ì„ ë³´ìˆ˜ì ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.");
      }
    }

    return {
      triggers,
      isMajorRenovationCandidate,
      majorRemovalYes,
      majorRemovalNo,
      reportPossible,
      decision,
      reasons
    };
  }

  /* =========================
     7) RENDER
     ========================= */
  function renderSummary(){
    const useText = txt(state.useCat) ? `${state.useCat}${txt(state.useDetail) ? " / " + state.useDetail : ""}` : "ë¯¸ì…ë ¥";
    els.sumUse.textContent = useText;

    const majorText = state.majorRemoval === "yes" ? "í•´ì²´ ìˆìŒ" :
                      state.majorRemoval === "no"  ? "í•´ì²´ ì—†ìŒ" : "ë¯¸ì„ íƒ";
    els.sumMajor.textContent = majorText;
    els.sumMajor.classList.toggle("muted", state.majorRemoval === "");

    const ev = evaluate();
    els.sumTriggers.textContent = ev.triggers.length ? ev.triggers.join(" Â· ") : "ì•„ì§ ì—†ìŒ";
    els.sumTriggers.classList.toggle("muted", ev.triggers.length === 0);

    // small pills on step panels
    els.usePill.className = "pill " + (txt(state.useCat) ? "" : "gray");
    els.usePill.innerHTML = `<span class="mini"></span>${txt(state.useCat) ? "ì…ë ¥ë¨" : "ë¯¸ì…ë ¥"}`;

    els.majorPill.className = "pill " + (state.majorRemoval ? "" : "gray");
    els.majorPill.innerHTML = `<span class="mini"></span>${state.majorRemoval ? "ì„ íƒë¨" : "ë¯¸ì„ íƒ"}`;

    els.triggerPill.className = "pill " + (ev.triggers.length ? "" : "gray");
    els.triggerPill.innerHTML = `<span class="mini"></span>${ev.triggers.length ? (ev.triggers.length + "ê°œ ì²´í¬ë¨") : "ë¯¸ì…ë ¥"}`;
  }

  function renderResult(){
    const ev = evaluate();

    // callout style
    els.decisionCallout.classList.remove("ok","warn","danger");
    if(ev.decision.level === "ok") els.decisionCallout.classList.add("ok");
    else if(ev.decision.level === "danger") els.decisionCallout.classList.add("danger");
    else if(ev.decision.level === "warn") els.decisionCallout.classList.add("warn");

    els.decisionTitle.textContent = ev.decision.title;
    els.decisionDesc.textContent  = ev.decision.desc;

    // pills
    els.pillMajor.innerHTML = `<span class="mini"></span>ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´: ${
      state.majorRemoval === "yes" ? "ìˆìŒ" : state.majorRemoval === "no" ? "ì—†ìŒ" : "-"
    }`;
    els.pillTrigger.innerHTML = `<span class="mini"></span>ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°: ${ev.triggers.length ? ev.triggers.length + "ê°œ" : "-"}`;
    els.pillReport.innerHTML = `<span class="mini"></span>ì‹ ê³  ê°€ëŠ¥ì„±: ${ev.decision.reportTag}`;

    // reasons
    els.reasonList.innerHTML = "";
    const allReasons = [
      ...(ev.triggers.length ? [`ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°(ì…ë ¥ ê¸°ë°˜): ${ev.triggers.join(" Â· ")}`] : []),
      ...ev.reasons
    ];
    if(allReasons.length === 0){
      const li = document.createElement("li");
      li.textContent = "ì¶”ê°€ ì‚¬ìœ  ì—†ìŒ";
      els.reasonList.appendChild(li);
    } else {
      allReasons.forEach(r => {
        const li = document.createElement("li");
        li.textContent = r;
        els.reasonList.appendChild(li);
      });
    }

    // copy text
    const useText = txt(state.useCat) ? `${state.useCat}${txt(state.useDetail) ? " / " + state.useDetail : ""}` : "(ë¯¸ì…ë ¥)";
    const majorText = state.majorRemoval === "yes" ? "í•´ì²´ ìˆìŒ" : state.majorRemoval === "no" ? "í•´ì²´ ì—†ìŒ" : "(ë¯¸ì„ íƒ)";
    const triText = ev.triggers.length ? ev.triggers.map(t => `- ${t}`).join("\n") : "- (ì—†ìŒ)";
    els.copyText.textContent =
`[ëŒ€ìˆ˜ì„  í—ˆê°€/ì‹ ê³  íŒì • ìš”ì•½]
- ìš©ë„: ${useText}
- ì£¼ìš”êµ¬ì¡°ë¶€ í•´ì²´: ${majorText}
- ëŒ€ìˆ˜ì„  íŠ¸ë¦¬ê±°:
${triText}

- ê²°ë¡ : ${ev.decision.title}
- ë©”ëª¨: ${ev.decision.reportTag}

[ì£¼ì˜]
- ë³¸ ê²°ê³¼ëŠ” â€˜ì…ë ¥ëœ ê³µì‚¬ ì‚¬ì‹¤â€™ ê¸°ì¤€ì˜ MVP ìë™íŒì •ì…ë‹ˆë‹¤.
- êµ¬ì¡°/ë°©í™”/í”¼ë‚œ/ì¡°ë¡€ ë“± ë‹¤ë¥¸ ê¸°ì¤€ì€ ë³„ë„ ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤.`;
  }

  function computeAll(){
    renderSummary();
    renderResult();
  }

  /* =========================
     8) EVENTS
     ========================= */
  function bindEvents(){
    // Theme toggle
    els.themeBtn.addEventListener("click", () => {
      const html = document.documentElement;
      const isDark = html.getAttribute("data-theme") === "dark";
      html.setAttribute("data-theme", isDark ? "light" : "dark");
      els.themeBtn.textContent = isDark ? "í…Œë§ˆ: ë¼ì´íŠ¸" : "í…Œë§ˆ: ë‹¤í¬";
      computeAll();
    });

    // Copy
    els.copyBtn.addEventListener("click", async () => {
      computeAll();
      try{
        await navigator.clipboard.writeText(els.copyText.textContent);
        els.copyBtn.textContent = "ë³µì‚¬ ì™„ë£Œ!";
        setTimeout(() => els.copyBtn.textContent = "ìš”ì•½ ë³µì‚¬", 1100);
      }catch(e){
        alert("ë³µì‚¬ê°€ ë§‰í˜”ì–´ìš”. ìš”ì•½ ë°•ìŠ¤ë¥¼ ë“œë˜ê·¸í•´ì„œ ë³µì‚¬í•´ ì£¼ì„¸ìš”.");
      }
    });

    els.recalcBtn.addEventListener("click", computeAll);

    // Step nav
    els.prevBtn.addEventListener("click", () => setStep(step - 1));
    els.nextBtn.addEventListener("click", () => {
      if(step < 3) setStep(step + 1);
      else {
        computeAll();
        // ì™„ë£Œ ë²„íŠ¼ì€ í˜„ì¬ MVPì—ì„œ â€œê³„ì‚° ê°±ì‹ â€ ì—­í• 
        els.nextBtn.textContent = "ì™„ë£Œë¨";
        setTimeout(() => els.nextBtn.textContent = "ì™„ë£Œ", 900);
      }
    });

    // Use category change
    els.useCat.addEventListener("change", () => {
      state.useCat = els.useCat.value;
      state.useDetail = "";

      // populate details
      els.useDetail.innerHTML = "";
      const cat = USES.find(u => u.cat === state.useCat);

      if(!cat){
        els.useDetail.disabled = true;
        const opt = document.createElement("option");
        opt.value = "";
        opt.textContent = "ëŒ€ë¶„ë¥˜ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”";
        els.useDetail.appendChild(opt);
      } else {
        els.useDetail.disabled = false;
        const opt0 = document.createElement("option");
        opt0.value = "";
        opt0.textContent = "ì„¸ë¶€ ìš©ë„ ì„ íƒ(ì„ íƒì‚¬í•­)";
        els.useDetail.appendChild(opt0);

        cat.details.forEach(d => {
          const opt = document.createElement("option");
          opt.value = d;
          opt.textContent = d;
          els.useDetail.appendChild(opt);
        });
      }
      computeAll();
    });

    els.useDetail.addEventListener("change", () => {
      state.useDetail = els.useDetail.value;
      computeAll();
    });

    // Major removal
    els.majorRemoval.addEventListener("change", () => {
      state.majorRemoval = els.majorRemoval.value;
      computeAll();
    });

    // Triggers
    const onAny = () => {
      state.bearingWorkType = els.bearingWorkType.value;
      state.bearingArea = numVal(els.bearingArea);

      state.columnWorkType = els.columnWorkType.value;
      state.columnCount = Math.max(0, Math.floor(numVal(els.columnCount)));

      state.beamWorkType = els.beamWorkType.value;
      state.beamCount = Math.max(0, Math.floor(numVal(els.beamCount)));

      state.extFinishWorkType = els.extFinishWorkType.value;
      state.extFinishArea = numVal(els.extFinishArea);

      computeAll();
    };

    [
      els.bearingWorkType, els.bearingArea,
      els.columnWorkType, els.columnCount,
      els.beamWorkType, els.beamCount,
      els.extFinishWorkType, els.extFinishArea
    ].forEach(el => el.addEventListener("input", onAny));

    // Active question highlight (ì–´ëŠ ì¹¸ì¸ì§€ ëˆˆì— ë„ê²Œ)
    qs.forEach(q => {
      const inputs = q.querySelectorAll("select, input");
      inputs.forEach(i => {
        i.addEventListener("focus", () => {
          qs.forEach(x => x.classList.remove("active"));
          q.classList.add("active");
        });
        i.addEventListener("blur", () => {
          // blur í›„ì—ë„ ë§ˆì§€ë§‰ ì…ë ¥ì¹´ë“œê°€ ì‚´ì§ ë‚¨ì•„ìˆê²Œ í•˜ê³  ì‹¶ìœ¼ë©´ ì£¼ì„ ì²˜ë¦¬ í•´ì œ
          // q.classList.remove("active");
        });
      });
    });
  }

  /* =========================
     9) RUN
     ========================= */
  initUses();
  bindEvents();
  setStep(1);
  computeAll();
</script>
</body>
</html>
